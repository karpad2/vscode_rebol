/*! For license information please see extension.js.LICENSE.txt */
(()=>{var e={5623:e=>{"use strict";function t(e,t,i){e instanceof RegExp&&(e=n(e,i)),t instanceof RegExp&&(t=n(t,i));var r=o(e,t,i);return r&&{start:r[0],end:r[1],pre:i.slice(0,r[0]),body:i.slice(r[0]+e.length,r[1]),post:i.slice(r[1]+t.length)}}function n(e,t){var n=t.match(e);return n?n[0]:null}function o(e,t,n){var o,i,r,s,a,c=n.indexOf(e),l=n.indexOf(t,c+1),u=c;if(c>=0&&l>0){if(e===t)return[c,l];for(o=[],r=n.length;u>=0&&!a;)u==c?(o.push(u),c=n.indexOf(e,u+1)):1==o.length?a=[o.pop(),l]:((i=o.pop())<r&&(r=i,s=l),l=n.indexOf(t,u+1)),u=c<l&&c>=0?c:l;o.length&&(a=[r,s])}return a}e.exports=t,t.range=o},3644:(e,t,n)=>{var o=n(1048),i=n(5623);e.exports=function(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),C(function(e){return e.split("\\\\").join(r).split("\\{").join(s).split("\\}").join(a).split("\\,").join(c).split("\\.").join(l)}(e),!0).map(d)):[]};var r="\0SLASH"+Math.random()+"\0",s="\0OPEN"+Math.random()+"\0",a="\0CLOSE"+Math.random()+"\0",c="\0COMMA"+Math.random()+"\0",l="\0PERIOD"+Math.random()+"\0";function u(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function d(e){return e.split(r).join("\\").split(s).join("{").split(a).join("}").split(c).join(",").split(l).join(".")}function h(e){if(!e)return[""];var t=[],n=i("{","}",e);if(!n)return e.split(",");var o=n.pre,r=n.body,s=n.post,a=o.split(",");a[a.length-1]+="{"+r+"}";var c=h(s);return s.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),t.push.apply(t,a),t}function p(e){return"{"+e+"}"}function f(e){return/^-?0\d/.test(e)}function m(e,t){return e<=t}function g(e,t){return e>=t}function C(e,t){var n=[],r=i("{","}",e);if(!r||/\$$/.test(r.pre))return[e];var s,c=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),l=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),d=c||l,_=r.body.indexOf(",")>=0;if(!d&&!_)return r.post.match(/,.*\}/)?C(e=r.pre+"{"+r.body+a+r.post):[e];if(d)s=r.body.split(/\.\./);else if(1===(s=h(r.body)).length&&1===(s=C(s[0],!1).map(p)).length)return(v=r.post.length?C(r.post,!1):[""]).map((function(e){return r.pre+s[0]+e}));var b,y=r.pre,v=r.post.length?C(r.post,!1):[""];if(d){var O=u(s[0]),w=u(s[1]),S=Math.max(s[0].length,s[1].length),k=3==s.length?Math.abs(u(s[2])):1,L=m;w<O&&(k*=-1,L=g);var T=s.some(f);b=[];for(var E=O;L(E,w);E+=k){var I;if(l)"\\"===(I=String.fromCharCode(E))&&(I="");else if(I=String(E),T){var B=S-I.length;if(B>0){var P=new Array(B+1).join("0");I=E<0?"-"+P+I.slice(1):P+I}}b.push(I)}}else b=o(s,(function(e){return C(e,!1)}));for(var x=0;x<b.length;x++)for(var D=0;D<v.length;D++){var R=y+b[x]+v[D];(!t||d||R)&&n.push(R)}return n}},1048:e=>{e.exports=function(e,n){for(var o=[],i=0;i<e.length;i++){var r=n(e[i],i);t(r)?o.push.apply(o,r):o.push(r)}return o};var t=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},4867:(e,t,n)=>{e.exports=n(5259)},5259:(e,t,n)=>{var o=n(4608)._extend({init:function(e,t,n){e=e instanceof Array?e:[e],this._map={},this._list=[],this.callback=t,this.keyFields=e,this.isHashArray=!0,this.options=n||{ignoreDuplicates:!1},t&&t("construct")},addOne:function(e){var t=!1;for(var n in this.keyFields){n=this.keyFields[n];var o=this.objectAt(e,n);if(o)if(this.has(o)){if(this.options.ignoreDuplicates)return;if(-1!=this._map[o].indexOf(e)){t=!0;continue}this._map[o].push(e)}else this._map[o]=[e]}t&&-1!=this._list.indexOf(e)||this._list.push(e)},add:function(){for(var e=0;e<arguments.length;e++)this.addOne(arguments[e]);return this.callback&&this.callback("add",Array.prototype.slice.call(arguments,0)),this},addAll:function(e){if(e.length<100)this.add.apply(this,e);else for(var t=0;t<e.length;t++)this.add(e[t]);return this},addMap:function(e,t){return this._map[e]=t,this.callback&&this.callback("addMap",{key:e,obj:t}),this},intersection:function(e){var t=this;if(!e||!e.isHashArray)throw Error("Cannot HashArray.intersection() on a non-hasharray object. You passed in: ",e);var n=this.clone(null,!0);return this.clone(null,!0).addAll(this.all.concat(e.all)).all.forEach((function(o){t.collides(o)&&e.collides(o)&&n.add(o)})),n},complement:function(e){if(!e||!e.isHashArray)throw Error("Cannot HashArray.complement() on a non-hasharray object. You passed in: ",e);var t=this.clone(null,!0);return this.all.forEach((function(n){e.collides(n)||t.add(n)})),t},get:function(e){return this._map[e]instanceof Array&&1==this._map[e].length?this._map[e][0]:this._map[e]},getAll:function(e){if("*"==(e=e instanceof Array?e:[e])[0])return this.all;var t=new o(this.keyFields);for(var n in e)t.add.apply(t,this.getAsArray(e[n]));return t.all},getAsArray:function(e){return this._map[e]||[]},getUniqueRandomIntegers:function(e,t,n){var o=[],i={};for(e=Math.min(Math.max(n-t,1),e);o.length<e;){var r=Math.floor(t+Math.random()*(n+1));i[r]||(i[r]=!0,o.push(r))}return o},sample:function(e,t){var n=this.all,o=[];t&&(n=this.getAll(t));for(var i=this.getUniqueRandomIntegers(e,0,n.length-1),r=0;r<i.length;r++)o.push(n[i[r]]);return o},has:function(e){return this._map.hasOwnProperty(e)},collides:function(e){for(var t in this.keyFields)if(this.has(this.objectAt(e,this.keyFields[t])))return!0;return!1},hasMultiple:function(e){return this._map[e]instanceof Array},removeByKey:function(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t],o=this._map[n].concat();if(o)for(var i in e=e.concat(o),o){var r=o[i];for(var s in this.keyFields){var a=this.objectAt(r,this.keyFields[s]);a&&this.has(a)&&(-1!=(s=this._map[a].indexOf(r))&&this._map[a].splice(s,1),0==this._map[a].length&&delete this._map[a])}this._list.splice(this._list.indexOf(r),1)}delete this._map[n]}return this.callback&&this.callback("removeByKey",e),this},remove:function(){for(var e=0;e<arguments.length;e++){var t=arguments[e];for(var n in this.keyFields){var o=this.objectAt(t,this.keyFields[n]);if(o){if(-1==(n=this._map[o].indexOf(t)))throw new Error("HashArray: attempting to remove an object that was never added!"+o);this._map[o].splice(n,1),0==this._map[o].length&&delete this._map[o]}}if(-1==(n=this._list.indexOf(t)))throw new Error("HashArray: attempting to remove an object that was never added!"+o);this._list.splice(n,1)}return this.callback&&this.callback("remove",arguments),this},removeAll:function(){var e=this._list.concat();return this._map={},this._list=[],this.callback&&this.callback("remove",e),this},objectAt:function(e,t){if("string"==typeof t)return e[t];for(var n=t.concat();n.length&&e;)e=e[n.shift()];return e},forEach:function(e,t){return e=e instanceof Array?e:[e],this.getAll(e).forEach(t),this},forEachDeep:function(e,t,n){e=e instanceof Array?e:[e];var o=this;return this.getAll(e).forEach((function(e){n(o.objectAt(e,t),e)})),this},clone:function(e,t){var n=new o(this.keyFields.concat(),e||this.callback);return t||n.add.apply(n,this.all.concat()),n},sum:function(e,t,n){var o=this,i=0;return this.forEachDeep(e,t,(function(e,t){void 0!==n&&(e*=o.objectAt(t,n)),i+=e})),i},average:function(e,t,n){var o=0,i=0,r=0,s=this;return void 0!==n&&this.forEachDeep(e,n,(function(e){r+=e})),this.forEachDeep(e,t,(function(e,t){void 0!==n&&(e*=s.objectAt(t,n)/r),o+=e,i++})),void 0!==n?o:o/i},filter:function(e,t){var n=this,i="function"==typeof t?t:function(e){var o=n.objectAt(e,t);return void 0!==o&&!1!==o},r=new o(this.keyFields);return r.addAll(this.getAll(e).filter(i)),r}});Object.defineProperty(o.prototype,"all",{get:function(){return this._list}}),Object.defineProperty(o.prototype,"map",{get:function(){return this._map}}),e.exports=o,"undefined"!=typeof window&&(window.HashArray=o)},4608:(e,t)=>{var n,o;void 0===(o="function"==typeof(n=function(){var e=function(e){return e instanceof Function},t=function(e){var t=Array.prototype.slice.call(arguments,1);for(var n in t){var o=t[n];if("object"==typeof o)for(var i in o)e[i]=o[i]}return e},n={_isClassObject:!1},o=!1,i=function(){};return i._subClasses=[],i.prototype.init=function(){},i._extend=function(r,s,a){void 0===r&&(r={}),void 0===s&&(s={}),void 0===a&&(a={}),a=t({},n,a);var c=function(){o||(this._class=c,this.init instanceof Function&&this.init.apply(this,arguments))},l=this;o=!0;var u=new l;o=!1;var d=l.prototype;for(var h in c.prototype=u,c.prototype.constructor=c,c._superClass=l,c._subClasses=[],l._subClasses.push(c),c._extend=l._extend,c._extends=function(e){return this._superClass!=i&&(e==this._superClass||e==i||this._superClass._extends(e))},r){var p=Object.getOwnPropertyDescriptor(r,h),f=p.value;if(null!==f&&"object"==typeof f&&f.descriptor)Object.defineProperty(u,h,f);else if("value"in p||!("set"in p)&&!("get"in p)){u[h]=f;var m=d[h];e(f)&&e(m)&&f!==m&&(f._super=m)}else Object.defineProperty(u,h,p)}if(!a._isClassObject){var g=void 0===l._members?i:l._members._class,C=t({},a,{_isClassObject:!0}),_=g._extend(s,{},C);_._instanceClass=c,c._members=new _}return c},i._convert=function(e,t){var n=e.prototype;return n.init=function(){var t=this._origin=i._construct(e,arguments);Object.keys(t).forEach((function(e){t.hasOwnProperty(e)&&Object.defineProperty(this,e,{get:function(){return t[e]}})}),this)},i._extend(n,{},t)},i._construct=function(e,t){void 0===t&&(t=[]);var n=function(){return e.apply(this,t)};return n.prototype=e.prototype,new n},i._superDescriptor=function(e,t){return"_class"in e&&e instanceof e._class&&(e=e._class),"_extends"in e&&e._extends instanceof Function&&e._extends(this)?Object.getOwnPropertyDescriptor(e._superClass.prototype,t):void 0},i})?n.apply(t,[]):n)||(e.exports=o)},3679:function(e,t){var n;n=function(){"use strict";var e=String.fromCharCode,t=Object.prototype.hasOwnProperty,n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array,o=!1,i=!1;try{"a"===e.apply(null,[97])&&(o=!0)}catch(e){}if(n)try{"a"===e.apply(null,new Uint8Array([97]))&&(i=!0)}catch(e){}var r=65533,s=null,a=!1;-1!=="abcほげ".lastIndexOf("ほげ",1)&&(a=!0);var c=function(){for(var n="",o={8:1,10:1,11:1,12:1,13:1,92:1},i=0;i<127;i++)t.call(o,i)||(n+=e(i));return n}(),l=c.length,u=Math.max(l,62)-Math.min(l,62),d=l-1,h=1024,p=65533-l,f=40,m=1640,g=l+1,C=u+20,_=l+5,b=l-u-19;function y(e){this._init(e)}function v(e){this._init(e)}function O(e){this._init(e)}function w(e){this._init(e)}function S(){var e,t,n,o="abcdefghijklmnopqrstuvwxyz",i="",r=o.length;for(e=0;e<r;e++)for(n=o.charAt(e),t=r-1;t>15&&i.length<h;t--)i+=" "+n+" "+o.charAt(t);for(;i.length<h;)i=" "+i;return i.slice(0,h)}function k(t,n){if(null==n?n=t.length:t=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)}(t,n),o&&i&&n<r){if(s)return e.apply(null,t);if(null===s)try{var a=e.apply(null,t);return n>r&&(s=!0),a}catch(e){s=!1}}return function(t){for(var n,o="",i=t.length,a=0;a<i;){if(n=t.subarray?t.subarray(a,a+r):t.slice(a,a+r),a+=r,!s){if(null===s)try{o+=e.apply(null,n),n.length>r&&(s=!0);continue}catch(e){s=!1}return L(t)}o+=e.apply(null,n)}return o}(t)}function L(t){for(var n="",o=t.length,i=0;i<o;i++)n+=e(t[i]);return n}function T(e,t){if(!n)return new Array(t);switch(e){case 8:return new Uint8Array(t);case 16:return new Uint16Array(t)}}function E(e){for(var t,n,o=[],i=0,r=e.length;i<r;i++)(t=e.charCodeAt(i))>=55296&&t<=56319&&i+1<r&&(n=e.charCodeAt(i+1))>=56320&&n<=57343&&(t=1024*(t-55296)+n-56320+65536,i++),t<128?o[o.length]=t:t<2048?(o[o.length]=192|t>>6&31,o[o.length]=128|63&t):t<65536?(o[o.length]=224|t>>12&15,o[o.length]=128|t>>6&63,o[o.length]=128|63&t):t<2097152&&(o[o.length]=240|t>>18&15,o[o.length]=128|t>>12&63,o[o.length]=128|t>>6&63,o[o.length]=128|63&t);return k(o)}function I(e){for(var t,n,o,i=[],r=0,s=e.length;r<s;)(t=(n=e.charCodeAt(r++))>>4)>=0&&t<=7?o=n:12===t||13===t?o=(31&n)<<6|63&e.charCodeAt(r++):14===t?o=(15&n)<<12|(63&e.charCodeAt(r++))<<6|63&e.charCodeAt(r++):15===t&&(o=(7&n)<<18|(63&e.charCodeAt(r++))<<12|(63&e.charCodeAt(r++))<<6|63&e.charCodeAt(r++)),o<=65535?i[i.length]=o:(o-=65536,i[i.length]=55296+(o>>10),i[i.length]=o%1024+56320);return k(i)}function B(e,t){for(var n,o,i=0,r=0,s=e.length;r<s;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(o=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(o-56320),r++),n<128?i++:i+=n<2048?2:n<65536?3:4;return i}y.prototype={_init:function(e){e=e||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd,this._maxBytes=e.maxBytes},_createTable:function(){for(var e=T(8,l),t=0;t<l;t++)e[t]=c.charCodeAt(t);return e},_onData:function(e,t){var n=k(e,t);this._onDataCallback?this._onDataCallback(n):this._result+=n},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var e=2,t=this._data,n=this._offset,o=d;if(this._dataLen-n<o&&(o=this._dataLen-n),e>o)return!1;var i,r,s,c,l,u=n-304,h=t.substring(u,n+o),p=n+e-3-u;do{if(2===e){if(r=t.charAt(n)+t.charAt(n+1),!~(s=h.indexOf(r))||s>p)break}else 3===e?r+=t.charAt(n+2):r=t.substr(n,e);if(!~(c=a?t.substring(u,n+e-1).lastIndexOf(r):h.lastIndexOf(r,p)))break;l=c,i=u+c;do{if(t.charCodeAt(n+e)!==t.charCodeAt(i+e))break}while(++e<o);if(s===c){e++;break}}while(++e<o);return 2!==e&&(this._index=304-l,this._length=e-1,!0)},compress:function(e){if(null==e||0===e.length)return"";var t,n=this._createTable(),o=S(),i=T(8,65533),r=0,s=0;this._result="",this._offset=o.length,this._data=o+e,this._dataLen=this._data.length,o=e=null;for(var a,c,u,h,b,y=-1,v=-1;this._offset<this._dataLen;){if(this._search()?(this._index<d?(c=this._index,u=0):(c=this._index%d,u=(this._index-c)/d),2===this._length?(i[r++]=n[u+54],i[r++]=n[c],s+=2):(i[r++]=n[u+49],i[r++]=n[c],i[r++]=n[this._length],s+=3),this._offset+=this._length,~v&&(v=-1)):(a=this._data.charCodeAt(this._offset++))<132?(a<f?(c=a,u=0,y=g):y=(u=(a-(c=a%f))/f)+g,v===y?(i[r++]=n[c],s++):(i[r++]=n[y-C],i[r++]=n[c],s+=2,v=y)):(a<m?(c=a,u=0,y=_):y=(u=(a-(c=a%m))/m)+_,c<f?(h=c,b=0):b=(c-(h=c%f))/f,v===y?(i[r++]=n[h],i[r++]=n[b],s+=2):(i[r++]=n[48],i[r++]=n[y-l],i[r++]=n[h],i[r++]=n[b],s+=4,v=y)),s>this._maxBytes)return!1;r>=p&&(this._onData(i,r),r=0)}return r>0&&this._onData(i,r),this._onEnd(),t=this._result,this._result=null,null===t?"":t}},v.prototype={_init:function(e){e=e||{},this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd},_createTable:function(){for(var e={},t=0;t<l;t++)e[c.charAt(t)]=t;return e},_onData:function(e){var t;this._onDataCallback&&(e?(t=this._result,this._result=[]):(t=this._result.slice(h,65533),this._result=this._result.slice(0,h).concat(this._result.slice(65533))),t.length>0&&this._onDataCallback(k(t)))},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(e){if(null==e||0===e.length)return"";this._result=function(e){for(var t=[],n=e&&e.length,o=0;o<n;o++)t[o]=e.charCodeAt(o);return t}(S());for(var t,n,o,i,r,s,a,c,l,u,p=this._createTable(),g=!1,C=null,_=e.length,y=0;y<_;y++)if(void 0!==(o=p[e.charAt(y)])){if(o<b)r=g?p[e.charAt(++y)]*f+o+m*C:C*f+o,this._result[this._result.length]=r;else if(o<47)C=o-b,g=!1;else if(48===o)C=(i=p[e.charAt(++y)])-5,g=!0;else if(o<59){if(i=p[e.charAt(++y)],o<54?(s=(o-49)*d+i,a=p[e.charAt(++y)]):(s=(o-54)*d+i,a=2),(c=this._result.slice(-s)).length>a&&(c.length=a),l=c.length,c.length>0)for(u=0;u<a;)for(n=0;n<l&&(this._result[this._result.length]=c[n],!(++u>=a));n++);C=null}this._result.length>=67581&&this._onData()}return this._result=this._result.slice(h),this._onData(!0),this._onEnd(),t=k(this._result),this._result=null,t}},O.prototype={_init:function(e){e=e||{},this._codeStart=e.codeStart||255,this._codeMax=e.codeMax||65535,this._maxBytes=e.maxBytes},compress:function(n){if(null==n||0===n.length)return"";var o,i,r,s,a="",c=0,l=0,u=n.length,d="",h=this._codeStart+1,p=this._codeMax,f=2,m=[],g=0;for(u>0&&(d=o=n.charAt(l++));l<u;)if(r=1<<(s=(i=d+(o=n.charAt(l++))).length),(s<32&&g&r||s>=32&&void 0!==m[s])&&t.call(m[s],i))d+=o;else{if(1===d.length?(a+=d,c++):(a+=m[d.length][d],c+=f),c>this._maxBytes)return!1;h<=p&&(r=1<<(s=(i=d+o).length),(s<32&&!(g&r)||s>=32&&void 0===m[s])&&(m[s]={},g|=r),m[s][i]=e(h++),2048===h&&(f=3)),d=o}return 1===d.length?(a+=d,c++):(a+=m[d.length][d],c+=f),!(c>this._maxBytes)&&a},decompress:function(n){if(null==n||0===n.length)return"";var o,i,r,s,a="",c={},l=this._codeStart+1,u=this._codeStart,d=0,h=n.length;for(h>0&&(o=n.charCodeAt(d++),a+=i=e(o),r=i);d<h;)a+=s=(o=n.charCodeAt(d++))<=u?e(o):t.call(c,o)?c[o]:r+i,i=s.charAt(0),c[l++]=r+i,r=s;return a}},w.prototype={_init:function(e){e=e||{},this._encoding=e.encoding||"utf-8"},compress:function(e){if(null==e||0===e.length)return"";var t,n="",o=B(e=""+e),i=.9*o|0,r=e.length,s={maxBytes:o};return o===r?(t="W",s.codeStart=127,s.codeMax=2047,!1===(n=new O(s).compress(e))&&(t="S",!1===(n=new y(s).compress(e))&&(t="N",n=e))):o>r&&i<r?(t="U",!1===(n=new O(s).compress(E(e)))&&(t="S",!1===(n=new y(s).compress(e))&&(t="N",n=e))):(t="S",!1===(n=new y(s).compress(e))&&(t="U",(!1===(n=new O(s).compress(E(e)))||B(n)>o)&&(t="N",n=e))),t+n},decompress:function(e){if(null==e||0===e.length)return"";switch((e=""+e).charAt(0)){case"S":return this._decompressByS(e.substring(1));case"W":return this._decompressByW(e.substring(1));case"U":return this._decompressByU(e.substring(1));case"N":return this._decompressByN(e.substring(1));default:return e}},_decompressByS:function(e){return(new v).decompress(e)},_decompressByW:function(e){return new O({codeStart:127,codeMax:2047}).decompress(e)},_decompressByU:function(e){return I((new O).decompress(e))},_decompressByN:function(e){return e}};var P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",x=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1];return{compress:function(e,t){return new w(t).compress(e)},decompress:function(e,t){return new w(t).decompress(e)},compressToBase64:function(e,t){return function(e){var t,n,o,i,r,s;for(o=e.length,n=0,t="";n<o;){if(i=255&e.charCodeAt(n++),n===o){t+=P.charAt(i>>2)+P.charAt((3&i)<<4)+"==";break}if(r=e.charCodeAt(n++),n===o){t+=P.charAt(i>>2)+P.charAt((3&i)<<4|(240&r)>>4)+P.charAt((15&r)<<2)+"=";break}s=e.charCodeAt(n++),t+=P.charAt(i>>2)+P.charAt((3&i)<<4|(240&r)>>4)+P.charAt((15&r)<<2|(192&s)>>6)+P.charAt(63&s)}return t}(E(new w(t).compress(e)))},decompressFromBase64:function(t,n){return new w(n).decompress(I(function(t){var n,o,i,r,s,a,c;for(a=t.length,s=0,c="";s<a;){do{n=x[255&t.charCodeAt(s++)]}while(s<a&&-1===n);if(-1===n)break;do{o=x[255&t.charCodeAt(s++)]}while(s<a&&-1===o);if(-1===o)break;c+=e(n<<2|(48&o)>>4);do{if(61==(i=255&t.charCodeAt(s++)))return c;i=x[i]}while(s<a&&-1===i);if(-1===i)break;c+=e((15&o)<<4|(60&i)>>2);do{if(61==(r=255&t.charCodeAt(s++)))return c;r=x[r]}while(s<a&&-1===r);if(-1===r)break;c+=e((3&i)<<6|r)}return c}(t)))}}},e.exports?e.exports=n():t.lzjs=n()},1171:(e,t,n)=>{e.exports=h,h.Minimatch=p;var o={sep:"/"};try{o=n(5622)}catch(e){}var i=h.GLOBSTAR=p.GLOBSTAR={},r=n(3644),s={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},a="[^/]",c="[^/]*?",l="().*{}+?[]^$\\!".split("").reduce((function(e,t){return e[t]=!0,e}),{}),u=/\/+/;function d(e,t){e=e||{},t=t||{};var n={};return Object.keys(t).forEach((function(e){n[e]=t[e]})),Object.keys(e).forEach((function(t){n[t]=e[t]})),n}function h(e,t,n){if("string"!=typeof t)throw new TypeError("glob pattern string required");return n||(n={}),!(!n.nocomment&&"#"===t.charAt(0))&&(""===t.trim()?""===e:new p(t,n).match(e))}function p(e,t){if(!(this instanceof p))return new p(e,t);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"/"!==o.sep&&(e=e.split(o.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function f(e,t){if(t||(t=this instanceof p?this.options:{}),void 0===(e=void 0===e?this.pattern:e))throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:r(e)}h.filter=function(e,t){return t=t||{},function(n,o,i){return h(n,e,t)}},h.defaults=function(e){if(!e||!Object.keys(e).length)return h;var t=h,n=function(n,o,i){return t.minimatch(n,o,d(e,i))};return n.Minimatch=function(n,o){return new t.Minimatch(n,d(e,o))},n},p.defaults=function(e){return e&&Object.keys(e).length?h.defaults(e).Minimatch:p},p.prototype.debug=function(){},p.prototype.make=function(){if(!this._made){var e=this.pattern,t=this.options;if(t.nocomment||"#"!==e.charAt(0))if(e){this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error),this.debug(this.pattern,n),n=this.globParts=n.map((function(e){return e.split(u)})),this.debug(this.pattern,n),n=n.map((function(e,t,n){return e.map(this.parse,this)}),this),this.debug(this.pattern,n),n=n.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,n),this.set=n}else this.empty=!0;else this.comment=!0}},p.prototype.parseNegate=function(){var e=this.pattern,t=!1,n=0;if(!this.options.nonegate){for(var o=0,i=e.length;o<i&&"!"===e.charAt(o);o++)t=!t,n++;n&&(this.pattern=e.substr(n)),this.negate=t}},h.braceExpand=function(e,t){return f(e,t)},p.prototype.braceExpand=f,p.prototype.parse=function(e,t){if(e.length>65536)throw new TypeError("pattern is too long");var n=this.options;if(!n.noglobstar&&"**"===e)return i;if(""===e)return"";var o,r="",u=!!n.nocase,d=!1,h=[],p=[],f=!1,g=-1,C=-1,_="."===e.charAt(0)?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",b=this;function y(){if(o){switch(o){case"*":r+=c,u=!0;break;case"?":r+=a,u=!0;break;default:r+="\\"+o}b.debug("clearStateChar %j %j",o,r),o=!1}}for(var v,O=0,w=e.length;O<w&&(v=e.charAt(O));O++)if(this.debug("%s\t%s %s %j",e,O,r,v),d&&l[v])r+="\\"+v,d=!1;else switch(v){case"/":return!1;case"\\":y(),d=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,O,r,v),f){this.debug("  in class"),"!"===v&&O===C+1&&(v="^"),r+=v;continue}b.debug("call clearStateChar %j",o),y(),o=v,n.noext&&y();continue;case"(":if(f){r+="(";continue}if(!o){r+="\\(";continue}h.push({type:o,start:O-1,reStart:r.length,open:s[o].open,close:s[o].close}),r+="!"===o?"(?:(?!(?:":"(?:",this.debug("plType %j %j",o,r),o=!1;continue;case")":if(f||!h.length){r+="\\)";continue}y(),u=!0;var S=h.pop();r+=S.close,"!"===S.type&&p.push(S),S.reEnd=r.length;continue;case"|":if(f||!h.length||d){r+="\\|",d=!1;continue}y(),r+="|";continue;case"[":if(y(),f){r+="\\"+v;continue}f=!0,C=O,g=r.length,r+=v;continue;case"]":if(O===C+1||!f){r+="\\"+v,d=!1;continue}if(f){var k=e.substring(C+1,O);try{RegExp("["+k+"]")}catch(e){var L=this.parse(k,m);r=r.substr(0,g)+"\\["+L[0]+"\\]",u=u||L[1],f=!1;continue}}u=!0,f=!1,r+=v;continue;default:y(),d?d=!1:!l[v]||"^"===v&&f||(r+="\\"),r+=v}for(f&&(k=e.substr(C+1),L=this.parse(k,m),r=r.substr(0,g)+"\\["+L[0],u=u||L[1]),S=h.pop();S;S=h.pop()){var T=r.slice(S.reStart+S.open.length);this.debug("setting tail",r,S),T=T.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,n){return n||(n="\\"),t+t+n+"|"})),this.debug("tail=%j\n   %s",T,T,S,r);var E="*"===S.type?c:"?"===S.type?a:"\\"+S.type;u=!0,r=r.slice(0,S.reStart)+E+"\\("+T}y(),d&&(r+="\\\\");var I=!1;switch(r.charAt(0)){case".":case"[":case"(":I=!0}for(var B=p.length-1;B>-1;B--){var P=p[B],x=r.slice(0,P.reStart),D=r.slice(P.reStart,P.reEnd-8),R=r.slice(P.reEnd-8,P.reEnd),F=r.slice(P.reEnd);R+=F;var A=x.split("(").length-1,M=F;for(O=0;O<A;O++)M=M.replace(/\)[+*?]?/,"");var N="";""===(F=M)&&t!==m&&(N="$"),r=x+D+F+N+R}if(""!==r&&u&&(r="(?=.)"+r),I&&(r=_+r),t===m)return[r,u];if(!u)return e.replace(/\\(.)/g,"$1");var U=n.nocase?"i":"";try{var j=new RegExp("^"+r+"$",U)}catch(e){return new RegExp("$.")}return j._glob=e,j._src=r,j};var m={};h.makeRe=function(e,t){return new p(e,t||{}).makeRe()},p.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,n=t.noglobstar?c:t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",o=t.nocase?"i":"",r=e.map((function(e){return e.map((function(e){return e===i?n:"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e._src})).join("\\/")})).join("|");r="^(?:"+r+")$",this.negate&&(r="^(?!"+r+").*$");try{this.regexp=new RegExp(r,o)}catch(e){this.regexp=!1}return this.regexp},h.match=function(e,t,n){var o=new p(t,n=n||{});return e=e.filter((function(e){return o.match(e)})),o.options.nonull&&!e.length&&e.push(t),e},p.prototype.match=function(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var n=this.options;"/"!==o.sep&&(e=e.split(o.sep).join("/")),e=e.split(u),this.debug(this.pattern,"split",e);var i,r,s=this.set;for(this.debug(this.pattern,"set",s),r=e.length-1;r>=0&&!(i=e[r]);r--);for(r=0;r<s.length;r++){var a=s[r],c=e;if(n.matchBase&&1===a.length&&(c=[i]),this.matchOne(c,a,t))return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate},p.prototype.matchOne=function(e,t,n){var o=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var r=0,s=0,a=e.length,c=t.length;r<a&&s<c;r++,s++){this.debug("matchOne loop");var l,u=t[s],d=e[r];if(this.debug(t,u,d),!1===u)return!1;if(u===i){this.debug("GLOBSTAR",[t,u,d]);var h=r,p=s+1;if(p===c){for(this.debug("** at the end");r<a;r++)if("."===e[r]||".."===e[r]||!o.dot&&"."===e[r].charAt(0))return!1;return!0}for(;h<a;){var f=e[h];if(this.debug("\nglobstar while",e,h,t,p,f),this.matchOne(e.slice(h),t.slice(p),n))return this.debug("globstar found match!",h,a,f),!0;if("."===f||".."===f||!o.dot&&"."===f.charAt(0)){this.debug("dot detected!",e,h,t,p);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!n||(this.debug("\n>>> no match, partial?",e,h,t,p),h!==a))}if("string"==typeof u?(l=o.nocase?d.toLowerCase()===u.toLowerCase():d===u,this.debug("string match",u,d,l)):(l=d.match(u),this.debug("pattern match",u,d,l)),!l)return!1}if(r===a&&s===c)return!0;if(r===a)return n;if(s===c)return r===a-1&&""===e[r];throw new Error("wtf?")}},1890:(e,t,n)=>{const o=n(4231),i=n(3610),{mkdirpNative:r,mkdirpNativeSync:s}=n(9378),{mkdirpManual:a,mkdirpManualSync:c}=n(8600),{useNative:l,useNativeSync:u}=n(6167),d=(e,t)=>(e=i(e),t=o(t),l(t)?r(e,t):a(e,t));d.sync=(e,t)=>(e=i(e),t=o(t),u(t)?s(e,t):c(e,t)),d.native=(e,t)=>r(i(e),o(t)),d.manual=(e,t)=>a(i(e),o(t)),d.nativeSync=(e,t)=>s(i(e),o(t)),d.manualSync=(e,t)=>c(i(e),o(t)),e.exports=d},8812:(e,t,n)=>{const{dirname:o}=n(5622),i=(e,t,n)=>n===t?Promise.resolve():e.statAsync(t).then((e=>e.isDirectory()?n:void 0),(n=>"ENOENT"===n.code?i(e,o(t),t):void 0)),r=(e,t,n)=>{if(n!==t)try{return e.statSync(t).isDirectory()?n:void 0}catch(n){return"ENOENT"===n.code?r(e,o(t),t):void 0}};e.exports={findMade:i,findMadeSync:r}},8600:(e,t,n)=>{const{dirname:o}=n(5622),i=(e,t,n)=>{t.recursive=!1;const r=o(e);return r===e?t.mkdirAsync(e,t).catch((e=>{if("EISDIR"!==e.code)throw e})):t.mkdirAsync(e,t).then((()=>n||e),(o=>{if("ENOENT"===o.code)return i(r,t).then((n=>i(e,t,n)));if("EEXIST"!==o.code&&"EROFS"!==o.code)throw o;return t.statAsync(e).then((e=>{if(e.isDirectory())return n;throw o}),(()=>{throw o}))}))},r=(e,t,n)=>{const i=o(e);if(t.recursive=!1,i===e)try{return t.mkdirSync(e,t)}catch(e){if("EISDIR"!==e.code)throw e;return}try{return t.mkdirSync(e,t),n||e}catch(o){if("ENOENT"===o.code)return r(e,t,r(i,t,n));if("EEXIST"!==o.code&&"EROFS"!==o.code)throw o;try{if(!t.statSync(e).isDirectory())throw o}catch(e){throw o}}};e.exports={mkdirpManual:i,mkdirpManualSync:r}},9378:(e,t,n)=>{const{dirname:o}=n(5622),{findMade:i,findMadeSync:r}=n(8812),{mkdirpManual:s,mkdirpManualSync:a}=n(8600);e.exports={mkdirpNative:(e,t)=>(t.recursive=!0,o(e)===e?t.mkdirAsync(e,t):i(t,e).then((n=>t.mkdirAsync(e,t).then((()=>n)).catch((n=>{if("ENOENT"===n.code)return s(e,t);throw n}))))),mkdirpNativeSync:(e,t)=>{if(t.recursive=!0,o(e)===e)return t.mkdirSync(e,t);const n=r(t,e);try{return t.mkdirSync(e,t),n}catch(n){if("ENOENT"===n.code)return a(e,t);throw n}}}},4231:(e,t,n)=>{const{promisify:o}=n(1669),i=n(5747);e.exports=e=>{if(e)if("object"==typeof e)e={mode:511,fs:i,...e};else if("number"==typeof e)e={mode:e,fs:i};else{if("string"!=typeof e)throw new TypeError("invalid options argument");e={mode:parseInt(e,8),fs:i}}else e={mode:511,fs:i};return e.mkdir=e.mkdir||e.fs.mkdir||i.mkdir,e.mkdirAsync=o(e.mkdir),e.stat=e.stat||e.fs.stat||i.stat,e.statAsync=o(e.stat),e.statSync=e.statSync||e.fs.statSync||i.statSync,e.mkdirSync=e.mkdirSync||e.fs.mkdirSync||i.mkdirSync,e}},3610:(e,t,n)=>{const o=process.env.__TESTING_MKDIRP_PLATFORM__||process.platform,{resolve:i,parse:r}=n(5622);e.exports=e=>{if(/\0/.test(e))throw Object.assign(new TypeError("path must be a string without null bytes"),{path:e,code:"ERR_INVALID_ARG_VALUE"});if(e=i(e),"win32"===o){const t=/[*|"<>?:]/,{root:n}=r(e);if(t.test(e.substr(n.length)))throw Object.assign(new Error("Illegal characters in path."),{path:e,code:"EINVAL"})}return e}},6167:(e,t,n)=>{const o=n(5747),i=(process.env.__TESTING_MKDIRP_NODE_VERSION__||process.version).replace(/^v/,"").split("."),r=+i[0]>10||10==+i[0]&&+i[1]>=12,s=r?e=>e.mkdir===o.mkdir:()=>!1,a=r?e=>e.mkdirSync===o.mkdirSync:()=>!1;e.exports={useNative:s,useNativeSync:a}},3320:(e,t,n)=>{"use strict";const o=n(5747);e.exports=class{constructor(e,t){(t=t||{}).readChunk||(t.readChunk=1024),t.newLineCharacter?t.newLineCharacter=t.newLineCharacter.charCodeAt(0):t.newLineCharacter=10,this.fd="number"==typeof e?e:o.openSync(e,"r"),this.options=t,this.newLineCharacter=t.newLineCharacter,this.reset()}_searchInBuffer(e,t){let n=-1;for(let o=0;o<=e.length;o++)if(e[o]===t){n=o;break}return n}reset(){this.eofReached=!1,this.linesCache=[],this.fdPosition=0}close(){o.closeSync(this.fd),this.fd=null}_extractLines(e){let t;const n=[];let o=0,i=0;for(;;){let r=e[o++];if(r===this.newLineCharacter)t=e.slice(i,o),n.push(t),i=o;else if(void 0===r)break}let r=e.slice(i,o);return r.length&&n.push(r),n}_readChunk(e){let t,n=0;const i=[];do{const e=new Buffer(this.options.readChunk);t=o.readSync(this.fd,e,0,this.options.readChunk,this.fdPosition),n+=t,this.fdPosition=this.fdPosition+t,i.push(e)}while(t&&-1===this._searchInBuffer(i[i.length-1],this.options.newLineCharacter));let r=Buffer.concat(i);return t<this.options.readChunk&&(this.eofReached=!0,r=r.slice(0,n)),n&&(this.linesCache=this._extractLines(r),e&&(this.linesCache[0]=Buffer.concat([e,this.linesCache[0]]))),n}next(){if(!this.fd)return!1;let e,t=!1;return this.eofReached&&0===this.linesCache.length||(this.linesCache.length||(e=this._readChunk()),this.linesCache.length&&(t=this.linesCache.shift(),t[t.length-1]!==this.newLineCharacter&&(e=this._readChunk(t),e&&(t=this.linesCache.shift()))),this.eofReached&&0===this.linesCache.length&&this.close(),t&&t[t.length-1]===this.newLineCharacter&&(t=t.slice(0,t.length-1))),t}}},75:function(e){(function(){var t,n,o,i,r,s;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(e.exports=function(){return(t()-r)/1e6},n=process.hrtime,i=(t=function(){var e;return 1e9*(e=n())[0]+e[1]})(),s=1e9*process.uptime(),r=i-s):Date.now?(e.exports=function(){return Date.now()-o},o=Date.now()):(e.exports=function(){return(new Date).getTime()-o},o=(new Date).getTime())}).call(this)},9115:(e,t,n)=>{const o=n(8340);e.exports=function(e,t,n){return new o(e,t,n)}},8340:(e,t,n)=>{const{readFileSync:o,statSync:i}=n(5747),r=n(6275).propertyAppender,s=n(1112).L,a=Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty),c=Symbol("SECTION");function l(e,t,n={}){this._encoding="string"==typeof t&&t||"utf-8",this._properties={},this._propertiesExpanded={},this.appender(n.appender||n),this.writer(n.writer||n),this.append(e,t)}l.prototype[c]="",Object.defineProperty(l.prototype,"length",{configurable:!1,enumerable:!1,get(){return Object.keys(this._properties).length}}),l.prototype.appender=function(e){return"function"==typeof e?this._propertyAppender=e:"object"==typeof e&&(this._propertyAppender=r(e)),this},l.prototype.writer=function(e){return"function"==typeof e?this._propertyWriter=e:"object"==typeof e&&(this._propertyWriter=s(e)),this},l.prototype.append=function(e,t){return e&&this.read(o(e,"string"==typeof t&&t||this._encoding)),this},l.prototype.read=function(e){return delete this[c],(""+e).split("\n").forEach(this._readLine,this),this},l.prototype._readLine=function(e){if(e=e.trim()){var t=/^\[([^=]+)]$/.exec(e),n=!t&&/^([^#=]+)(={0,1})(.*)$/.exec(e);t?this[c]=t[1]:n&&(t=this[c]?this[c]+".":"",this.set(t+n[1].trim(),n[3].trim()))}},l.prototype.each=function(e,t){for(var n in this._properties)this._properties.hasOwnProperty(n)&&e.call(t||this,n,this._properties[n]);return this},l.prototype._parsed=function(e){if(null!==e&&""!==e&&!isNaN(e))return+e;if("true"===e||"false"===e)return"true"===e;if("string"==typeof e){var t={"\\n":"\n","\\r":"\r","\\t":"\t"};return e.replace(/\\[nrt]/g,(function(e){return t[e]}))}return e},l.prototype.get=function(e){return this._parsed(this.getRaw(e))},l.prototype.getRaw=function(e){return this._properties.hasOwnProperty(e)?this._properties[e]:null},l.prototype.set=function(e,t){var n=(""+t).trim();this._properties=this._propertyAppender(this._properties,e,n);for(var o=e.split("."),i=this._propertiesExpanded;o.length>1;){var r=o.shift();o.length>=1&&"string"==typeof i[r]&&(i[r]={"":i[r]}),a(i,r)||Object.defineProperty(i,r,{value:{}}),i=i[r]}return"string"==typeof n&&"object"==typeof i[o[0]]?i[o[0]][""]=n:i[o[0]]=n,this},l.prototype.path=function(){return this._propertiesExpanded},l.prototype.getAllProperties=function(){var e={};return this.each((function(t,n){e[t]=n})),e},l.prototype.clone=function(){var e=new l(null);return this.each(e.set,e),e},l.prototype.getByRoot=function(e){for(var t=Object.keys(this._properties),n={},o=0,i=String(e).length;o<t.length;o++){var r=t[o];0===r.indexOf(e)&&"."===r.charAt(i)&&(n[r.substr(i+1)]=this.get(r))}return n},l.prototype.bindToExpress=function(e,t,o){var r=n(5622);return/\/$/.test(t=t||process.cwd())||(t+="/"),this.each((function(s,a){if(a&&/\.(path|dir)$/.test(s)){a=r.resolve(t,a),this.set(s,a);try{var c=/dir$/.test(s)?a:r.dirname(a);if(o)n(1890).sync(c);else if(!i(c).isDirectory())throw new Error("Path is not a directory that already exists")}catch(e){throw new Error("Unable to create directory "+a)}}e.set(s,this.get(s)),/^browser\./.test(s)&&(e.locals[s.substr(8)]=this.get(s))}),this),e.set("properties",this),this},l.prototype.save=function(e,t){return this._propertyWriter(this,e,t)},e.exports=l},6275:e=>{var t={allowDuplicateSections:!1};function n(e,t,n){return e[t]=n,e}function o(e,t,n){var o,i,r={},s=(o=t,(i=String(o).indexOf("."))>0&&o.substr(0,i)||""),a=Object.keys(e);if(!s||!a.length)return r[t]=n,Object.assign(e,r);var c=1;return a.forEach((function(o){var i=4!==c&&0===o.indexOf(s+".");t===o?(e[o]=n,c=4):1===c&&i?c=2:2!==c||i||(r[t]=n,c=4),r[o]=e[o]})),4!==c&&(r[t]=n),r}e.exports={defaultOptions:t,propertyAppender:function(e){return Object.assign({},t,e||{}).allowDuplicateSections?n:o}}},1112:(e,t,n)=>{const o=n(5747),i={saveSections:!0};e.exports.L=function(e){const t=Object.assign({},i,e||{});return(e,n,i)=>{const r=new Promise(((i,r)=>{const s=(t.saveSections?function(e){var t=[],n=null;return e.each((function(e,o){var i=e.split(".");i.length>1?(n!==i[0]&&(n=i[0],t.push("["+n+"]")),e=i.slice(1).join(".")):n=null,t.push(e+"="+o)})),t}(e):function(e){const t=[];return e.each(((e,n)=>t.push(`${e}=${n}`))),t}(e)).join("\n");o.writeFile(n,s,(e=>{if(e)return r(e);i(s)}))}));return"function"==typeof i&&(i.length>1?r.then((()=>i(null)),(e=>i(e))):r.then(i)),r}}},1661:(e,t,n)=>{"use strict";const o=n(5747),i=n(2087),r=Symbol.for("__RESOLVED_TEMP_DIRECTORY__");global[r]||Object.defineProperty(global,r,{value:o.realpathSync(i.tmpdir())}),e.exports=global[r]},7337:(e,t,n)=>{e.exports=n(7557)},7557:(e,t,n)=>{var o=n(4867),i=/^[\s]*$/,r=[{regex:/[åäàáâãæ]/gi,alternate:"a"},{regex:/[èéêë]/gi,alternate:"e"},{regex:/[ìíîï]/gi,alternate:"i"},{regex:/[òóôõö]/gi,alternate:"o"},{regex:/[ùúûü]/gi,alternate:"u"},{regex:/[æ]/gi,alternate:"ae"}];String.prototype.replaceCharAt=function(e,t){return this.substr(0,e)+t+this.substr(e+t.length)};var s=function(e,t){this.options=t||{},this.options.ignoreCase=void 0===this.options.ignoreCase||this.options.ignoreCase,this.options.maxCacheSize=this.options.maxCacheSize||64,this.options.cache=!this.options.hasOwnProperty("cache")||this.options.cache,this.options.splitOnRegEx=this.options.hasOwnProperty("splitOnRegEx")?this.options.splitOnRegEx:/\s/g,this.options.splitOnGetRegEx=this.options.hasOwnProperty("splitOnGetRegEx")?this.options.splitOnGetRegEx:this.options.splitOnRegEx,this.options.min=this.options.min||1,this.options.keepAll=!!this.options.hasOwnProperty("keepAll")&&this.options.keepAll,this.options.keepAllKey=this.options.hasOwnProperty("keepAllKey")?this.options.keepAllKey:"id",this.options.idFieldOrFunction=this.options.hasOwnProperty("idFieldOrFunction")?this.options.idFieldOrFunction:void 0,this.options.expandRegexes=this.options.expandRegexes||r,this.options.insertFullUnsplitKey=!!this.options.hasOwnProperty("insertFullUnsplitKey")&&this.options.insertFullUnsplitKey,this.keyFields=e?e instanceof Array?e:[e]:[],this.root={},this.size=0,this.options.cache&&(this.getCache=new o("key"))};function a(e,t){return 1===t.length?e[t[0]]:a(e[t[0]],t.slice(1,t.length))}s.prototype={add:function(e,t){this.options.cache&&this.clearCache(),"number"==typeof t&&(t=void 0);var n=t||this.keyFields;for(var o in n){var i=n[o],r=i instanceof Array?a(e,i):e[i];if(r){r=r.toString();for(var s=this.expandString(r),c=0;c<s.length;c++){var l=s[c];this.map(l,e)}}}},expandString:function(e){var t=[e];if(this.options.expandRegexes&&this.options.expandRegexes.length)for(var n=0;n<this.options.expandRegexes.length;n++)for(var o,i=this.options.expandRegexes[n];null!==(o=i.regex.exec(e));){var r=e.replaceCharAt(o.index,i.alternate);t.push(r)}return t},addAll:function(e,t){for(var n=0;n<e.length;n++)this.add(e[n],t)},reset:function(){this.root={},this.size=0},clearCache:function(){this.getCache=new o("key")},cleanCache:function(){for(;this.getCache.all.length>this.options.maxCacheSize;)this.getCache.remove(this.getCache.all[0])},addFromObject:function(e,t){for(var n in this.options.cache&&this.clearCache(),t=t||"value",-1==this.keyFields.indexOf("_key_")&&this.keyFields.push("_key_"),e){var o={_key_:n};o[t]=e[n],this.add(o)}},map:function(e,t){if(this.options.splitOnRegEx&&this.options.splitOnRegEx.test(e)){var n=e.split(this.options.splitOnRegEx),r=n.filter((function(e){return i.test(e)}));if(n.filter((function(t){return t===e})).length+r.length!==n.length){for(var s=0,a=n.length;s<a;s++)i.test(n[s])||this.map(n[s],t);if(!this.options.insertFullUnsplitKey)return}}this.options.cache&&this.clearCache(),this.options.keepAll&&(this.indexed=this.indexed||new o([this.options.keepAllKey]),this.indexed.add(t)),this.options.ignoreCase&&(e=e.toLowerCase());var c=this.keyToArr(e),l=this;!function e(t,n,o){if(0==t.length)return o.value=o.value||[],void o.value.push(n);var i=t.shift();o[i]||l.size++,o[i]=o[i]||{},e(t,n,o[i])}(c,t,this.root)},keyToArr:function(e){var t;if(this.options.min&&this.options.min>1){if(e.length<this.options.min)return[];t=(t=[e.substr(0,this.options.min)]).concat(e.substr(this.options.min).split(""))}else t=e.split("");return t},findNode:function(e){return function e(t,n){if(n){if(0==t.length)return n;var o=t.shift();return e(t,n[o])}}(this.keyToArr(e),this.root)},_getCacheKey:function(e,t){var n=e;return t&&(n=e+"_"+t),n},_get:function(e,t){var n,i;if(e=this.options.ignoreCase?e.toLowerCase():e,this.options.cache&&(n=this.getCache.get(this._getCacheKey(e,t))))return n.value;for(var r=void 0,s=this.options.indexField?[this.options.indexField]:this.keyFields,a=this.options.splitOnGetRegEx?e.split(this.options.splitOnGetRegEx):[e],c=0,l=a.length;c<l;c++)if(!(this.options.min&&a[c].length<this.options.min)){var u=new o(s);(i=this.findNode(a[c]))&&p(i,u),r=r?r.intersection(u):u}var d=r?r.all:[];if(this.options.cache){var h=this._getCacheKey(e,t);this.getCache.add({key:h,value:d}),this.cleanCache()}return d;function p(e,n){if(!t||n.all.length!==t){if(e.value&&e.value.length){if(t&&!(n.all.length+e.value.length<t))return void n.addAll(e.value.slice(0,t-n.all.length));n.addAll(e.value)}for(var o in e){if(t&&n.all.length===t)return;"value"!=o&&p(e[o],n)}}}},get:function(e,t,n){var i=this.options.indexField?[this.options.indexField]:this.keyFields,r=void 0,s=void 0;if(t&&!this.options.idFieldOrFunction)throw new Error("To use the accumulator, you must specify and idFieldOrFunction");for(var a=0,c=(e=e instanceof Array?e:[e]).length;a<c;a++){var l=this._get(e[a],n);t?s=t(s,e[a],l,this):r=r?r.addAll(l):new o(i).addAll(l)}return t?s:r.all},search:function(e,t){return this.get(e,t)},getId:function(e){return"function"==typeof this.options.idFieldOrFunction?this.options.idFieldOrFunction(e):e[this.options.idFieldOrFunction]}},s.UNION_REDUCER=function(e,t,n,o){if(void 0===e)return n;var i,r,s={},a=Math.max(e.length,n.length),c=[],l=0;for(i=0;i<a;i++)i<e.length&&(s[r=o.getId(e[i])]=s[r]?s[r]:0,s[r]++,2===s[r]&&(c[l++]=e[i])),i<n.length&&(s[r=o.getId(n[i])]=s[r]?s[r]:0,s[r]++,2===s[r]&&(c[l++]=n[i]));return c},e.exports=s},5945:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.BldScriptTaskProvider=void 0;const a=r(n(5622)),c=r(n(7549)),l=n(627),u=n(6271);class d{constructor(){this.bldScriptPromise=void 0}provideTasks(){const e=this.getFileFromWorkspace();if(void 0!==e)return this.bldScriptPromise||(this.bldScriptPromise=function(e){return s(this,void 0,void 0,(function*(){const t=[],n=new c.ShellExecution(`${d.scriptPrefix}${e}`,d.getSHEOptions(e)),o={type:d.BldScriptType,arguments:""},i=new c.Task(o,c.TaskScope.Workspace,d.BldSource,d.BldScriptType,n,d.getProblemMatchers()),r=a.default.dirname(e),s=e.substr(1+r.length);return i.detail=`Execute ${s}`,i.group=c.TaskGroup.Build,t.push(i),t}))}(e)),this.bldScriptPromise}static getSHEOptions(e){return{cwd:a.dirname(e)}}static getProblemMatchers(){const e=[],t=process.env.ACUCOBOL,n=process.env.COBDIR,o=process.env.COBOLITDIR;return void 0!==t&&e.push("$acucobol-ccbl"),void 0!==n&&e.push("$mfcobol-errformat3"),void 0!==o&&e.push("$cobolit-cobc"),e}resolveTask(e){const t=this.getFileFromWorkspace();if(void 0===t)return;const n=e.definition.task;if(n){const o=e.definition,i=new c.ShellExecution(`${d.scriptPrefix}${t} ${o.arguments}`,d.getSHEOptions(t)),r=new c.Task(o.task,c.TaskScope.Workspace,d.BldSource,d.BldScriptType,i,d.getProblemMatchers()),s=a.default.dirname(t),l=`${t.substr(1+s.length)} (in ${s})`;return n.detail=`Execute ${l}`,r}}getFileFromWorkspace(){const e=l.getWorkspaceFolders();if(void 0!==e)for(const t of e)if("file"===t.uri.scheme){const e=d.scriptName,n=a.default.join(t.uri.fsPath,e);try{if(u.COBOLFileUtils.isFile(n))return n}catch(e){}}}}t.BldScriptTaskProvider=d,d.scriptPlatform=u.COBOLFileUtils.isWin32?"Windows Batch":"Unix Script",d.BldScriptType="COBOLBuildScript",d.BldSource=`${d.scriptPlatform} File`,d.scriptName=u.COBOLFileUtils.isWin32?"bld.bat":"./bld.sh",d.scriptPrefix=u.COBOLFileUtils.isWin32?"cmd.exe /c ":""},2917:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CachedCOBOLSourceDefinition=void 0;const a=r(n(7549)),c=s(n(6560)),l=n(7892),u=n(9811),d=n(3130),h=n(112);t.CachedCOBOLSourceDefinition=class{constructor(){this.sectionRegEx=new RegExp("[0-9a-zA-Z][a-zA-Z0-9-_]*"),this.variableRegEx=new RegExp("[#0-9a-zA-Z][a-zA-Z0-9-_]*")}provideDefinition(e,t,n){return this.resolveDefinitions(e,t,n)}resolveDefinitions(e,t,n){const o=[],i=l.VSCOBOLConfiguration.get();if(i.parse_copybooks_for_references)return o;const r=c.default.getDeprecatedCacheDirectory();if(void 0===r)return o;let s;if(e.lineAt(t).text.match(/.*(perform|thru|go\s*to|until|varying).*$/i)){if(s=c.default.getCachedObject(e,i),void 0===s)return o;const n=e.getWordRangeAtPosition(t,this.sectionRegEx),a=(n?e.getText(n):"").toLowerCase();if(a.length>0)for(const[e,t]of s.copyBooksUsed)try{let n=t.statementInformation.fileName;if(null!==n&&0!==n.length||(n=u.COBOLCopyBookProvider.expandLogicalCopyBookToFilenameOrEmpty(e,t.token.extraInformation,i)),n.length>0){const e=d.COBOLSymbolTableHelper.getSymbolTableGivenFile(r,n);if(void 0!==e){const t=e.labelSymbols.get(a);void 0!==t&&void 0!==t.lnum&&this.getLocationGivenFile(n,t.lnum,o)}}}catch(e){h.logException(e.message,e)}}if(void 0===s&&(s=c.default.getCachedObject(e,i)),void 0===s)return o;const a=e.getWordRangeAtPosition(t,this.variableRegEx),p=(a?e.getText(a):"").toLowerCase();if(p.length>0&&void 0!==r)for(const[e,t]of s.copyBooksUsed)try{let n=t.statementInformation.fileName;if(null!==n&&0!==n.length||(n=u.COBOLCopyBookProvider.expandLogicalCopyBookToFilenameOrEmpty(e,t.token.extraInformation,i)),n.length>0){const e=d.COBOLSymbolTableHelper.getSymbolTableGivenFile(r,n);if(void 0!==e){const t=e.variableSymbols.get(p);void 0!==t&&void 0!==t.lnum&&this.getLocationGivenFile(n,t.lnum,o)}}}catch(e){h.logException(e.message,e)}return o}getLocationGivenFile(e,t,n){const o=a.Uri.file(e),i=new a.Location(o,new a.Position(t,0));n.push(i)}}},4244:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.COBOLCaseFormatter=void 0;const a=r(n(7549)),c=n(7549),l=n(8548),u=n(7892),d=n(7925),h=s(n(6560));class p{convertLine(e,t,n,o){const i=e;let r=l.COBOLUtils.foldTokenLine(i,n,l.FoldAction.Keywords,t,o);return r=l.COBOLUtils.foldTokenLine(r,n,l.FoldAction.ConstantsOrVariables,t,o),l.COBOLUtils.foldTokenLine(r,n,l.FoldAction.PerformTargets,t,o)}provideOnTypeFormattingEdits(e,t,n,o,i){if("\n"!==n)return;const r=u.VSCOBOLConfiguration.get();if(r.format_on_return===d.formatOnReturn.Off)return;const s=h.default.getCachedObject(e,r);if(void 0===s)return;const p=t.line-1,f=e.lineAt(p);if(f){const e=f.text,t=r.format_on_return===d.formatOnReturn.CamelCase?this.convertLine(e,l.FoldStyle.CamelCase,s,r.format_constants_to_uppercase):this.convertLine(e,l.FoldStyle.UpperCase,s,r.format_constants_to_uppercase);if(t!==e){const e=new a.Position(p,0),n=new a.Position(p,t.length),o=new a.Range(e,n);return[c.TextEdit.replace(o,t)]}}return[]}static register(){return c.languages.registerOnTypeFormattingEditProvider([{scheme:"file",language:"COBOL"},{scheme:"file",language:"COBOLIT"},{scheme:"file",language:"ACUCOBOL"}],new p,"\n")}}t.COBOLCaseFormatter=p},4632:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COBAPIConstants=void 0;class n{}t.COBAPIConstants=n,n.COB_API_INTERFACE_VERSION=2},3911:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CobApiOutput=t.CobApiHandle=void 0,t.CobApiHandle=class{constructor(e,t){if(this.callback=void 0,this.packageJson=e,this.externalFeatures=t,void 0!==e.name&&void 0!==e.publisher?this.id=`${e.publisher}.${e.name}`:this.id="",void 0!==e.description?this.description=`${e.description}`:this.description="",void 0!==e.bugs&&void 0!==e.bugs.url?this.bugReportUrl=`${e.bugs.url}`:this.bugReportUrl="",void 0!==e.bugs&&void 0!==e.bugs.email?this.bugReportEmail=`${e.bugs.email}`:this.bugReportEmail="",0===this.id.length)throw new Error("Invalid packageJSON, no id present (registerPreprocessor)");if(0===this.bugReportEmail.length)throw new Error("Invalid packageJSON, no bug email address present (registerPreprocessor)");if(0===this.bugReportUrl.length)throw new Error("Invalid packageJSON, no bug url present to report issue (registerPreprocessor)");this.info=`${this.id}`}logWarningMessage(e){this.externalFeatures.logMessage(`[${this.info}]: ${e}`)}},t.CobApiOutput=class{constructor(){this.lines=[],this.externalFiles=new Map}addLine(e){this.lines.push(e)}addLines(e){for(const t of e)this.lines.push(t)}addFileSymbol(e,t){this.externalFiles.set(e,t)}}},7118:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.COBOLCallTargetProvider=void 0;const s=r(n(7549)),a=n(7892),c=n(9811),l=n(5363);t.COBOLCallTargetProvider=class{constructor(){this.callRegEx=new RegExp("[0-9a-zA-Z][a-zA-Z0-9-_]*")}provideDefinition(e,t,n){return this.resolveDefinitions(e,t,n)}resolveDefinitions(e,t,n){const o=[],i=a.VSCOBOLConfiguration.get();if(e.lineAt(t).text.match(/.*(call|cancel|chain).*$/i)){const n=e.getWordRangeAtPosition(t,this.callRegEx),r=n?e.getText(n):"";if(""!==r){const e=l.InMemoryGlobalSymbolCache,t=r.toLowerCase();if(e.defaultCallableSymbols.has(t)){const n=e.defaultCallableSymbols.get(t);void 0!==n&&this.getLocationGivenFile(n,0,o)}if(e.callableSymbols.has(t)){const n=e.callableSymbols.get(t);if(void 0!==n)for(let e=0;e<n.length;e++){const t=n[e];if(void 0!==t&&void 0!==t.filename&&void 0!==t.lnum){const e=c.COBOLCopyBookProvider.expandLogicalCopyBookToFilenameOrEmpty(t.filename,"",i);0!==e.length&&this.getLocationGivenFile(e,t.lnum,o)}}}if(e.entryPoints.has(t)){const n=e.entryPoints.get(t);if(void 0!==n)for(let e=0;e<n.length;e++){const t=n[e];if(void 0!==t&&void 0!==t.filename&&void 0!==t.lnum){const e=c.COBOLCopyBookProvider.expandLogicalCopyBookToFilenameOrEmpty(t.filename,"",i);0!==e.length&&this.getLocationGivenFile(e,t.lnum,o)}}}}}return o}getLocationGivenFile(e,t,n){const o=s.Uri.file(e),i=new s.Location(o,new s.Position(t,0));n.push(i)}}},627:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorkspaceFolders=void 0;const o=n(7549),i=n(7892);t.getWorkspaceFolders=function(){const e=o.workspace.workspaceFolders;if(void 0===e)return e;const t=i.VSCOBOLConfiguration.get().workspacefolders_order,n=new Map;for(const t of e)"file"===t.uri.scheme&&n.set(t.name,t);const r=[];if(0!==t.length)for(const e of t){const t=n.get(e);void 0!==t&&(r.push(t),n.delete(e))}for(const[e,t]of n)r.push(t);return r}},4669:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryFileSymbolCache=t.COBOLSymbol=t.COBOLFileSymbol=t.COBOLSymbolTable=t.COBOLGlobalSymbolTable=t.COBOLWorkspaceFile=void 0,t.COBOLWorkspaceFile=class{constructor(e,t){this.lastModifiedTime=e,this.workspaceFilename=t}};class n{constructor(){this.defaultCallableSymbols=new Map,this.callableSymbols=new Map,this.entryPoints=new Map,this.types=new Map,this.interfaces=new Map,this.enums=new Map,this.knownCopybooks=new Map,this.isDirty=!1,this.sourceFilenameModified=new Map}static fromJSON(e){return Object.assign(new n,e)}}t.COBOLGlobalSymbolTable=n;class o{constructor(){this.lastModifiedTime=BigInt("0"),this.fileName="",this.variableSymbols=new Map,this.labelSymbols=new Map}static fromJSON(e){return Object.assign(new o,e)}}t.COBOLSymbolTable=o;class i{constructor(e,t){this.filename=void 0===e?"":e,this.lnum=void 0===t?0:t}static fromJSON(e){return Object.assign(new i,e)}}t.COBOLFileSymbol=i;class r{constructor(e,t){this.symbol=e,this.lnum=t}static fromJSON(e){return Object.assign(new r,e)}}t.COBOLSymbol=r,t.InMemoryFileSymbolCache=new Map},3130:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.COBOLSymbolTableHelper=t.reviver=t.replacer=void 0;const s=r(n(5747)),a=r(n(5622)),c=r(n(6417)),l=n(4669),u=n(6271),d=n(3679);function h(e,t){if("bigint"==typeof t)return t.toString();const n=this[e];return n instanceof Map?{dataType:"Map",value:Array.from(n.entries())}:t}function p(e,t){return"object"==typeof t&&null!==t&&"Map"===t.dataType?new Map(t.value):t}t.replacer=h,t.reviver=p,t.COBOLSymbolTableHelper=class{static getHashForFilename(e){const t=c.createHash("sha256");return t.update(e),t.digest("hex")}static saveToFile(e,t){const n=a.join(e,this.getHashForFilename(t.fileName)+".sym");s.writeFileSync(n,d.compress(JSON.stringify(t,h)))}static getSymbolTableGivenFile(e,t){const n=a.normalize(t);if(l.InMemoryFileSymbolCache.has(n)){const e=l.InMemoryFileSymbolCache.get(n);if(void 0!==e){try{if(s.statSync(n,{bigint:!0}).mtimeMs===e.lastModifiedTime)return e}catch(e){}l.InMemoryFileSymbolCache.delete(n)}}const o=a.join(e,this.getHashForFilename(n)+".sym"),i=u.COBOLFileUtils.isFileT(o);if(i[0]){try{const e=i[1],t=s.statSync(n);if(void 0!==e&&e.mtimeMs<t.mtimeMs){try{s.unlinkSync(o)}catch(e){}return}}catch(e){try{s.unlinkSync(o)}catch(e){}return}const e=s.readFileSync(o).toString();try{const t=JSON.parse(d.decompress(e),p);return l.InMemoryFileSymbolCache.set(n,t),t}catch(e){try{s.unlinkSync(o)}catch(e){}return}}}static getSymbolTable_direct(e){const t=s.readFileSync(e).toString();try{return JSON.parse(d.decompress(t),p)}catch(t){try{s.unlinkSync(e)}catch(e){}}}}},4155:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CobolLinterProvider=t.CobolLinterActionFixer=void 0;const c=r(n(7549)),l=n(9131),u=a(n(6560)),d=n(842);function h(e){try{return new RegExp("^"+e+"$","i")}catch(e){return}}t.CobolLinterActionFixer=class{provideCodeActions(e,t,n,o){const i=[];for(const t of n.diagnostics)if(void 0!==t.code&&!0===t.code.toString().startsWith(d.CobolLinterProviderSymbols.NotReferencedMarker_internal)){const n=e.offsetAt(new c.Position(t.range.start.line,0)),o=t.code.toString().replace(d.CobolLinterProviderSymbols.NotReferencedMarker_internal,d.CobolLinterProviderSymbols.NotReferencedMarker_external);i.push({title:`Add COBOL lint ignore comment for '${t.message}'`,diagnostics:[t],command:{title:"Add COBOL lint comment to ignore the warning",command:"cobolplugin.insertIgnoreCommentLine",arguments:[e.uri,n,o]},kind:c.CodeActionKind.QuickFix})}return i}insertIgnoreCommentLine(e,t,n){return s(this,void 0,void 0,(function*(){yield c.window.showTextDocument(e);const o=c.window.activeTextEditor;if(void 0!==o&&void 0!==n){const e=o.document.positionAt(t);o.edit((t=>{t.insert(e,"      *> cobol-lint "+n+"\n")}))}}))}},t.CobolLinterProvider=class{constructor(e,t){this.collection=e,this.settings=t,this.linterSev=t.linter_mark_as_information?c.DiagnosticSeverity.Information:c.DiagnosticSeverity.Hint}updateLinter(e){return s(this,void 0,void 0,(function*(){if(!1===this.settings.linter&&!1===this.settings.scan_comments_for_hints)return void this.collection.clear();if(l.isSupportedLanguage(e)!==l.TextLanguage.COBOL)return;if(!1===this.setupCOBOLScannner(e))return;if(void 0===this.sourceRefs||void 0===this.current)return;const t=this.current,n=new Map;if(this.collection.clear(),t.sourceIsCopybook||(this.linterSev=this.settings.linter_mark_as_information?c.DiagnosticSeverity.Information:c.DiagnosticSeverity.Hint,t.configHandler.linter_unused_paragraphs_or_sections&&this.processParsedDocumentForUnusedSymbols(t,n),t.configHandler.linter_house_standards_rules&&this.processParsedDocumentForStandards(t,n)),0!==t.diagWarnings.size)for(const[e,o]of t.diagWarnings)if(void 0!==o.filename&&void 0!==o.lnum){const t=new c.Range(new c.Position(o.lnum,0),new c.Position(o.lnum,0)),i=new c.Diagnostic(t,e,c.DiagnosticSeverity.Information);if(n.has(o.filename)){const e=n.get(o.filename);void 0!==e&&e.push(i)}else{const e=[];e.push(i),n.set(o.filename,e)}}for(const[e,t]of n){const n=c.Uri.file(e);this.collection.set(n,t)}}))}processParsedDocumentForStandards(e,t){if(void 0===this.sourceRefs)return;const n=e.configHandler.linter_house_standards_rules,o=new Map,i=new Map;for(const e of n){const t=e.split("=",2);o.set(t[0].toLowerCase(),t[1])}for(const[n,r]of e.constantsOrVariables)for(const e of r){if("filler"===e.tokenNameLower)continue;const r=o.get(e.inSection.tokenNameLower);if(void 0!==r){let o=i.get(e.inSection.tokenNameLower);if(void 0===o){if(o=h(r),void 0===o)continue;i.set(e.inSection.tokenNameLower,o)}if(!1===o.test(e.tokenName)){const o=new c.Range(new c.Position(e.startLine,e.startColumn),new c.Position(e.startLine,e.startColumn+e.tokenName.length)),i=new c.Diagnostic(o,n+" breaks house standards rule for "+e.inSection.tokenNameLower+" section",this.linterSev);if(i.tags=[c.DiagnosticTag.Unnecessary],t.has(e.filename)){const n=t.get(e.filename);void 0!==n&&n.push(i)}else{const n=[];n.push(i),t.set(e.filename,n)}}}}}processParsedDocumentForUnusedSymbols(e,t){if(void 0===this.sourceRefs)return;const n=this.sourceRefs;for(const[o,i]of e.paragraphs){const e=o.toLowerCase();if(!n.ignoreUnusedSymbol.has(e)&&!1===n.targetReferences.has(e)){const e=new c.Range(new c.Position(i.startLine,i.startColumn),new c.Position(i.startLine,i.startColumn+i.tokenName.length)),n=new c.Diagnostic(e,o+" paragraph is not referenced",this.linterSev);if(n.tags=[c.DiagnosticTag.Unnecessary],n.code=d.CobolLinterProviderSymbols.NotReferencedMarker_internal+" "+o,t.has(i.filename)){const e=t.get(i.filename);void 0!==e&&e.push(n)}else{const e=[];e.push(n),t.set(i.filename,e)}}}for(const[o,i]of e.sections){const r=o.toLowerCase();if(!n.ignoreUnusedSymbol.has(r)&&i.inProcedureDivision&&!1===n.targetReferences.has(r)){let n=!1;if(this.settings.linter_ignore_section_before_entry){const t=e.sourceHandler.getLine(1+i.startLine,!1);-1!==(null==t?void 0:t.toLowerCase().indexOf("entry"))&&(n=!0)}if(!n){const e=new c.Range(new c.Position(i.startLine,i.startColumn),new c.Position(i.startLine,i.startColumn+i.tokenName.length)),n=new c.Diagnostic(e,o+" section is not referenced",this.linterSev);if(n.code=d.CobolLinterProviderSymbols.NotReferencedMarker_internal+" "+o,n.tags=[c.DiagnosticTag.Unnecessary],t.has(i.filename)){const e=t.get(i.filename);void 0!==e&&e.push(n)}else{const e=[];e.push(n),t.set(i.filename,e)}}}}}setupCOBOLScannner(e){var t;return void 0!==this.current&&this.current.filename!==e.fileName&&(this.current=void 0),(void 0===this.current||this.currentVersion!==e.version)&&(this.current=u.default.getCachedObject(e,this.settings),this.sourceRefs=null===(t=this.current)||void 0===t?void 0:t.sourceReferences,this.currentVersion=e.version,!0)}}},9898:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.move2anybackwards=t.move2anyforward=t.move2ws=t.move2dd=t.move2pd=void 0;const o=n(7549);function i(e){if(o.window.activeTextEditor){const t=o.window.activeTextEditor.document;for(let n=0;n<=t.lineCount;n++){const i=new o.Range(n,0,n,132);if(t.getText(i).match(e))return n}}return 0}function r(e){return function(e,t){if(o.window.activeTextEditor){const n=o.window.activeTextEditor.document,i=o.window.activeTextEditor,r=1===t?n.lineCount:0;let s=i.selection.active.line+t;for(;s!==r;s+=t){const t=new o.Range(s,0,s,132),i=n.getText(t),r=e.length;for(let t=0;t<r;t++){const n=e[t];if(i.match(n))return s}}}return 0}([/.*\s*division/i,/entry\s*"/i,/.*\s*section\./i,/eject/i,/program-id\./i,/class-id[.|\s]/i,/method-id[.|\s]/i],e)}function s(){return i(/working-storage\s*section/i)}function a(e){if(o.window.activeTextEditor){let t=o.TextEditorRevealType.InCenter;e===o.window.activeTextEditor.selection.active.line&&(t=o.TextEditorRevealType.InCenterIfOutsideViewport);const n=new o.Selection(e,0,e,0);o.window.activeTextEditor.selection=n,o.window.activeTextEditor.revealRange(n,t)}}t.move2pd=function(){const e=i(/procedure\s*division/i);e>0?a(e):o.window.setStatusBarMessage("ERROR: 'PROCEDURE DIVISION' not found.",4e3)},t.move2dd=function(){let e=i(/data\s*division/i);e>0?a(e):(e=s(),e>0?a(e):o.window.setStatusBarMessage("ERROR: 'DATA DIVISION' or 'WORKING-STORAGE SECTION' not found.",4e3))},t.move2ws=function(){const e=s();e>0?a(e):o.window.setStatusBarMessage("ERROR: 'WORKING-STORAGE SECTION' not found.",4e3)},t.move2anyforward=function(){const e=r(1);e>0&&a(e)},t.move2anybackwards=function(){const e=r(-1);e>0&&a(e)}},8040:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CobolSourceCompletionItemProvider=void 0;const i=n(7549),r=o(n(6560)),s=n(8202),a=n(7892),c=o(n(7337)),l=n(112),u=n(5363);t.CobolSourceCompletionItemProvider=class{constructor(e){this.iconfig=e}getPerformTargets(e){const t=r.default.getCachedObject(e,this.iconfig);if(void 0!==t){if(void 0===t.cpPerformTargets){t.cpPerformTargets=new c.default("tokenName");const e=t.cpPerformTargets;for(const[n,o]of t.sections)o.inProcedureDivision&&e.add(o);for(const[n,o]of t.paragraphs)o.inProcedureDivision&&e.add(o);return e}return t.cpPerformTargets}return new c.default("tokenName")}getConstantsOrVariables(e,t){const n=r.default.getCachedObject(e,t);if(void 0!==n){if(void 0===n.cpConstantsOrVars){n.cpPerformTargets=new c.default("tokenName");const e=n.cpPerformTargets;for(const t of n.constantsOrVariables.keys()){const o=n.constantsOrVariables.get(t);if(void 0!==o)for(const t of o)"filler"!==t.tokenNameLower&&e.add(t)}return e}return n.cpConstantsOrVars}return new c.default("tokenName")}getItemsFromList(e,t,n){const o=a.VSCOBOLConfiguration.get(),r=o.intellisense_include_uppercase,c=o.intellisense_include_lowercase,l=o.intellisense_include_unchanged,u=o.intellisense_include_camelcase,d=o.intellisense_item_limit,h=e.get(t),p=h.length,f=new Map,m=[];for(let e=0;e<p;e++){const t=h[e],o=[];if(f.has(t.tokenNameLower))continue;f.set(t.tokenNameLower,t.tokenNameLower),l&&o.push(t.tokenName),c&&t.tokenName!==t.tokenNameLower&&o.push(t.tokenNameLower),r&&t.tokenName!==t.tokenName.toUpperCase()&&o.push(t.tokenName.toUpperCase()),u&&o.push(s.camelize(t.tokenName));const a=o.filter((function(e,t,n){return t===n.indexOf(e)}));for(const e of a)m.push(new i.CompletionItem(e,n));if(m.length>=d)return m}return m}getAllCopyBook(e){const t=[],n=new Map;for(const[e]of u.InMemoryGlobalSymbolCache.knownCopybooks){const t=e.split(",")[0];!1===n.has(t)&&n.set(t,t)}for(const[o]of n)t.push(new i.CompletionItem(o,i.CompletionItemKind.File)),e&&(t.push(new i.CompletionItem(`"${o}"`,i.CompletionItemKind.File)),t.push(new i.CompletionItem(`'${o}'`,i.CompletionItemKind.File)));return t}getAllTypes(e){const t=0!=e.length,n=[],o=new Map;for(const[r]of u.InMemoryGlobalSymbolCache.types)!1!==o.has(r)&&(t?r.startsWith(e)&&n.push(new i.CompletionItem(r,i.CompletionItemKind.Class)):n.push(new i.CompletionItem(r,i.CompletionItemKind.Class)));for(const[r]of u.InMemoryGlobalSymbolCache.interfaces)!1!==o.has(r)&&(t?r.startsWith(e)&&n.push(new i.CompletionItem(r,i.CompletionItemKind.Interface)):n.push(new i.CompletionItem(r,i.CompletionItemKind.Interface)));for(const[r]of u.InMemoryGlobalSymbolCache.enums)!1!==o.has(r)&&(t?r.startsWith(e)&&n.push(new i.CompletionItem(r,i.CompletionItemKind.Enum)):n.push(new i.CompletionItem(r,i.CompletionItemKind.Enum)));return n}provideCompletionItems(e,t,n,o){let r=[];if(!1===this.iconfig.enable_data_provider)return r;const s=l.performance_now();let a="",c="",u="";const d=e.lineAt(t.line).text.trim(),h=e.getWordRangeAtPosition(t);if(h){a=e.getText(new i.Range(h.start,t)),c=e.getText(new i.Range(new i.Position(h.start.line,0),new i.Position(t.line,t.character-a.length))).trimEnd();const n=c.lastIndexOf(" ");if(-1!==n){const e=c;c=c.substr(1+n),u=c.toLowerCase(),"to"===u&&-1!==e.toLowerCase().indexOf("go")&&(c=u="goto")}}else{const e=d.lastIndexOf(" ");c=-1===e?d:d.substr(1+e),u=c.toLowerCase()}if(0!==c.length)if(u.startsWith("'")&&u.endsWith("'")||u.startsWith('"')&&u.endsWith('"'))-1!==d.toLowerCase().indexOf("call")&&(r=this.getCallTargets()),-1!==d.toLowerCase().indexOf("cancel")&&(r=this.getCallTargets()),-1!==d.toLowerCase().indexOf("copy")&&(r=this.getAllCopyBook(!1));else switch(u){case"copy":r=this.getAllCopyBook(!0);break;case"type":r=this.getAllTypes(a);break;case"thru":case"through":case"perform":case"goto":{const t=this.getPerformTargets(e);r=this.getItemsFromList(t,a,i.CompletionItemKind.Method);break}case"move":{const t=this.getConstantsOrVariables(e,this.iconfig);r=this.getItemsFromList(t,a,i.CompletionItemKind.Variable);break}case"add":case"ascending":case"compute":case"corr":case"corresponding":case"descending":case"divide":case"from":case"giving":case"if":case"initialize":case"inspect":case"into":case"key":case"multiply":case"named":case"pointer":case"search":case"set":case"string":case"subtract":case"to":case"unstring":case"varying":case"with":case"display":case"value":case"values":{const t=this.getConstantsOrVariables(e,this.iconfig);r=this.getItemsFromList(t,a,i.CompletionItemKind.Variable);break}}const p=l.performance_now()-s,f=p.toFixed(2);return p>l.logTimeThreshold&&l.logMessage(" - CobolSourceCompletionItemProvider took "+f+" ms"),r}getCallTargets(){const e=[];for(const[t]of u.InMemoryGlobalSymbolCache.callableSymbols.entries())e.push(new i.CompletionItem(`${t}`,i.CompletionItemKind.Function));for(const[t]of u.InMemoryGlobalSymbolCache.entryPoints.entries())e.push(new i.CompletionItem(`${t}`,i.CompletionItemKind.Function));return e}}},7982:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CobolReferenceProvider=void 0;const a=r(n(7549)),c=n(7892),l=s(n(6560)),u=new RegExp("[#0-9a-zA-Z][a-zA-Z0-9-_]*");t.CobolReferenceProvider=class{provideReferences(e,t,n,o){return this.currentVersion=0,this.processSearch(e,t)}processSearch(e,t){const n=[],o=e.getWordRangeAtPosition(t,u),i=o?e.getText(o):"";if(""===i)return Promise.resolve(null);const r=i.toLowerCase(),s=c.VSCOBOLConfiguration.get();if(void 0!==this.current&&this.currentVersion===e.version||(this.current=l.default.getCachedObject(e,s),void 0!==this.current&&(this.sourceRefs=this.current.sourceReferences,this.currentVersion=e.version)),void 0===this.current||void 0===this.sourceRefs)return Promise.resolve(null);const d=this.current,h=this.sourceRefs;if(d.paragraphs.has(r)||d.sections.has(r)){const e=d.paragraphs.get(r);if(void 0!==e){const t=a.Uri.file(e.filename);n.push(new a.Location(t,new a.Position(e.startLine,e.startColumn)))}const t=d.sections.get(r);if(void 0!==t){const e=a.Uri.file(t.filename);n.push(new a.Location(e,new a.Position(t.startLine,t.startColumn)))}}if(d.constantsOrVariables.has(r)){const e=d.constantsOrVariables.get(r);if(void 0!==e)for(let t=0;t<e.length;t++){const o=e[t],i=a.Uri.file(o.filename);n.push(new a.Location(i,new a.Position(o.startLine,o.startColumn)))}}if(!0===h.targetReferences.has(r)){const e=h.targetReferences.get(r);if(void 0!==e)for(let t=0;t<e.length;t++){const o=e[t],i=a.Uri.file(h.filenames[o.fileIdentifer]);n.push(new a.Location(i,new a.Position(o.line,o.column)))}}if(!0===h.constantsOrVariablesReferences.has(r)){const e=h.constantsOrVariablesReferences.get(r);if(void 0!==e)for(let t=0;t<e.length;t++){const o=e[t],i=a.Uri.file(h.filenames[o.fileIdentifer]);n.push(new a.Location(i,new a.Position(o.line,o.column)))}}return n.length>0?Promise.resolve(n):Promise.resolve(null)}}},8202:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyCOBOLSourceScannerEventHandler=t.CallTargetInformation=t.COBOLParameter=t.UsingState=t.SharedSourceReferences=t.COBOLCopybookToken=t.copybookState=t.replaceState=t.replaceToken=t.SourceReference=t.COBOLToken=t.splitArgument=t.camelize=t.CobolTagStyle=t.CobolDocStyle=t.COBOLTokenStyle=t.COBOLPreprocessorHelper=t.COBOLPreprocResult=void 0;const s=n(7530),a=n(924),c=n(4669),l=r(n(5747)),u=r(n(5622)),d=n(842),h=n(3911);class p{constructor(e,t,n,o,i){this.ppHandle=e,this.atLine=t,this.originalLine=n,this.replacedLines=o,this.copybooks=i}}t.COBOLPreprocResult=p;class f{static isActive(){return 0!==this.preprocessors.size}static actionStartSection(e,t){for(const[n,o]of f.preprocessors)try{o.startSection(e,t)}catch(e){}}static actionStartDivision(e,t){for(const[n,o]of f.preprocessors)try{o.startDivision(e,t)}catch(e){}}static actionStart(e,t){for(const[n,o]of f.preprocessors)try{o.start(e,n,t)}catch(e){}}static actionProcess(e,t,n,o,i){for(const[i,r]of f.preprocessors)try{const s=new h.CobApiOutput;if(r.process(e,t,s)){for(const e of s.lines)n.push(e);for(const[e,t]of s.externalFiles)o.set(e,t);return i}}catch(e){n.length=0,o.clear()}}static actionEnd(e){for(const[t,n]of f.preprocessors)try{n.end(e)}catch(e){}}}var m,g,C,_;function b(e,t,n){let o=!1,i=!1;const r=e.length;let s="";for(let a=0;a<r;a++){let r=e.charAt(a);if("'"!==r||o)if('"'!==r||i)if(o||i)s+=r;else if(" "!==r&&"\t"!==r)!t||"("!==r&&")"!==r?s+=r:(n.push(s),s=""+r,n.push(s),s="");else{for(0!==s.length&&(n.push(s),s="");" "===r||"\t"===r;)a++,r=s.charAt(a);a--}else o=!o,s+=r,!1===o&&(n.push(s),s="");else i=!i,s+=r,!1===i&&(n.push(s),s="")}0!==s.length&&n.push(s)}t.COBOLPreprocessorHelper=f,f.preprocessors=new Map,f.preprocessorsExts=new Map,function(e){e.CopyBook="Copybook",e.CopyBookInOrOf="CopybookInOrOf",e.File="File",e.ProgramId="Program-Id",e.ImplicitProgramId="ImplicitProgramId-Id",e.FunctionId="Function-Id",e.EndFunctionId="EndFunctionId",e.Constructor="Constructor",e.MethodId="Method-Id",e.Property="Property",e.ClassId="Class-Id",e.InterfaceId="Interface-Id",e.ValueTypeId="Valuetype-Id",e.EnumId="Enum-id",e.Section="Section",e.Paragraph="Paragraph",e.Division="Division",e.EntryPoint="Entry",e.Variable="Variable",e.ConditionName="ConditionName",e.Constant="Constant",e.Union="Union",e.EndDelimiter="EndDelimiter",e.Exec="Exec",e.EndExec="EndExec",e.Declaratives="Declaratives",e.EndDeclaratives="EndDeclaratives",e.DeclarativesSection="DeclarativesSection",e.Unknown="Unknown",e.Null="Null"}(m=t.COBOLTokenStyle||(t.COBOLTokenStyle={})),(_=t.CobolDocStyle||(t.CobolDocStyle={})).unknown="unknown",_.MSDN="MSDN",_.COBOLDOC="COBOLDOC",_.ISCOBOL="ISCOBOL",_.FUJITSU="FUJITSU",_.OCDOC="OCDOC",(C=t.CobolTagStyle||(t.CobolTagStyle={})).unknown="unknown",C.FREE="FREE",C.MICROFOCUS="MICROFOCUS",C.OCDOC="OCDOC",t.camelize=function(e){let t="",n=!0;for(let o=0;o<e.length;o++){const i=e[o];n?(t+=i.toUpperCase(),n=!1):("-"!==i&&"_"!==i||(n=!0),t+=i.toLowerCase())}return t},t.splitArgument=b;class y{constructor(e,t,n,o,i,r,s,a,c){this.ignoreInOutlineView=!1,this.filename=e,this.tokenType=t,this.startLine=n,this.tokenName=i.trim(),this.tokenNameLower=this.tokenName.toLowerCase(),this.startColumn=o,this.description=r,this.endLine=this.startLine,this.endColumn=this.startColumn+this.tokenName.length,this.parentToken=s,this.inProcedureDivision=a,this.extraInformation=c,this.inSection=y.Null,0!==this.tokenName.length&&this.startColumn<0&&(this.startColumn=0)}getEndDelimiterToken(){return new y(this.filename,m.EndDelimiter,this.startLine,0,this.tokenName,this.description,this.parentToken,this.inProcedureDivision,"")}}t.COBOLToken=y,y.Null=new y("",m.Null,-1,0,"","",void 0,!1,"");class v{constructor(e,t,n,o,i){this.fileIdentifer=e,this.line=t,this.column=n,this.length=o,this.tokenStyle=i}}t.SourceReference=v;class O{constructor(e,t,n,o){this.currentToken=e,this.currentTokenLower=t,this.endsWithDot=n,this.currentCol=o}}O.Blank=new O("","",!1,0);class w{constructor(e,t){this.tokenIndex=0,this.currentToken="",this.prevToken="",this.prevTokenToken=void 0,this.currentTokenLower="",this.prevTokenLower="",this.currentCol=0,this.endsWithDot=!1,this.stokens=[];const n=[];this.prevTokenToken=t,void 0!==t&&(this.prevToken=t.currentToken),b(e,!1,n);let o=0;for(let t=0;t<n.length;t++){const i=n[t],r=i.toLowerCase();o=e.indexOf(i,o);const s=0!==i.length&&"."===i.charAt(i.length-1);this.stokens.push(new O(i,r,s,o))}if(this.tokenIndex=0,this.setupNextToken(),void 0!==t&&t.stokens.length>0){const e=t.stokens.length-1;this.prevToken=t.stokens[e].currentToken,this.prevTokenLower=t.stokens[e].currentTokenLower}}nextSTokenOrBlank(){return 1+this.tokenIndex>=this.stokens.length?O.Blank:this.stokens[1+this.tokenIndex]}nextSTokenPlusOneOrBlank(){return 2+this.tokenIndex>=this.stokens.length?O.Blank:this.stokens[2+this.tokenIndex]}compoundItems(e,t){if(this.endsWithDot)return e;if(1+this.tokenIndex>=this.stokens.length)return e;let n=e,o=!1;for(let e=1+this.tokenIndex;e<this.stokens.length;e++){const i=this.stokens[e],r=t.trimLiteral(i.currentToken);if(i.endsWithDot)return n+" "+r;if(o)n+=" "+r,o=!1;else{if("&"!==i.currentToken)return n;n+=" "+r,o=!0}}return n}setupNextToken(){this.prevToken=this.currentToken,this.prevTokenLower=this.currentTokenLower;const e=this.stokens[this.tokenIndex];void 0!==e?(this.currentToken=e.currentToken,this.currentTokenLower=e.currentTokenLower,this.endsWithDot=e.endsWithDot,this.currentCol=e.currentCol):(this.currentToken=this.currentTokenLower="",this.endsWithDot=!1,this.currentCol=0)}moveToNextToken(){return 1+this.tokenIndex>this.stokens.length||(this.tokenIndex++,this.setupNextToken(),!1)}isTokenPresent(e){const t=e.toLowerCase(),n=t+".";for(let e=0;e<this.stokens.length;e++){if(this.stokens[e].currentTokenLower===t)return!0;if(this.stokens[e].currentTokenLower===n)return!0}return!1}}w.Blank=new w("",void 0);class S{constructor(e,t){this.replaceToken=this.escapeRegExp(e),t.isPseudoTextDelimiter?this.rex4wordreplace=new RegExp(`${this.replaceToken}`,"g"):this.rex4wordreplace=new RegExp(`\\b${this.replaceToken}\\b`,"g")}escapeRegExp(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}}t.replaceToken=S;class k{constructor(){this.isPseudoTextDelimiter=!1}}t.replaceState=k;class L{constructor(){this.sourceHandler=void 0,this.copyBook="",this.trimmedCopyBook="",this.isIn=!1,this.isOf=!1,this.isReplacing=!1,this.isReplacingBy=!1,this.startLineNumber=0,this.endLineNumber=0,this.endCol=0,this.startCol=0,this.line="",this.copyVerb="",this.literal2="",this.library_name="",this.replaceLeft="",this.copyReplaceMap=new Map,this.isTrailing=!1,this.isLeading=!1,this.fileName="",this.isPseudoTextDelimiter=!1}}t.copybookState=L;class T{constructor(e,t,n){this.token=e,this.parsed=t,this.statementInformation=n}}t.COBOLCopybookToken=T,T.Null=new T(y.Null,!0,new L);class E{constructor(e,t){this.filenames=[],this.targetReferences=new Map,this.constantsOrVariablesReferences=new Map,this.unknownReferences=new Map,this.sharedConstantsOrVariables=new Map,this.sharedSections=new Map,this.sharedParagraphs=new Map,this.copyBooksUsed=new Map,this.state=new B(e),this.tokensInOrder=[],this.topLevel=t,this.ignoreUnusedSymbol=new Map}}t.SharedSourceReferences=E,function(e){e[e.BY_VALUE=0]="BY_VALUE",e[e.BY_REF=1]="BY_REF",e[e.BY_CONTENT=2]="BY_CONTENT",e[e.RETURNING=3]="RETURNING"}(g=t.UsingState||(t.UsingState={}));class I{constructor(e,t){this.using=e,this.name=t}}t.COBOLParameter=I;class B{constructor(e){this.currentDivision=y.Null,this.procedureDivision=y.Null,this.currentSection=y.Null,this.currentParagraph=y.Null,this.currentToken=y.Null,this.currentClass=y.Null,this.currentMethod=y.Null,this.currentRegion=y.Null,this.declaratives=y.Null,this.current01Group=y.Null,this.currentLevel=y.Null,this.currentFunctionId=y.Null,this.currentProgramTarget=new x(y.Null,!1,[]),this.programs=[],this.captureDivisions=!0,this.copyBooksUsed=new Map,this.pickFields=!1,this.inProcedureDivision=!1,this.inDeclaratives=!1,this.ignoreInOutlineView=!1,this.skipToDot=!1,this.addReferencesDuringSkipToTag=!1,this.addVariableDuringStipToTag=!1,this.pickUpUsing=!1,this.using=g.BY_REF,this.parameters=[],this.entryPointCount=0,this.endsWithDot=!1,this.prevEndsWithDot=!1,this.currentLineIsComment=!1,this.inReplace=!1,this.replace_state=new k,this.inCopy=!1,this.captureReplaceLeft=!0,this.replaceLeft="",this.replaceRight="",this.replaceMap=new Map,this.enable_text_replacement=e.enable_text_replacement,this.copybook_state=new L,this.inCopyStartColumn=0}}class P{constructor(){this.numberTokensInHeader=0,this.workingStorageRelatedTokens=0,this.procedureDivisionRelatedTokens=0,this.sectionsInToken=0,this.divisionsInToken=0,this.leaveEarly=!1}}class x{constructor(e,t,n){this.Token=e,this.IsEntryPoint=t,this.CallParameters=n}}t.CallTargetInformation=x;class D{start(e){}processToken(e){}finish(){}}t.EmptyCOBOLSourceScannerEventHandler=D,D.Default=new D;class R{constructor(e,t,n,o=new E(t,!0),i,r,s){this.lastModifiedTime=BigInt(0),this.tokensInOrder=[],this.cpPerformTargets=void 0,this.cpConstantsOrVars=void 0,this.ImplicitProgramId="",this.sourceFormat=d.ESourceFormat.unknown,this.sourceIsCopybook=!1,this.parseHint_OnOpenFiles=[],this.parseHint_WorkingStorageFiles=[],this.parseHint_LocalStorageFiles=[],this.parseHint_ScreenSectionFiles=[],this.isPreProcessorsActive=!1,this.ppResults=[],this.cobolLintLiteral="cobol-lint";const a=e.getFilename();this.sourceHandler=e,this.id=e.getUriAsString(),this.configHandler=t,this.deprecatedCacheDirectory=n,this.filename=u.normalize(a),this.ImplicitProgramId=u.basename(a,u.extname(a)),this.parse_copybooks_for_references=i,this.eventHandler=r,this.externalFeatures=s,this.copybookNestedInSection=t.copybooks_nested,this.copyBooksUsed=new Map,this.isCached=!1,this.sections=new Map,this.paragraphs=new Map,this.constantsOrVariables=new Map,this.callTargets=new Map,this.functionTargets=new Map,this.classes=new Map,this.methods=new Map,this.diagWarnings=new Map,this.parse4References=null!==e,this.cpPerformTargets=void 0,this.cpConstantsOrVars=void 0;let h=!1,g=w.Blank;const C=u.extname(a).length>0;this.sourceReferences=o,this.sourceFileId=0,this.sourceFileId=o.filenames.length,o.filenames.push(e.getFilename()),this.constantsOrVariables=o.sharedConstantsOrVariables,this.paragraphs=o.sharedParagraphs,this.sections=o.sharedSections,this.tokensInOrder=o.tokensInOrder,this.copyBooksUsed=o.copyBooksUsed,e.setCommentCallback(this);const _=this.sourceReferences.state;if(_.copyBooksUsed.set(this.filename,y.Null),this.sourceReferences.topLevel)try{const e=l.statSync(this.filename,{bigint:!0});this.lastModifiedTime=e.mtimeMs}catch(e){}if(this.workspaceFile=new c.COBOLWorkspaceFile(this.lastModifiedTime,e.getShortWorkspaceFilename()),null!==n&&n.length>0?this.parse_copybooks_for_references&&!this.sourceReferences.topLevel?(this.externalFeatures.logMessage(` Skipping ${a} as it is not a top level reference`),this.eventHandler=D.Default):(this.eventHandler=r,this.eventHandler.start(this)):this.sourceReferences.topLevel&&(this.eventHandler=r,this.eventHandler.start(this)),this.sourceReferences.topLevel){const n=t.pre_parse_line_limit,o=e.getLineCount();let i,r=o;r>n&&(r=n);const s=new P;for(let t=0;t<r+e.getCommentCount()&&!(t>o);t++)try{if(i=e.getLine(t,!1),void 0===i)break;if(i=i.trimRight(),i.length>0?g=!1===g.endsWithDot?this.relaxedParseLineByLine(g,i,s):this.relaxedParseLineByLine(w.Blank,i,s):r++,s.leaveEarly)break}catch(e){this.externalFeatures.logException("COBOLScannner - Parse error : "+e,e)}let c=!1;if(0===s.sectionsInToken&&0===s.divisionsInToken)if(0!==s.procedureDivisionRelatedTokens&&s.procedureDivisionRelatedTokens>s.workingStorageRelatedTokens){this.ImplicitProgramId="";const e=this.newCOBOLToken(m.Division,0,"Procedure Division",0,"Procedure","Procedure Division (CopyBook)",_.currentDivision);_.currentDivision=e,_.procedureDivision=e,_.pickFields=!1,_.inProcedureDivision=!0,h=!0,e.ignoreInOutlineView=!0,this.sourceIsCopybook=!0}else if(0!==s.workingStorageRelatedTokens&&0!==s.numberTokensInHeader){const e=this.newCOBOLToken(m.Division,0,"Data Division",0,"Data","Data Division (CopyBook)",_.currentDivision);_.currentDivision=e,_.pickFields=!0,_.inProcedureDivision=!1,h=!0,this.ImplicitProgramId="",e.ignoreInOutlineView=!0,this.sourceIsCopybook=!0}else c=!0;if((0!==s.divisionsInToken||s.leaveEarly)&&(h=!0),!h&&e.getCommentCount()>0&&(h=!0,c=!0),c&&(this.parse_copybooks_for_references||t.cache_metadata===d.CacheDirectoryStrategy.Off||this.externalFeatures.logMessage(` Warning - Unable to determine context of ${a}, this may affect metadata caching for this file`)),!1===h&&(e.getLineCount()>r?this.externalFeatures.logMessage(` Warning - Unable to determine if ${a} is COBOL after scanning ${r} lines (configurable via coboleditor.pre_parse_line_limit setting)`):this.externalFeatures.logMessage(` Unable to determine if ${a} is COBOL and how it is used`)),C&&(h=!0),!h)return}else h=!0;switch(e.resetCommentCount(),this.sourceFormat=this.externalFeatures.getCOBOLSourceFormat(e,t),this.sourceFormat){case d.ESourceFormat.free:case d.ESourceFormat.variable:e.setDumpAreaBOnwards(!1);break;case d.ESourceFormat.fixed:e.setDumpAreaA(!0),e.setDumpAreaBOnwards(!0)}g=w.Blank,e.resetCommentCount(),this.isPreProcessorsActive=f.isActive(),this.isPreProcessorsActive&&f.actionStart(this.id,this);for(let n=0;n<e.getLineCount();n++)try{_.currentLineIsComment=!1;const o=e.getLine(n,!1);if(void 0===o)break;if(0===o.length&&_.currentLineIsComment)continue;const i=o.trimRight();if(i.length>0){const e=[],o=new Map;let r;if(this.isPreProcessorsActive)try{r=f.actionProcess(this.id,i,e,o,this),void 0===r&&(e.length=0,o.clear())}catch(e){s.logException("pp",e)}if(0!==e.length&&void 0!==r){this.ppResults.push(new p(r,n,i,e,o));const s=_.ignoreInOutlineView,a=this.parse_copybooks_for_references,c=t.enable_text_replacement;this.parse_copybooks_for_references=!1,_.ignoreInOutlineView=!0,_.enable_text_replacement=!1;try{for(const t of e)if(null!=t&&0!==t.trimLeft().length){const e=!1===g.endsWithDot?g:w.Blank;g=this.parseLineByLine(n,e,t)}_.ignoreInOutlineView=s;for(const[e,t]of o)this.newCOBOLToken(m.File,n,i,0,t,e,_.currentDivision)}finally{_.ignoreInOutlineView=s,_.enable_text_replacement=c,this.parse_copybooks_for_references=a}}else{const e=!1===g.endsWithDot?g:w.Blank;g=this.parseLineByLine(n,e,i)}}}catch(e){this.externalFeatures.logException("COBOLScannner - Parse error",e)}if(this.sourceReferences.topLevel){const t=e.getLineCount(),n=e.getLine(t,!0),o=void 0===n?0:n.length;if(0!==_.programs.length)for(let t=0;t<_.programs.length;t++){const t=_.programs.pop();void 0!==t&&(t.endLine=e.getLineCount(),t.endColumn=o)}if(_.currentDivision!==y.Null&&(_.currentDivision.endLine=e.getLineCount(),_.currentDivision.endColumn=o),_.currentSection!==y.Null&&(_.currentSection.endLine=e.getLineCount(),_.currentSection.endColumn=o),_.currentParagraph!==y.Null&&(_.currentParagraph.endLine=e.getLineCount(),_.currentParagraph.endColumn=o),0!==this.ImplicitProgramId.length){const t=this.newCOBOLToken(m.ImplicitProgramId,0,"",0,this.ImplicitProgramId,this.ImplicitProgramId,y.Null);t.endLine=e.getLineCount(),t.startLine=0,t.endColumn=o,t.ignoreInOutlineView=!0,_.currentProgramTarget.Token=t,this.tokensInOrder.pop(),this.callTargets.set(this.ImplicitProgramId,_.currentProgramTarget)}const i=[];let r=0,s=0,a=0;for(const[e,t]of this.sourceReferences.unknownReferences){const n=this.constantsOrVariables.get(e);if(void 0!==n){let o=m.Variable,i=!0;for(const e of n)e.ignoreInOutlineView?i=!1:o=e.tokenType===m.Unknown?o:e.tokenType;i&&this.transferReference(e,t,this.sourceReferences.constantsOrVariablesReferences,o),s++}else this.isVisibleSection(e)?(this.transferReference(e,t,this.sourceReferences.targetReferences,m.Section),r++):this.isVisibleParagraph(e)?(this.transferReference(e,t,this.sourceReferences.targetReferences,m.Paragraph),a++):i.push(e)}this.sourceReferences.unknownReferences.clear(),this.eventHandler.finish()}this.isPreProcessorsActive&&f.actionEnd(this.id)}static ParseUncached(e,t,n,o,i){return new R(e,t,"",new E(t,!0),n,o,i)}static ParseCached(e,t,n,o,i,r){return new R(e,t,n,new E(t,!0),o,i,r)}static ParseUncachedInlineCopybook(e,t,n,o,i){const r=t.configHandler,s=t.sourceReferences;return new R(e,r,"",s,n,o,i)}isVisibleSection(e){const t=this.sections.get(e);return void 0!==t&&!t.ignoreInOutlineView}isVisibleParagraph(e){const t=this.paragraphs.get(e);return void 0!==t&&!t.ignoreInOutlineView}transferReference(e,t,n,o){const i=n.get(e);if(void 0!==i)for(const e of t)e.tokenStyle=o,i.push(e);else{for(const e of t)e.tokenStyle=o;n.set(e,t)}}getCurrentDivision(){return this.sourceReferences.state.currentDivision.tokenName}getCurrentSection(){return this.sourceReferences.state.currentSection.tokenName}getCopyFilename(e,t){const n=e.trim();return this.externalFeatures.expandLogicalCopyBookToFilenameOrEmpty(n,t,this.configHandler)}newCOBOLToken(e,t,n,o,i,r,s,a=""){const c=this.sourceReferences.state;let l=n.indexOf(i,o);-1===l&&(l=n.indexOf(i),-1===l&&(l=0));const u=new y(this.filename,e,t,l,i,r,s,c.inProcedureDivision,a);return u.ignoreInOutlineView=c.ignoreInOutlineView,u.inSection=this.sourceReferences.state.currentSection,u.ignoreInOutlineView||e==m.ImplicitProgramId?(this.tokensInOrder.push(u),this.eventHandler.processToken(u),u):(c.currentParagraph!==y.Null&&(c.currentParagraph.endLine=t,0!==u.startColumn&&(c.currentParagraph.endColumn=u.startColumn-1)),e===m.Division?(c.currentParagraph=y.Null,c.currentDivision.endLine=t,0!==u.startColumn&&(c.currentDivision.endColumn=u.startColumn-1),c.currentSection!==y.Null&&(c.currentSection.endLine=t,0!==u.startColumn&&(c.currentSection.endColumn=u.startColumn-1),c.currentSection=y.Null),this.tokensInOrder.push(u),this.eventHandler.processToken(u),this.isPreProcessorsActive&&f.actionStartDivision(this.filename,u.tokenName),u):e===m.Section?(c.currentSection!==y.Null&&(c.currentParagraph=y.Null,c.currentSection.endLine=t,0!==u.startColumn&&(c.currentSection.endColumn=u.startColumn-1)),c.inProcedureDivision&&this.eventHandler.processToken(u),this.tokensInOrder.push(u),this.isPreProcessorsActive&&f.actionStartSection(this.filename,u.tokenName),u):e===m.Paragraph?(c.currentSection!==y.Null&&(c.currentSection.endLine=t,0!==u.startColumn&&(c.currentSection.endColumn=u.startColumn-1)),c.currentParagraph=u,c.currentDivision!==y.Null&&(c.currentDivision.endLine=t,0!==u.startColumn&&(c.currentDivision.endColumn=u.startColumn-1)),this.tokensInOrder.push(u),this.eventHandler.processToken(u),u):(this.tokensInOrder.push(u),this.eventHandler.processToken(u),u))}isValidLiteral(e){return null!==e&&0!==e.length&&!!e.match(R.literalRegex)}isParagraph(e){return null!==e&&0!==e.length&&null!==e.match(R.paragraphRegex)&&!0!==this.constantsOrVariables.has(e.toLowerCase())}isValidKeyword(e){return s.cobolKeywordDictionary.has(e)}isValidProcedureKeyword(e){return s.cobolProcedureKeywordDictionary.has(e)}isValidStorageKeyword(e){return s.cobolStorageKeywordDictionary.has(e)}isNumber(e){try{return 0!==e.toString().length&&!isNaN(Number(e.toString()))}catch(t){return this.externalFeatures.logException("isNumber("+e+")",t),!1}}containsIndex(e){for(let t=0;t<e.length;t++)if("("===e[t]||")"===e[t]&&"["===e[t]||"]"===e[t])return!0;return!1}trimVariableToMap(e){const t=new Map;let n="",o=0;for(let i=0;i<e.length;i++)switch(e[i]){case"(":case"[":case")":case"]":0!==n.length&&(t.set(o,n),o=1+i,n="");break;default:n+=e[i]}return 0!==n.length&&t.set(o,n),t}trimLiteral(e){let t=e.trim();return 0===t.length?t:("("===t[0]&&(t=t.substr(1,t.length-1)),t.endsWith(")")&&(t=t.substr(0,t.length-1)),t=t.trim(),0===t.length?t:'"'===t[0]&&t.endsWith('"')||"'"===t[0]&&t.endsWith("'")?t.substr(1,t.length-2):t.endsWith(".")?t.substr(0,t.length-1):t)}isQuotedLiteral(e){let t=e.trim();if(0===t.length)return!1;let n=t[t.length-1];return"."===n&&(t=t.substr(0,t.length-1)),!(t.length<2)&&(n=t[t.length-1],'"'===t[0]&&'"'===n||"'"===t[0]&&"'"===n)}relaxedParseLineByLine(e,t,n){const o=new w(t,e);let i=0;do{try{const e=o.endsWithDot;let t=o.currentToken,r=o.currentTokenLower;if(i++,e&&(t=t.substr(0,t.length-1),r=r.substr(0,r.length-1)),1===i){const e=Number.parseInt(t,10);if(void 0!==e&&!isNaN(e)){n.numberTokensInHeader++;continue}}switch(r){case"section":if(0!==o.prevToken.length)switch(o.prevTokenLower){case"working-storage":case"file":case"linkage":case"screen":case"input-output":n.sectionsInToken++,n.leaveEarly=!0;break;default:!1===this.isValidProcedureKeyword(o.prevTokenLower)&&n.procedureDivisionRelatedTokens++}break;case"program-id":n.divisionsInToken++,n.leaveEarly=!0;break;case"division":switch(o.prevTokenLower){case"identification":n.divisionsInToken++,n.leaveEarly=!0;break;case"procedure":n.procedureDivisionRelatedTokens++,n.leaveEarly=!0}break;default:this.isValidProcedureKeyword(r)&&n.procedureDivisionRelatedTokens++,this.isValidStorageKeyword(r)&&n.workingStorageRelatedTokens++}if(0===t.length)continue}catch(e){this.externalFeatures.logException("COBOLScannner relaxedParseLineByLine line error: ",e)}}while(!1===o.moveToNextToken());return o}addReference(e,t,n,o,i){const r=e.get(t);if(void 0!==r)return void r.push(new v(this.sourceFileId,n,o,t.length,i));const s=[];s.push(new v(this.sourceFileId,n,o,t.length,i)),e.set(t,s)}addVariableOrConstant(e,t){const n=this.constantsOrVariables.get(e);if(void 0!==n)return void n.push(t);const o=[];o.push(t),this.constantsOrVariables.set(e,o)}cleanupReplaceToken(e,t){return e.endsWith(",")&&(e=e.substr(0,e.length-1)),e.startsWith("==")&&e.endsWith("==")?(t.isPseudoTextDelimiter=!0,e.substring(2,e.length-2)):e}parseLineByLine(e,t,n){const o=new w(n,t);return this.processToken(e,o,n,0!==this.sourceReferences.state.replaceMap.size)}processToken(e,t,n,o){const i=this.sourceReferences.state;do{try{let r=t.currentToken;if(0===r.length)continue;if(o){let o=n.substr(t.currentCol);const s=n.substr(t.currentCol);for(const[e,t]of i.replaceMap)o=o.replace(t.rex4wordreplace,e);if(o!==s)try{const i=n.substr(0,t.currentCol);this.sourceHandler.setUpdatedLine(e,i+o);const s=this.tokensInOrder.length,a=new w(o,new w(t.prevToken,void 0)),c=this.processToken(e,a,o,!1);if(s!==this.tokensInOrder.length)for(let e=s;e<this.tokensInOrder.length;e++){const n=this.tokensInOrder[e];n.startColumn=t.currentCol,n.endColumn=t.currentCol+r.length}return c}catch(e){this.externalFeatures.logException("replace",e)}}let s=t.currentTokenLower;if("to"===t.prevTokenLower&&"entry"===s){t.moveToNextToken();continue}if(r.endsWith(",")?(r=r.substr(0,r.length-1),s=r.toLowerCase(),i.prevEndsWithDot=i.endsWithDot,i.endsWithDot=!1):t.endsWithDot?(r=r.substr(0,r.length-1),s=r.toLowerCase(),i.prevEndsWithDot=i.endsWithDot,i.endsWithDot=!0):(i.prevEndsWithDot=i.endsWithDot,i.endsWithDot=!1),i.pickUpUsing){switch(i.endsWithDot&&(i.pickUpUsing=!1),s){case"using":i.using=g.BY_REF;break;case"by":break;case"reference":i.using=g.BY_REF;break;case"value":i.using=g.BY_VALUE;break;case"returning":i.using=g.RETURNING;break;default:void 0!==this.sourceReferences&&!1===this.isValidKeyword(s)&&!1===this.isNumber(s)&&(this.addReference(this.sourceReferences.unknownReferences,s,e,t.currentCol,m.Variable),i.parameters.push(new I(i.using,r)))}i.endsWithDot&&(i.currentProgramTarget.CallParameters=i.parameters);continue}const a=t.currentCol;if(i.skipToDot){if(i.addReferencesDuringSkipToTag){const o=this.trimLiteral(s),c=this.isValidKeyword(o);if(void 0!==this.sourceReferences&&this.isValidLiteral(o)&&!this.isNumber(o)&&!1===c&&this.addReference(this.sourceReferences.unknownReferences,o,e,t.currentCol,m.Unknown),c&&(i.addVariableDuringStipToTag=!1),"to"===t.prevTokenLower&&(i.addVariableDuringStipToTag=!1),"indexed"===t.prevTokenLower&&"by"===t.currentTokenLower&&(i.addVariableDuringStipToTag=!0),"depending"===t.prevTokenLower&&"on"===t.currentTokenLower&&(i.addVariableDuringStipToTag=!1),i.addVariableDuringStipToTag&&!1===c&&this.isValidLiteral(o)&&!this.isNumber(o)){const s=this.trimLiteral(r),c=this.newCOBOLToken(m.Variable,e,n,a,s,s,i.currentDivision,t.prevToken);this.addVariableOrConstant(o,c)}}if(i.inReplace)switch(s){case"by":i.captureReplaceLeft=!1;break;case"off":i.skipToDot=!1,i.inReplace=!1,i.replaceMap.clear();break;default:i.captureReplaceLeft?(0!==i.replaceLeft.length&&(i.replaceLeft+=" "),i.replaceLeft+=r):(0!==i.replaceRight.length&&(i.replaceRight+=" "),i.replaceRight+=r),!i.captureReplaceLeft&&r.endsWith("==")&&(i.replaceMap.set(this.cleanupReplaceToken(""+i.replaceRight,i.replace_state),new S(this.cleanupReplaceToken(""+i.replaceLeft,i.replace_state),i.replace_state)),i.replaceLeft=i.replaceRight="",i.captureReplaceLeft=!0)}if(i.inCopy){const t=i.copybook_state;switch(s){case"":break;case"suppress":case"resource":case"indexed":break;case"leading":t.isLeading=!0;break;case"trailing":t.isTrailing=!0;break;case"of":t.isOf=!0;break;case"in":t.isIn=!0;break;case"replacing":t.isReplacingBy=!1,t.isReplacing=!0,t.isLeading=!1,t.isTrailing=!1;break;case"by":t.isReplacingBy=!0,t.isReplacing=!1;break;default:if(t.isIn&&0===t.literal2.length){t.literal2=r;break}if(t.isOf&&0===t.library_name.length){t.library_name=r;break}if(t.isReplacing&&0===t.replaceLeft.length){t.replaceLeft=r;break}if(t.isReplacingBy){this.configHandler.enable_text_replacement&&t.copyReplaceMap.set(this.cleanupReplaceToken(""+r,t),new S(this.cleanupReplaceToken(""+t.replaceLeft,t),t)),t.isReplacingBy=!1,t.isReplacing=!0,t.isLeading=!1,t.isTrailing=!1,t.replaceLeft="";break}if(s.length>0&&!t.isOf&&!t.isIn){t.copyBook=r,t.trimmedCopyBook=this.trimLiteral(s),t.startLineNumber=e,t.startCol=i.inCopyStartColumn,t.line=n;break}}}!0===i.endsWithDot&&(i.inReplace=!1,i.skipToDot=!1,i.addReferencesDuringSkipToTag=!1,i.inCopy&&(i.copybook_state.endLineNumber=e,i.copybook_state.endCol=t.currentCol+t.currentToken.length,this.processCopyBook(i.copybook_state)),i.inCopy=!1);continue}const c=r,l=s,u=this.trimLiteral(t.prevToken),d=t.prevTokenLower.trim(),h=this.trimLiteral(d),p=t.prevToken+" "+c;if("exec"===l){i.currentToken=this.newCOBOLToken(m.Exec,e,n,0,u,"",i.currentDivision);continue}if("end-exec"===l){i.currentToken=y.Null,i.prevEndsWithDot=i.endsWithDot,i.endsWithDot=!0,t.endsWithDot=i.endsWithDot;continue}if(i.currentToken.tokenType===m.Exec)continue;if("end"===h&&"declaratives"===l){i.declaratives.endLine=e,i.declaratives.endColumn=n.indexOf(r),i.inDeclaratives=!1,i.declaratives=y.Null;continue}if(i.enable_text_replacement&&"replace"===l){i.inReplace=!0,i.skipToDot=!0,i.captureReplaceLeft=!0,i.replaceLeft=i.replaceRight="";continue}if(i.currentClass===y.Null&&0!==u.length&&"section"===l&&"exit"!==h){if("declare"===h)continue;if(i.currentDivision===y.Null&&("file"===h||"working-storage"===h||"local-storage"===h||"screen"===h||"linkage"===h)){if(0!==this.ImplicitProgramId.length){const t=this.trimLiteral(this.ImplicitProgramId),n=this.newCOBOLToken(m.ProgramId,e,"program-id. "+this.ImplicitProgramId,0,t,p,i.currentDivision);i.programs.push(n),n.ignoreInOutlineView=!0,this.ImplicitProgramId=""}i.currentDivision=this.newCOBOLToken(m.Division,e,"Data Division",0,"Data","Data Division (Optional)",i.currentDivision),i.currentDivision.ignoreInOutlineView=!0}"working-storage"!==h&&"linkage"!==h&&"local-storage"!==h&&"file-control"!==h&&"file"!==h&&"screen"!==h||(i.pickFields=!0,i.inProcedureDivision=!1),i.currentSection=this.newCOBOLToken(m.Section,e,n,0,u,p,i.currentDivision),this.sections.set(h,i.currentSection),i.current01Group=y.Null,i.currentLevel=y.Null;continue}if(i.captureDivisions&&0!==h.length&&"division"===l){i.currentDivision=this.newCOBOLToken(m.Division,e,n,0,u,p,y.Null),"procedure"===h&&(i.inProcedureDivision=!0,i.pickFields=!1,i.procedureDivision=i.currentDivision,!1===i.endsWithDot&&(i.pickUpUsing=!0));continue}if("entry"===d){let o=p;const r=this.trimLiteral(c);"&"==t.nextSTokenOrBlank().currentToken&&(o=u+" "+t.compoundItems(r,this));const s=this.newCOBOLToken(m.EntryPoint,e,n,a,r,o,i.currentDivision);i.entryPointCount++,i.parameters=[],i.currentProgramTarget=new x(s,!0,[]),this.callTargets.set(r,i.currentProgramTarget),i.pickUpUsing=!0;continue}if("program-id"===h){const o=this.trimLiteral(c),r=this.newCOBOLToken(m.ProgramId,e,n,a,o,p,i.currentDivision);i.programs.push(r),i.currentDivision!==y.Null&&(i.currentDivision.endLine=r.endLine,i.currentDivision.endColumn=r.endColumn),-1===o.indexOf(" ")&&!1===t.isTokenPresent("external")&&(i.parameters=[],i.currentProgramTarget=new x(r,!1,[]),this.callTargets.set(o,i.currentProgramTarget)),this.ImplicitProgramId="";continue}if("class-id"===h){const t=this.trimLiteral(c);i.currentClass=this.newCOBOLToken(m.ClassId,e,n,a,t,p,i.currentDivision),i.captureDivisions=!1,i.currentMethod=y.Null,i.pickFields=!0,this.classes.set(t,i.currentClass);continue}if(i.currentClass!==y.Null&&"end"===h&&("class"===l||"enum"===l||"valuetype"===l||"interface"===l)){i.currentClass.endLine=e,i.currentClass.endColumn=n.toLowerCase().indexOf(l)+l.length,i.currentClass=y.Null,i.captureDivisions=!0,i.currentMethod=y.Null,i.pickFields=!1,i.inProcedureDivision=!1;continue}if("enum-id"===h){i.currentClass=this.newCOBOLToken(m.EnumId,e,n,a,this.trimLiteral(c),p,y.Null),i.captureDivisions=!1,i.currentMethod=y.Null,i.pickFields=!0;continue}if("interface-id"===h){i.currentClass=this.newCOBOLToken(m.InterfaceId,e,n,a,this.trimLiteral(c),p,i.currentDivision),i.pickFields=!0,i.captureDivisions=!1,i.currentMethod=y.Null;continue}if("valuetype-id"===h){i.currentClass=this.newCOBOLToken(m.ValueTypeId,e,n,a,this.trimLiteral(c),p,i.currentDivision),i.pickFields=!0,i.captureDivisions=!1,i.currentMethod=y.Null;continue}if("function-id"===h){const t=this.trimLiteral(c);i.currentFunctionId=this.newCOBOLToken(m.FunctionId,e,n,a,t,p,i.currentDivision),i.captureDivisions=!0,i.pickFields=!0,i.parameters=[],i.currentProgramTarget=new x(i.currentFunctionId,!1,[]),this.functionTargets.set(t,i.currentProgramTarget);continue}if("method-id"===h){const o="new"===this.trimLiteral(l)?m.Constructor:m.MethodId,r=t.nextSTokenOrBlank().currentTokenLower,s=t.nextSTokenOrBlank().currentToken;if("property"===r){const o=t.nextSTokenPlusOneOrBlank().currentToken,r=this.trimLiteral(o);i.currentMethod=this.newCOBOLToken(m.Property,e,n,a,r,s+" "+o,i.currentDivision),this.methods.set(r,i.currentMethod)}else{const t=this.trimLiteral(c);i.currentMethod=this.newCOBOLToken(o,e,n,a,t,p,i.currentDivision),this.methods.set(t,i.currentMethod)}i.pickFields=!0,i.captureDivisions=!1;continue}if(i.currentMethod!==y.Null&&"end"===h&&"method"===l){i.currentMethod.endLine=e,i.currentMethod.endColumn=n.toLowerCase().indexOf(l)+l.length,i.currentMethod=y.Null,i.pickFields=!1;continue}if(0!==i.programs.length&&"end"===h&&"program"===l){const t=i.programs.pop();void 0!==t&&(t.endLine=e,t.endColumn=n.length),i.currentDivision!==y.Null&&(i.currentDivision.endLine=e,i.currentDivision.endColumn=n.length),i.currentSection!==y.Null&&(i.currentSection.endLine=e,i.currentSection.endColumn=n.length),i.currentParagraph!==y.Null&&(i.currentParagraph.endLine=e,i.currentParagraph.endColumn=n.length),i.currentDivision=y.Null,i.currentSection=y.Null,i.currentParagraph=y.Null,i.inProcedureDivision=!1,i.pickFields=!1;continue}if(i.currentFunctionId!==y.Null&&"end"===h&&"function"===l){i.currentFunctionId.endLine=e,i.currentFunctionId.endColumn=n.toLowerCase().indexOf(l)+l.length,this.newCOBOLToken(m.EndFunctionId,e,n,a,u,c,i.currentDivision),i.pickFields=!1,i.inProcedureDivision=!1,i.currentDivision!==y.Null&&(i.currentDivision.endLine=e),i.currentSection!==y.Null&&(i.currentSection.endLine=e),i.currentDivision=y.Null,i.currentSection=y.Null,i.currentParagraph=y.Null,i.procedureDivision=y.Null;continue}if("declaratives"===l){i.declaratives=this.newCOBOLToken(m.Declaratives,e,n,a,c,c,i.currentDivision),i.inDeclaratives=!0;continue}if("copy"===l){i.copybook_state=new L,i.inCopy=!0,i.inCopyStartColumn=t.currentCol,i.skipToDot=!0,i.copybook_state.copyVerb=c;continue}if(i.captureDivisions&&i.currentDivision!==y.Null&&i.currentDivision===i.procedureDivision&&i.endsWithDot&&i.prevEndsWithDot&&!this.isValidKeyword(l)&&0!==r.length&&this.isParagraph(r))if(i.currentSection!==y.Null){const t=this.newCOBOLToken(m.Paragraph,e,n,a,r,r,i.currentSection);this.paragraphs.set(t.tokenNameLower,t)}else{const t=this.newCOBOLToken(m.Paragraph,e,n,a,r,r,i.currentDivision);this.paragraphs.set(t.tokenNameLower,t)}if("input-output"===i.currentSection.tokenNameLower&&("fd"!==h&&"select"!==h||(i.pickFields=!0)),i.pickFields&&u.length>0){let o=a;if(this.isNumber(u)&&!this.isNumber(c)){const r="filler"===l;let s=r,a=this.trimLiteral(c);if(!s){const e=/comp-[0-9]/;"pic"===l||"picture"===l||e.test(l)||l.startsWith("binary-")?(n=u+" filler ",a="filler",s=!0,o=0):this.isValidKeyword(l)||(s=!0)}if(s&&this.isValidLiteral(l)){let s=m.Variable;const c=t.nextSTokenOrBlank().currentTokenLower;"78"===u&&(s=m.Constant),"88"===u&&(s=m.ConditionName);let d=u;"01"!==u&&"1"!==u||(("redefines"===c||0===c.length||"report"===i.currentSection.tokenNameLower)&&(d+="-GROUP"),t.isTokenPresent("constant")&&(s=m.Constant),t.isTokenPresent("redefines")&&(s=m.Union));const h=this.newCOBOLToken(s,e,n,o,a,a,i.currentDivision,d);r||this.addVariableOrConstant(l,h),i.currentLevel!==y.Null&&"88"===u&&(i.currentLevel.endLine=h.startLine,i.currentLevel.endColumn=h.startColumn+h.tokenName.length),"88"!==u&&(i.currentLevel=h),"01"!==u&&"1"!==u&&"66"!==u&&"77"!==u&&"78"!==u||(0===c.length||"redefines"===c||"report"===i.currentSection.tokenNameLower&&"type"===c?i.current01Group=h:i.current01Group=y.Null),i.current01Group!==y.Null&&(i.current01Group.endLine=h.startLine,i.current01Group.endColumn=h.startColumn+h.tokenName.length),!1===i.endsWithDot&&(i.skipToDot=!0,i.addReferencesDuringSkipToTag=!0)}continue}if(("fd"===h||"sd"===h||"rd"===h||"select"===h)&&!this.isValidKeyword(l)){const t=this.trimLiteral(c);if(this.isValidLiteral(l)){const o=this.newCOBOLToken(m.Variable,e,n,a,t,t,i.currentDivision,h);this.addVariableOrConstant(l,o)}"rd"!==h&&"select"!==h||("select"===h&&(i.addReferencesDuringSkipToTag=!0),i.skipToDot=!0);continue}}if(this.parse4References&&void 0!==this.sourceReferences&&i.inProcedureDivision){if(this.isQuotedLiteral(l))continue;if(!0===this.isNumber(l)||!0===this.isValidKeyword(l))continue;if(!1===this.containsIndex(l)){if("perform"===h||"to"===h||"goto"===h||"thru"===h||"through"===h){let n=m.Unknown,o=this.sourceReferences.unknownReferences;this.isVisibleSection(l)?(n=m.Section,o=this.sourceReferences.targetReferences):this.isVisibleParagraph(l)&&(n=m.Paragraph,o=this.sourceReferences.targetReferences),this.addReference(o,l,e,t.currentCol,n);continue}const n=this.constantsOrVariables.get(l);if(void 0!==n){let o=m.Variable,i=!0;for(const e of n)!1===e.ignoreInOutlineView?o=e.tokenType===m.Unknown?o:e.tokenType:i=!1;i&&this.addReference(this.sourceReferences.constantsOrVariablesReferences,l,e,t.currentCol,o)}else{let n=m.Unknown,o=this.sourceReferences.unknownReferences;this.isVisibleSection(l)?(n=m.Section,o=this.sourceReferences.targetReferences):this.isVisibleParagraph(l)&&(n=m.Paragraph,o=this.sourceReferences.targetReferences),this.addReference(o,l,e,t.currentCol,n)}continue}for(const[n,o]of this.trimVariableToMap(l)){if(!0===this.isNumber(o)||!0===this.isValidKeyword(o)||!1===this.isValidLiteral(o))continue;const i=this.constantsOrVariables.get(o);if(void 0!==i){let r=m.Variable,s=!0;for(const e of i)!1===e.ignoreInOutlineView?r=e.tokenType===m.Unknown?r:e.tokenType:s=!1;s&&this.addReference(this.sourceReferences.constantsOrVariablesReferences,o,e,t.currentCol+n,r)}else this.addReference(this.sourceReferences.unknownReferences,o,e,t.currentCol+n,m.Unknown)}}}catch(e){this.externalFeatures.logException("COBOLScannner line error: ",e)}}while(!1===t.moveToNextToken());return t}processCopyBook(e){const t=this.sourceReferences.state;let n=y.Null;const o=e.isIn,i=e.isOf,r=e.startLineNumber,s=e.startCol,l=e.line,u=e.trimmedCopyBook,d=e.copyVerb,h=e.copyBook;let p=this.copybookNestedInSection?t.currentSection:t.currentDivision;if(p===y.Null&&(p=t.currentDivision),o||i){const t=o?" in ":" of ",i=this.trimLiteral(e.library_name)+this.trimLiteral(e.literal2),a=d+" "+h+t+i;n=this.newCOBOLToken(m.CopyBookInOrOf,r,l,s,u,a,p,i)}else n=this.newCOBOLToken(m.CopyBook,r,l,s,u,d+" "+h,p);if(n.endLine=e.endLineNumber,n.endColumn=e.endCol,t.inCopy=!1,!1===this.copyBooksUsed.has(u)){const o=new T(n,!1,e);if(this.copyBooksUsed.set(u,o),void 0!==this.sourceReferences&&this.parse_copybooks_for_references){const i=this.externalFeatures.expandLogicalCopyBookToFilenameOrEmpty(u,n.extraInformation,this.configHandler);if(i.length>0){if(e.fileName=i,!1===this.copyBooksUsed.has(i)){this.copyBooksUsed.delete(u),this.copyBooksUsed.set(i,o);const n=new a.FileSourceHandler(i,!1),r=this.sourceReferences.topLevel,s=t.ignoreInOutlineView;t.ignoreInOutlineView=!0,this.sourceReferences.topLevel=!1;const c=this.sourceReferences.state.replaceMap;this.configHandler.enable_text_replacement&&(this.sourceReferences.state.replaceMap=new Map([...e.copyReplaceMap,...c]));const l=R.ParseUncachedInlineCopybook(n,this,this.parse_copybooks_for_references,this.eventHandler,this.externalFeatures);e.sourceHandler=l.sourceHandler,this.sourceReferences.state.replaceMap=c,this.sourceReferences.topLevel=r,t.ignoreInOutlineView=s,o.parsed=!0}}else if(!1===this.configHandler.linter_ignore_missing_copybook){const e=`Unable to locate copybook ${u}`;this.diagWarnings.set(e,new c.COBOLFileSymbol(this.filename,n.startLine))}}}}processComment(e,t,n){this.sourceReferences.state.currentLineIsComment=!0;const o=e.indexOf("*>");if(void 0!==o&&-1!==o){0!==e.substring(0,o).trimRight().length&&(this.sourceReferences.state.currentLineIsComment=!1);const i=e.indexOf(this.cobolLintLiteral);if(-1!==i){let t=e.substring(this.cobolLintLiteral.length+i).trim().split(" ");const n=t[0];t=t.slice(1);const o=void 0!==n?n.trim():void 0;if(void 0!==o&&o===d.CobolLinterProviderSymbols.NotReferencedMarker_external)for(const e in t)this.sourceReferences.ignoreUnusedSymbol.set(t[e].toLowerCase(),t[e])}if(this.configHandler.scan_comments_for_hints){const o=this.configHandler.scan_comment_copybook_token,i=e.indexOf(o);if(-1!==i){const r=e.substring(o.length+i).trim().split(" ");if(0!==r.length)for(const e in r){const i=r[e].trim(),s=this.externalFeatures.expandLogicalCopyBookToFilenameOrEmpty(i,"",this.configHandler);if(s.length>0){if(!1===this.copyBooksUsed.has(s)){this.copyBooksUsed.set(s,T.Null);const e=new a.FileSourceHandler(s,!1),t=this.sourceReferences.state.ignoreInOutlineView;this.sourceReferences.state.ignoreInOutlineView=!0,this.sourceReferences.topLevel=!0,R.ParseUncachedInlineCopybook(e,this,this.parse_copybooks_for_references,this.eventHandler,this.externalFeatures),this.sourceReferences.topLevel=!0,this.sourceReferences.state.ignoreInOutlineView=t}}else if(!1===this.configHandler.linter_ignore_missing_copybook){const e=`${o}: Unable to locate copybook ${i} specified in embedded comment`;this.diagWarnings.set(e,new c.COBOLFileSymbol(t,n))}}}}}}}t.default=R,R.literalRegex=/^[#a-zA-Z0-9][a-zA-Z0-9-_]*$/g,R.paragraphRegex=/^[a-zA-Z0-9][a-zA-Z0-9-_]*$/g},3987:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.COBOLSourceScannerUtils=void 0;const a=r(n(5747)),c=r(n(5622)),l=n(3130),u=n(842),d=n(7549),h=s(n(1661)),p=n(5363),f=n(6271),m=c.join(h.default,"vscode_"+process.pid)+".txt";let g,C;function _(e){C.log(e)}class b{static cleanUpOldMetadataFiles(e,t){if(e.cache_metadata!==u.CacheDirectoryStrategy.Off){if(!e.parse_copybooks_for_references){try{const e=c.join(t,"globalsymbols.sym");f.COBOLFileUtils.isFile(e)&&a.unlinkSync(e)}catch(e){}try{const e=c.join(t,"filesymbols.sym");f.COBOLFileUtils.isFile(e)&&a.unlinkSync(e)}catch(e){}}}else _("Metadata is not enabled")}static dumpMetaData(e,t){if(g=a.createWriteStream(m),C=new console.Console(g),e.cache_metadata===u.CacheDirectoryStrategy.Off)return _("Metadata is not enabled"),g.close(),void d.workspace.openTextDocument(m);if(_("Metadata Dump"),_(" cache_metadata : "+e.cache_metadata+"\n"),_(" cache folder             : "+t),_(" Dirty flag               : "+p.InMemoryGlobalSymbolCache.isDirty),_(""),_("Global symbols            : (made lowercase)"),!e.parse_copybooks_for_references){_(""),_("Paragraphs/Sections in file :");for(const n of a.readdirSync(t))if("globalsymbols.sym"!==n&&"filesymbols.sym"!==n){if(n.endsWith(".sym")){const e=l.COBOLSymbolTableHelper.getSymbolTable_direct(c.join(t,n));if(void 0!==e&&(0!==e.labelSymbols.size||0!==e.variableSymbols.size)){_(" "+e.fileName+" in "+n),_("   Label symbol count    : "+e.labelSymbols.size);for(const[,t]of e.labelSymbols.entries())_(`     ${t.symbol}:${t.lnum}`);_("   Variable symbol count : "+e.variableSymbols.size);for(const[,t]of e.variableSymbols.entries())_(`     ${t.symbol}:${t.lnum}`)}}}else b.cleanUpOldMetadataFiles(e,t)}g.close(),d.workspace.openTextDocument(m).then((e=>d.window.showTextDocument(e)))}static cleanup(){try{f.COBOLFileUtils.isFile(m)&&a.unlinkSync(m)}catch(e){}}}t.COBOLSourceScannerUtils=b},8548:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.COBOLUtils=t.FoldAction=t.FoldStyle=void 0;const c=r(n(7549)),l=a(n(5622)),u=n(8202),d=n(7530),h=n(112),p=n(5323),f=a(n(6560)),m=n(5363),g=n(5747),C=n(6271),_=n(7892),b=n(627),y=n(842),v=n(3412);var O,w;!function(e){e[e.LowerCase=1]="LowerCase",e[e.UpperCase=2]="UpperCase",e[e.CamelCase=3]="CamelCase"}(O=t.FoldStyle||(t.FoldStyle={})),function(e){e[e.PerformTargets=1]="PerformTargets",e[e.ConstantsOrVariables=2]="ConstantsOrVariables",e[e.Keywords=3]="Keywords"}(w=t.FoldAction||(t.FoldAction={}));class S{static getCopybookGlobPattern(e){let t="*.{";for(const n of e.copybookexts)0!==n.length&&(t.endsWith("{")?t+=n:t+=","+n);return t+="}",t}static getProgramGlobPattern(e){let t=e.maintain_metadata_recursive_search?"**/*.{":"*.{";for(const n of e.program_extensions)0!==n.length&&(t.endsWith("{")?t+=n:t+=","+n);return t+="}",t}static populateDefaultCallableSymbolsSync(e,t){(()=>{s(this,void 0,void 0,(function*(){return yield S.populateDefaultCallableSymbols(e,t)}))})()}static populateDefaultCallableSymbols(e,t){var n;return s(this,void 0,void 0,(function*(){if(e.cache_metadata!==y.CacheDirectoryStrategy.Off)return;if(void 0===b.getWorkspaceFolders())return;const o=c.workspace.workspaceFile;if(void 0===o)return void m.InMemoryGlobalSymbolCache.defaultCallableSymbols.clear();if(t)S.prevWorkSpaceUri=void 0;else if(o.fsPath===(null===(n=S.prevWorkSpaceUri)||void 0===n?void 0:n.fsPath))return;S.prevWorkSpaceUri=o;const i=_.VSCOBOLConfiguration.get(),r=S.getProgramGlobPattern(i);yield c.workspace.findFiles(r).then((e=>{e.forEach((e=>{const t=e.fsPath,n=m.InMemoryGlobalCacheHelper.getFilenameWithoutPath(t),o=l.default.basename(n,l.default.extname(n)).toLowerCase();void 0===m.InMemoryGlobalSymbolCache.defaultCallableSymbols.get(o)&&m.InMemoryGlobalSymbolCache.defaultCallableSymbols.set(o,t)}))}))}))}static typeToArray(e,t,n){for(const[o]of n.entries()){const i=n.get(o);void 0!==i&&i.forEach((function(n){e.push(`${t},${o},${n.filename},${n.lnum}`)}))}}static clearGlobalCache(){if(void 0===b.getWorkspaceFolders())return;const e=c.workspace.getConfiguration("coboleditor");e.update("metadata_symbols",[],!1),e.update("metadata_entrypoints",[],!1),e.update("metadata_types",[],!1),e.update("metadata_files",[],!1),e.update("metadata_knowncopybooks",[],!1),m.InMemoryGlobalSymbolCache.isDirty=!1}static saveGlobalCacheToWorkspace(e,t=!0){if(void 0!==b.getWorkspaceFolders()&&(0!=e.maintain_metadata_cache_single_folder||void 0!==c.workspace.workspaceFile)&&!1!==e.maintain_metadata_cache&&m.InMemoryGlobalSymbolCache.isDirty){const n=e.cache_metadata!==y.CacheDirectoryStrategy.Off,o=e.metadata_symbols,i=e.metadata_entrypoints,r=e.metadata_types,s=e.metadata_files,a=e.metadata_knowncopybooks;if(o.length=0,i.length=0,r.length=0,s.length=0,a.length=0,n)t=!0;else{for(const[e]of m.InMemoryGlobalSymbolCache.callableSymbols.entries())if(null!==e&&0!==e.length){const n=m.InMemoryGlobalSymbolCache.callableSymbols.get(e);void 0!==n&&n.forEach((function(n){t=!0,!1===m.InMemoryGlobalSymbolCache.defaultCallableSymbols.has(e)&&(0!==n.lnum?o.push(`${e},${n.filename},${n.lnum}`):o.push(`${e},${n.filename}`))}))}else t=!0;for(const[e]of m.InMemoryGlobalSymbolCache.entryPoints.entries())if(null!==e&&0!==e.length){const t=m.InMemoryGlobalSymbolCache.entryPoints.get(e);void 0!==t&&t.forEach((function(t){i.push(`${e},${t.filename},${t.lnum}`)}))}for(const[e]of m.InMemoryGlobalSymbolCache.knownCopybooks.entries())a.push(e);S.typeToArray(r,"T",m.InMemoryGlobalSymbolCache.types),S.typeToArray(r,"I",m.InMemoryGlobalSymbolCache.interfaces),S.typeToArray(r,"E",m.InMemoryGlobalSymbolCache.enums);for(const[e]of m.InMemoryGlobalSymbolCache.sourceFilenameModified.entries())if(null!==e&&0!==e.length){const t=m.InMemoryGlobalSymbolCache.sourceFilenameModified.get(e);void 0!==t&&s.push(`${t.lastModifiedTime},${t.workspaceFilename}`)}}if(t)try{const e=c.workspace.getConfiguration("coboleditor");e.update("metadata_symbols",o,!1),e.update("metadata_entrypoints",i,!1),e.update("metadata_types",r,!1),e.update("metadata_files",s,!1),e.update("metadata_knowncopybooks",a,!1),m.InMemoryGlobalSymbolCache.isDirty=!1}catch(e){h.logException("Failed to update metadata",e)}}}static inCopybookdirs(e,t){for(const n of e.copybookdirs)if(n===t)return!0;return!1}static migrateCopybooksToWorkspace(){const e=[],t=_.VSCOBOLConfiguration.get().copybookdirs;let n=!1;for(let e=0;e<t.length;e++){const o=t[e];if(C.COBOLFileUtils.isDirectPath(o)){const e=b.getWorkspaceFolders();if(void 0!==c.workspace&&void 0!==e&&!1===v.VSCOBOLFileUtils.isPathInWorkspace(o)&&C.COBOLFileUtils.isNetworkPath(o)){h.logMessage(" Adding "+o+" to workspace");const t=c.Uri.file(l.default.normalize(o));c.workspace.updateWorkspaceFolders(e.length,0,{uri:t}),n=!0}}}const o=b.getWorkspaceFolders();if(void 0!==o)for(const i of o)for(let r=0;r<t.length;r++)try{const s=t[r];let a;if(!1===C.COBOLFileUtils.isDirectPath(s)&&(a=l.default.join(i.uri.fsPath,s),h.isDirectory(a)))if(C.COBOLFileUtils.isNetworkPath(a)){if(!1===v.VSCOBOLFileUtils.isPathInWorkspace(a)){h.logMessage(" Adding "+a+" to workspace");const e=c.Uri.file(l.default.normalize(a));c.workspace.updateWorkspaceFolders(o.length,0,{uri:e}),n=!0}else e.push(a);h.logMessage(" The directory "+a+" for performance should be part of the workspace")}else e.push(a)}catch(e){h.logException("dir",e)}n?(c.workspace.getConfiguration("coboleditor").update("copybookdirs",e),h.logMessage("Copybook settings and workspace has been updated.")):h.logMessage("No copybook directories have been migrated")}static extractSelectionToCopybook(e){const t=e.selection,n=new c.Range(t.start,t.end),o=e.document.getText(n),i=l.default.dirname(e.document.fileName);c.window.showInputBox({prompt:"Copybook name?",validateInput:e=>!e||-1!==e.indexOf(" ")||-1!==e.indexOf(".")||C.COBOLFileUtils.isFile(l.default.join(i,e+".cpy"))?"Invalid copybook":void 0}).then((t=>{if(void 0===t)return;const r=l.default.join(i,t+".cpy");g.writeFileSync(r,o),e.edit((e=>{e.replace(n,'           copy "'+t+'.cpy".')}))}))}static extractSelectionTo(e,t){const n=e.selection,o=new c.Range(n.start,n.end),i=e.document.getText(o);c.window.showInputBox({prompt:t?"New paragraph name?":"New section name?",validateInput:e=>e&&-1===e.indexOf(" ")?void 0:"Invalid paragraph or section"}).then((n=>{void 0!==n&&e.edit((e=>{e.replace(o,"           perform "+n+"\n\n       "+n+(t?".\n":" section.\n")+i+"\n           .\n")}))}))}static pad(e,t){let n=e+"";for(;n.length<t;)n="0"+n;return n}static getMFUnitAnsiColorConfig(){let e=c.workspace.getConfiguration("coboleditor").get("mfunit.diagnostic.color");return null==e&&(e=!1),e}static resequenceColumnNumbers(e,t,n){if(void 0===e)return;const o=new c.WorkspaceEdit,i=e.document.uri;for(let r=0;r<e.document.lineCount;r++)if(e.document.lineAt(r).text.length>6){const e=new c.Position(r,0),s=new c.Position(r,6),a=new c.Range(e,s),l=S.pad(t+r*n,6);o.replace(i,a,l)}c.workspace.applyEdit(o)}static removeColumnNumbers(e){const t=new c.WorkspaceEdit,n=e.document.uri;for(let o=0;o<e.document.lineCount;o++)if(e.document.lineAt(o).text.length>6){const e=new c.Position(o,0),i=new c.Position(o,6),r=new c.Range(e,i);t.replace(n,r,"      ")}c.workspace.applyEdit(t)}static RemoveIdentificationArea(e){const t=new c.WorkspaceEdit,n=e.document.uri;for(let o=0;o<e.document.lineCount;o++){const i=e.document.lineAt(o).text;if(i.length>73){const e=new c.Position(o,72),r=new c.Position(o,i.length),s=new c.Range(e,r);t.delete(n,s)}}c.workspace.applyEdit(t)}static RemoveComments(e){const t=e.document.uri,n=new c.WorkspaceEdit,o=[],i=[];o.push("\\*>"),i.push(!0),o.push("^......\\*"),i.push(!1);for(let r=0;r<e.document.lineCount;r++){const s=e.document.lineAt(r);let a=!1;for(let l=0;l<o.length;l++)if(!a){const u=o[l].replace(/\//gi,"\\/"),d=i[l],h=new RegExp(u,"ig").exec(s.text);if(h){if(d){const o=new c.Position(r,h.index),i=new c.Position(r,s.text.length),a=new c.Range(o,i);n.delete(t,a),e.document.getText(a)}else{const e=new c.Position(r,h.index),o=new c.Position(r+1,0),i=new c.Range(e,o);n.delete(t,i)}a=!0}}}c.workspace.applyEdit(n)}static isValidKeywordOrStorageKeyword(e){const t=e.toLowerCase();return!!d.cobolKeywordDictionary.has(t)||!!d.cobolStorageKeywordDictionary.has(t)||d.cobolRegistersDictionary.has(t)}static foldTokenLine(e,t,n,o,i){let r=e;const s=[];u.splitArgument(e,!0,s);const a=e.toLowerCase();let c=0;for(let e=0;e<s.length;e++){let l=s[e];l.endsWith(".")&&(l=l.substr(0,l.length-1));const d=l.toLowerCase(),h=a.indexOf(d,c);let p=!1;switch(n){case w.PerformTargets:p=t.sections.has(d),!1===p&&(p=t.paragraphs.has(d));break;case w.ConstantsOrVariables:if(p=t.constantsOrVariables.has(d),p&&i){const e=t.constantsOrVariables.get(d);if(void 0!==e)for(const t of e)t.tokenType===u.COBOLTokenStyle.Constant&&(o=O.UpperCase)}break;case w.Keywords:p=S.isValidKeywordOrStorageKeyword(d)}if(p)switch(o){case O.LowerCase:if(d!==l){const e=r.substr(0,h)+d+r.substr(h+l.length);r=e,c+=l.length}break;case O.UpperCase:{const e=l.toUpperCase();if(e!==l){const t=r.substr(0,h)+e+r.substr(h+l.length);r=t,c+=l.length}}break;case O.CamelCase:{const e=u.camelize(l);if(e!==l){const t=r.substr(0,h)+e+r.substr(h+l.length);r=t,c+=l.length}}}}return r!==e?r:e}static foldToken(e,t,n){const o=e.document.uri,i=_.VSCOBOLConfiguration.get(),r=new p.VSCodeSourceHandler(e.document,!1),s=f.default.getCachedObject(e.document,i);if(void 0===s)return void h.logMessage(`Unable to fold ${r.getFilename}, as it is has not been parsed`);const a=new c.WorkspaceEdit;for(let e=0;e<r.getLineCount();e++){const l=r.getLine(e,!1);if(void 0===l)break;const u=S.foldTokenLine(l,s,t,n,i.format_constants_to_uppercase);if(u!==l){const t=new c.Position(e,0),n=new c.Position(e,u.length),i=new c.Range(t,n);a.replace(o,i,u)}}c.workspace.applyEdit(a)}}t.COBOLUtils=S,S.prevWorkSpaceUri=void 0},8331:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.COBOLWorkspaceSymbolCacheHelper=t.TypeCategory=void 0;const i=o(n(5622)),r=n(4669),s=n(842),a=n(5363);var c;!function(e){e.ClassId="T",e.InterfaceId="I",e.EnumId="E"}(c=t.TypeCategory||(t.TypeCategory={}));class l{static removeAllProgramSymbols(e,t){for(const[n]of t){const o=t.get(n);if(void 0!==o){const i=[];for(let t=0;t<o.length;t++)o[t].filename!==e&&i.push(o[t]);i.length!==o.length&&(0!==i.length?t.set(n,i):t.delete(n))}}}static addSymbolToCache(e,t,n,o){const i=t.toLowerCase();if(o.has(i)){const t=o.get(i);if(void 0!==t){let o=0,i=0,s=-1;for(let n=0;n<t.length;n++)t[n].filename===e&&(i=n,o++,1!==t[n].lnum&&(s=n));return 0===o?(t.push(new r.COBOLFileSymbol(e,n)),void(a.InMemoryGlobalSymbolCache.isDirty=!0)):void(1===o?(t[i].lnum=n,a.InMemoryGlobalSymbolCache.isDirty=!0):-1!==s&&(t[s].lnum=n,a.InMemoryGlobalSymbolCache.isDirty=!0))}}const s=[];s.push(new r.COBOLFileSymbol(e,n)),o.set(i,s),a.InMemoryGlobalSymbolCache.isDirty=!0}static isValidLiteral(e){return null!==e&&0!==e.length&&!!e.match(l.literalRegex)}static addCalableSymbol(e,t,n){if(0===e.length||0===t.length)return;const o=a.InMemoryGlobalCacheHelper.getFilenameWithoutPath(e),r=i.default.basename(o,i.default.extname(o)).toLowerCase();if(!1!==l.isValidLiteral(t)){if(t.toLowerCase()!=r)return 0!==n&&a.InMemoryGlobalSymbolCache.defaultCallableSymbols.has(r)?(a.InMemoryGlobalSymbolCache.defaultCallableSymbols.delete(r),void l.addSymbolToCache(o,t,n,a.InMemoryGlobalSymbolCache.callableSymbols)):void(!1===a.InMemoryGlobalSymbolCache.defaultCallableSymbols.has(r)&&l.addSymbolToCache(o,t,n,a.InMemoryGlobalSymbolCache.callableSymbols));a.InMemoryGlobalSymbolCache.defaultCallableSymbols.set(r,e)}}static addEntryPoint(e,t,n){0!==e.length&&0!==t.length&&l.addSymbolToCache(a.InMemoryGlobalCacheHelper.getFilenameWithoutPath(e),t,n,a.InMemoryGlobalSymbolCache.entryPoints)}static addReferencedCopybook(e,t){const n=`${e},${a.InMemoryGlobalCacheHelper.getFilenameWithoutPath(t)}`;a.InMemoryGlobalSymbolCache.knownCopybooks.has(n)||(a.InMemoryGlobalSymbolCache.knownCopybooks.set(n,e),a.InMemoryGlobalSymbolCache.isDirty=!0)}static removeAllCopybookReferences(e){const t=a.InMemoryGlobalCacheHelper.getFilenameWithoutPath(e),n=[];for(const[e]of a.InMemoryGlobalSymbolCache.knownCopybooks)e.split(",")[1]===t&&n.push(e);for(const e of n)a.InMemoryGlobalSymbolCache.knownCopybooks.delete(e)}static addClass(e,t,n,o){let i=a.InMemoryGlobalSymbolCache.types;switch(o){case c.ClassId:i=a.InMemoryGlobalSymbolCache.types;break;case c.InterfaceId:i=a.InMemoryGlobalSymbolCache.interfaces;break;case c.EnumId:i=a.InMemoryGlobalSymbolCache.enums}l.addSymbolToCache(a.InMemoryGlobalCacheHelper.getFilenameWithoutPath(e),t,n,i)}static removeAllPrograms(e){l.removeAllProgramSymbols(a.InMemoryGlobalCacheHelper.getFilenameWithoutPath(e),a.InMemoryGlobalSymbolCache.callableSymbols)}static removeAllProgramEntryPoints(e){l.removeAllProgramSymbols(a.InMemoryGlobalCacheHelper.getFilenameWithoutPath(e),a.InMemoryGlobalSymbolCache.entryPoints)}static removeAllTypes(e){l.removeAllProgramSymbols(a.InMemoryGlobalCacheHelper.getFilenameWithoutPath(e),a.InMemoryGlobalSymbolCache.types),l.removeAllProgramSymbols(a.InMemoryGlobalCacheHelper.getFilenameWithoutPath(e),a.InMemoryGlobalSymbolCache.enums),l.removeAllProgramSymbols(a.InMemoryGlobalCacheHelper.getFilenameWithoutPath(e),a.InMemoryGlobalSymbolCache.interfaces)}static loadGlobalCacheFromArray(e,t,n){const o=e.cache_metadata!==s.CacheDirectoryStrategy.Off;if((n||o)&&a.InMemoryGlobalSymbolCache.callableSymbols.clear(),!o)for(const e of t){const t=e.split(",");2===t.length&&l.addCalableSymbol(t[1],t[0],0),3===t.length&&l.addCalableSymbol(t[1],t[0],Number.parseInt(t[2]))}}static loadGlobalEntryCacheFromArray(e,t,n){const o=e.cache_metadata!==s.CacheDirectoryStrategy.Off;if((n||o)&&a.InMemoryGlobalSymbolCache.entryPoints.clear(),!o)for(const e of t){const t=e.split(",");3===t.length&&l.addEntryPoint(t[1],t[0],Number.parseInt(t[2],10))}}static loadGlobalKnownCopybooksFromArray(e,t,n){const o=e.cache_metadata!==s.CacheDirectoryStrategy.Off;if((n||o)&&a.InMemoryGlobalSymbolCache.knownCopybooks.clear(),!o)for(const e of t){const t=e.split(",");2===t.length&&a.InMemoryGlobalSymbolCache.knownCopybooks.set(e,t[1])}}static loadGlobalTypesCacheFromArray(e,t,n){const o=e.cache_metadata!==s.CacheDirectoryStrategy.Off;if((n||o)&&(a.InMemoryGlobalSymbolCache.enums.clear(),a.InMemoryGlobalSymbolCache.interfaces.clear(),a.InMemoryGlobalSymbolCache.types.clear()),!o)for(const e of t){const t=e.split(",");if(4===t.length){let e=c.ClassId;switch(t[0]){case"I":e=c.InterfaceId;break;case"T":e=c.ClassId;break;case"E":e=c.EnumId}l.addClass(t[2],t[1],Number.parseInt(t[3],10),e)}}}static loadFileCacheFromArray(e,t,n,o){const i=e.cache_metadata!==s.CacheDirectoryStrategy.Off;if((o||i)&&a.InMemoryGlobalSymbolCache.sourceFilenameModified.clear(),!i)for(const e of n){const n=e.split(",");if(2===n.length){const e=BigInt(n[0]),o=t.getFullWorkspaceFilename(n[1],e);if(void 0!==o){const t=new r.COBOLWorkspaceFile(e,n[1]);a.InMemoryGlobalSymbolCache.sourceFilenameModified.set(o,t)}else l.removeAllProgramEntryPoints(n[1]),l.removeAllTypes(n[1])}}}}t.COBOLWorkspaceSymbolCacheHelper=l,l.literalRegex=/^[#a-zA-Z0-9][a-zA-Z0-9-_]*$/g},646:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ScanDataHelper=t.COBSCANNER_KNOWNCOPYBOOK=t.COBSCANNER_ADDFILE=t.COBSCANNER_SENDCLASS=t.COBSCANNER_SENDENUM=t.COBSCANNER_SENDINTERFACE=t.COBSCANNER_SENDEP=t.COBSCANNER_SENDPRGID=t.COBSCANNER_STATUS=t.ScanStats=t.ScanData=void 0;const i=o(n(5622)),r=o(n(5747));function s(e,t){return"bigint"==typeof t?t.toString():t}function a(e,t){return"bigint"==typeof t&&null!==t?BigInt(t):t}t.ScanData=class{constructor(){this.sendOnCount=0,this.sendOnFileCount=0,this.sendPercent=0,this.scannerBinDir="",this.directoriesScanned=0,this.maxDirectoryDepth=0,this.fileCount=0,this.parse_copybooks_for_references=!1,this.cache_metadata_show_progress_messages=!1,this.cacheDirectory="",this.Files=[],this.showStats=!0,this.md_symbols=[],this.md_entrypoints=[],this.md_types=[],this.md_metadata_files=[],this.md_metadata_knowncopybooks=[],this.workspaceFolders=[]}},t.ScanStats=class{constructor(){this.directoriesScanned=0,this.directoryDepth=0,this.maxDirectoryDepth=0,this.filesScanned=0,this.copyBookExts=0,this.fileCount=0,this.filesUptodate=0,this.programsDefined=0,this.entryPointsDefined=0,this.start=0,this.endTime=0,this.showMessage=!1}},t.COBSCANNER_STATUS="@@STATUS",t.COBSCANNER_SENDPRGID="@@SEND.PRGID",t.COBSCANNER_SENDEP="@@SEND.EP",t.COBSCANNER_SENDINTERFACE="@@SEND.INTID",t.COBSCANNER_SENDENUM="@@SEND.ENUMID",t.COBSCANNER_SENDCLASS="@@SEND.CLASSID",t.COBSCANNER_ADDFILE="@@SEND.FILES",t.COBSCANNER_KNOWNCOPYBOOK="@@SEND.KNOWNCOPYBOOK";class c{static save(e,t){const n=i.default.join(e,c.scanFilename);return r.default.writeFileSync(n,JSON.stringify(t,s)),n}static load(e){const t=r.default.readFileSync(e).toString();return JSON.parse(t)}static parseScanData(e){return JSON.parse(e,a)}static getScanData(e){return JSON.stringify(e,s)}static setupPercent(e,t,n){e.sendOnFileCount=t,e.sendPercent=n,e.sendOnCount=Math.round(e.sendOnFileCount*(e.sendPercent/100))}}t.ScanDataHelper=c,c.scanFilename="cobscanner.json"},8215:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.processCommentLine=void 0;const i=n(7549),r=n(7892),s=n(842),a=o(n(6560));function c(e,t,n,o){const r=t.lineAt(n).text;if(o===s.ESourceFormat.terminal){const t=r.indexOf("| ");if(-1!==t){const o=new i.Range(new i.Position(n,t),new i.Position(n,2+t));return void e.delete(o)}let o=-1;for(let e=0;e<r.length&&" "===r[e];e++)o++;return-1!==o?void e.insert(new i.Position(n,1+o),"| "):void 0}if(o===s.ESourceFormat.fixed){if(r.length>6&&"*"===r[6]){const t=new i.Range(new i.Position(n,6),new i.Position(n,7));e.replace(t," ")}else if(r.length>6&&" "===r[6]){const t=new i.Range(new i.Position(n,6),new i.Position(n,7));e.replace(t,"*")}}else{let t=r.indexOf("*> ");if(-1!==t&&6!==t){const o=new i.Range(new i.Position(n,t),new i.Position(n,3+t));return void e.delete(o)}if(t=r.indexOf("*>"),-1!==t){const o=new i.Range(new i.Position(n,t),new i.Position(n,2+t));return void e.delete(o)}let o=-1;for(let e=0;e<r.length&&" "===r[e];e++)o++;if(-1!==o)return 5===o&&"*"===r[6]?void e.insert(new i.Position(n,7),"> "):6===o||o>6&&" "===r[6]&&" "===r[7]&&" "===r[8]?void e.insert(new i.Position(n,6),"*>"):void e.insert(new i.Position(n,1+o),"*> ");if(r.length>6&&" "===r[6]&&" "===r[7]){const t=new i.Range(new i.Position(n,6),new i.Position(n,8));return void e.replace(t,"*>")}}}function l(e,t,n,o){for(let i=n.start.line;i<=n.end.line;i++)0===n.start.character&&c(e,t,i,o)}t.processCommentLine=function(){const e=i.window.activeTextEditor;if(e){const t=e.document,n=e.selections;let o=s.ESourceFormat.variable;const i=a.default.getCachedObject(t,r.VSCOBOLConfiguration.get());void 0!==i&&(o=i.sourceFormat),function(e,t,n,o){e.edit((e=>{for(let i=0;i<n.length;i++)if(n[i].start.line===n[i].end.line){const r=n[i].start;c(e,t,r.line,o)}else l(e,t,n[i],o)}))}(e,t,n,o)}}},7892:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.VSCOBOLConfiguration=void 0;const s=r(n(5622)),a=n(7549),c=n(7925),l=n(112),u=n(842);class d{static init(){const e=d.config;return e.enable_tabstop=h("enable_tabstop",!1),e.ignorecolumn_b_onwards=h("ignorecolumn_b_onwards",!1),e.copybooks_nested=h("copybooks_nested",!1),e.fuzzy_variable_search=h("fuzzy_variable_search",!1),e.outline=function(){const e=a.workspace.getConfiguration("coboleditor").get("outline");if(null==e)return c.outlineFlag.On;switch(e){case"on":return c.outlineFlag.On;case"off":return c.outlineFlag.Off;case"partial":return c.outlineFlag.Partial;case"skeleton":return c.outlineFlag.Skeleton}return c.outlineFlag.On}(),e.copybookdirs=function(e){let t=a.workspace.getConfiguration("coboleditor").get("copybookdirs");(!t||null!==t&&0===t.length)&&(t=f);const n=[];for(let o=0;o<t.length;o++){let i=t[o];if(i=m(i),i.startsWith("${workspaceFolder}")&&(i=i.replace("${workspaceFolder}","").trim(),(i.startsWith("/")||i.startsWith("\\"))&&(i=i.substr(1).trim())),0!==i.length)if(i.startsWith("$")){const t=process.env[i.substr(1)];null!=t?t.split(s.delimiter).forEach((function(t){null!=t&&t.length>0&&(l.isDirectory(t)?n.push(t):e.push(t))})):e.push(i)}else"."!==i&&n.push(i)}return n}(e.invalid_copybookdirs),e.pre_parse_line_limit=function(){let e=a.workspace.getConfiguration("coboleditor").get("pre_parse_line_limit");return null==e&&(e=25),e}(),e.copybookexts=function(){let e=a.workspace.getConfiguration("coboleditor").get("copybookexts");return(!e||null!==e&&0===e.length)&&(e=g),e.push(""),e}(),e.program_extensions=function(){let e=a.workspace.getConfiguration("coboleditor").get("program_extensions");return(!e||null!==e&&0===e.length)&&(e=C),e}(),e.tabstops=function(){let e=a.workspace.getConfiguration("coboleditor").get("tabstops");return(!e||null!==e&&0===e.length)&&(e=_),e}(),e.linter=h("linter",!1),e.line_comment=h("line_comment",!1),e.fileformat_strategy=function(){const e=a.workspace.getConfiguration("coboleditor").get("fileformat_strategy");return null==e?"normal":e}(),e.enable_data_provider=h("enable_data_provider",!0),e.disable_unc_copybooks_directories=h("disable_unc_copybooks_directories",!1),e.intellisense_include_unchanged=h("intellisense_include_unchanged",!0),e.intellisense_include_camelcase=h("intellisense_include_camelcase",!1),e.intellisense_include_uppercase=h("intellisense_include_uppercase",!1),e.intellisense_include_lowercase=h("intellisense_include_lowercase",!1),e.intellisense_item_limit=function(){let e=a.workspace.getConfiguration("coboleditor").get("intellisense_item_limit");return null==e&&(e=0),e}(),e.process_metadata_cache_on_start=h("process_metadata_cache_on_start",!1),e.cache_metadata=function(){let e=a.workspace.getConfiguration("coboleditor").get("cache_metadata");if(null==e)return u.CacheDirectoryStrategy.Off;if(e=e.toLowerCase(),"off"===e)return u.CacheDirectoryStrategy.Off;switch(e){case"workspace":return u.CacheDirectoryStrategy.Workspace;case"user_defined_directory":return u.CacheDirectoryStrategy.UserDefinedDirectory;case"off":return u.CacheDirectoryStrategy.Off}return u.CacheDirectoryStrategy.Off}(),e.cache_metadata_inactivity_timeout=p("cache_metadata_inactivity_timeout",5e3),e.cache_metadata_max_directory_scan_depth=p("cache_metadata_max_directory_scan_depth",32),e.cache_metadata_show_progress_messages=h("cache_metadata_show_progress_messages",!1),e.parse_copybooks_for_references=h("parse_copybooks_for_references",!1),e.workspacefolders_order=function(){let e=a.workspace.getConfiguration("coboleditor").get("workspacefolders_order");return(!e||null!==e&&0===e.length)&&(e=[]),e}(),e.linter_unused_paragraphs_or_sections=h("linter_unused_paragraphs_or_sections",!0),e.linter_house_standards=h("linter_house_standards",!0),e.linter_house_standards_rules=function(){let e=a.workspace.getConfiguration("coboleditor").get("linter_house_standards_rules");return(!e||null!==e&&0===e.length)&&(e=[]),e}(),e.linter_mark_as_information=h("linter_mark_as_information",!0),e.linter_ignore_section_before_entry=h("linter_ignore_section_before_entry",!0),e.linter_ignore_missing_copybook=h("linter_ignore_missing_copybook",!1),e.ignore_unsafe_extensions=h("ignore_unsafe_extensions",!1),e.coboldoc_workspace_folder=function(){const e=a.workspace.getConfiguration("coboleditor").get("coboldoc_workspace_folder");return null==e?"coboldoc":e}(),e.scan_comments_for_hints=h("scan_comments_for_hints",!1),e.scan_comment_copybook_token=function(){let e=a.workspace.getConfiguration("coboleditor").get("scan_comment_copybook_token");return null==e&&(e="source-dependency"),e}(),e.process_metadata_cache_on_file_save=h("process_metadata_cache_on_file_save",!1),e.cache_metadata_user_directory=function(e,t){let n=a.workspace.getConfiguration("coboleditor").get("cache_metadata_user_directory");return null==n&&(n=""),n}(),e.editor_maxTokenizationLineLength=a.workspace.getConfiguration("editor").get("maxTokenizationLineLength",2e4),e.sourceview=h("sourceview",!1),e.sourceview_include_jcl_files=h("sourceview_include_jcl_files",!0),e.sourceview_include_hlasm_files=h("sourceview_include_hlasm_files",!0),e.sourceview_include_pli_files=h("sourceview_include_pli_files",!0),e.sourceview_include_doc_files=h("sourceview_include_doc_files",!0),e.sourceview_include_script_files=h("sourceview_include_script_files",!0),e.sourceview_include_object_files=h("sourceview_include_object_files",!0),e.format_on_return=a.workspace.getConfiguration("coboleditor").get("format_on_return",c.formatOnReturn.Off),e.maintain_metadata_cache=h("maintain_metadata_cache",!0),e.maintain_metadata_cache_single_folder=h("maintain_metadata_cache_single_folder",!1),e.maintain_metadata_recursive_search=h("maintain_metadata_recursive_search",!1),e.metadata_symbols=function(e){if(!1===e.maintain_metadata_cache)return[];let t=a.workspace.getConfiguration("coboleditor").get("metadata_symbols");return(!t||null!==t&&0===t.length)&&(t=[]),t}(e),e.metadata_entrypoints=function(e){if(!1===e.maintain_metadata_cache)return[];let t=a.workspace.getConfiguration("coboleditor").get("metadata_entrypoints");return(!t||null!==t&&0===t.length)&&(t=[]),t}(e),e.metadata_types=function(e){if(!1===e.maintain_metadata_cache)return[];let t=a.workspace.getConfiguration("coboleditor").get("metadata_types");return(!t||null!==t&&0===t.length)&&(t=[]),t}(e),e.metadata_files=function(e){if(!1===e.maintain_metadata_cache)return[];let t=a.workspace.getConfiguration("coboleditor").get("metadata_files");return(!t||null!==t&&0===t.length)&&(t=[]),t}(e),e.metadata_knowncopybooks=function(e){if(!1===e.maintain_metadata_cache)return[];let t=a.workspace.getConfiguration("coboleditor").get("metadata_knowncopybooks");return(!t||null!==t&&0===t.length)&&(t=[]),t}(e),e.enable_semantic_token_provider=h("enable_semantic_token_provider",!1),e.enable_text_replacement=h("enable_text_replacement",!1),e.preprocessor_extensions=function(){let e=a.workspace.getConfiguration("coboleditor").get("preprocessor_extensions");return(!e||null!==e&&0===e.length)&&(e=[]),e}(),e}static get(){return d.config.init_required&&(d.init(),d.config.init_required=!1),d.config}static isDepreciatedDiskCachingEnabled(){return d.get().cache_metadata!==u.CacheDirectoryStrategy.Off}}function h(e,t){let n=a.workspace.getConfiguration("coboleditor").get(e);return null==n&&(n=t),n}function p(e,t){let n=a.workspace.getConfiguration("coboleditor").get(e);return null==n&&(n=t),n}t.VSCOBOLConfiguration=d,d.config=new c.COBOLSettings;const f=[];function m(e){let t=!1,n=e;for(;!1===t;){const e=n.indexOf("${env:");if(-1===e)t=!0;else{const t=n.indexOf("}")-(e+6),o=n.substr(6+e,t),i=n.substr(0,e),r=n.substr(1+n.indexOf("}"));n=i+process.env[o]+r}}return n}const g=["cpy","scr","CPY","SCR","cbl","CBL","ccp","dds","ss","wks"],C=["cob","COB","cbl","CBL","cobol","scbl","pco"],_=[0,7,11,15,19,23,27,31,35,39,43,47,51,55,59,63,67,71,75,79]},963:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COBOLDocumentationCommentHandler=void 0;const o=n(7549);t.COBOLDocumentationCommentHandler=class{static register(){return o.languages.registerOnTypeFormattingEditProvider([{scheme:"file",language:"COBOL"}],{provideOnTypeFormattingEdits(e,t,n,i,r){if("\n"!==n)return;const s=e.lineAt(t.line-1);if(s){const e=s.text.trim();if(e.length>3&&e.startsWith("*>>"))return[o.TextEdit.insert(t,"*>> ")]}return[]}},"\n")}}},112:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.performance_now=t.logChannelHide=t.logChannelSetPreserveFocus=t.logWarningMessage=t.logMessage=t.logTimedMessage=t.logTimeThreshold=t.logException=t.deactivate=t.deactivateAsync=t.activate=t.getCurrentContext=t.dumpPreProcInfo=t.isDirectory=t.getCombinedCopyBookSearchPath=t.currentHostInformation=t.ExternalFeatures=t.isKnownCOBOLLanguageId=t.getAllCobolSelectors=t.progressStatusBarItem=void 0;const c=r(n(5622)),l=r(n(5747)),u=r(n(7549)),d=a(n(2087)),h=n(7549),p=r(n(9898)),f=r(n(9450)),m=r(n(9811)),g=r(n(8215)),C=n(963),_=n(2462),b=n(9131),y=n(2557),v=n(7530),O=n(6825),w=a(n(9131)),S=n(6271),k=r(n(6560)),L=n(7892),T=n(7982),E=n(4155),I=n(3722),B=n(8040),P=n(8548),x=n(9115),D=a(n(1669)),R=n(627),F=n(3987),A=n(6232),M=n(2917),N=n(842),U=n(2465),j=n(5711),W=n(5945),V=n(4244),H=n(7118),G=n(8331),$=n(8202),K=n(1464),z=n(402),J=n(2124),Y=n(5363),q=n(3412);let Z;t.progressStatusBarItem=h.window.createStatusBarItem(h.StatusBarAlignment.Left);const X=h.window.createOutputChannel("COBOL");let Q,ee,te;function ne(e){return"COBOL"===e||"ACUCOBOL"===e||"COBOLIT"===e}function oe(){return ae}function ie(e){try{const t=l.statSync(e,{bigint:!0});if(t&&t.isDirectory())return!0}catch(e){return!1}return!1}t.getAllCobolSelectors=function(){return[{scheme:"file",language:"COBOL_MF_LISTFILE"},{scheme:"file",language:"COBOL"},{scheme:"file",language:"COBOLIT"},{scheme:"file",language:"ACUCOBOL"}]},t.isKnownCOBOLLanguageId=ne,t.ExternalFeatures=new U.VSExternalFeatures,t.currentHostInformation=`${d.default.hostname()}/${d.default.userInfo().username}`,t.getCombinedCopyBookSearchPath=oe,t.isDirectory=ie;let re,se,ae=[],ce=[];const le=["HCLTechnologies.hclappscancodesweep"],ue=[["debugger","OlegKunitsyn.gnucobol-debug"],["debugger","BroadcomMFD.debugger-for-mainframe"],["debugger","rechinformatica.rech-cobol-debugger"],["control flow extension","BroadcomMFD.ccf"]];function de(e,t){let n="";if(n+=`\nThe extension ${e.packageJSON.name} from ${e.packageJSON.publisher} has conflicting functionality\n`,0!==t.length)for(const e of t)n+=` Reason        : ${e}\n`;return void 0!==e.packageJSON.id&&(n+=` Id            : ${e.packageJSON.id}\n`,void 0!==e.packageJSON.description&&(n+=` Description   : ${e.packageJSON.description}\n`),void 0!==e.packageJSON.version&&(n+=` Version       : ${e.packageJSON.version}\n`),void 0!==e.packageJSON.repository&&void 0!==e.packageJSON.repository.url&&(n+=` Repository    : ${e.packageJSON.repository.url}\n`),void 0!==e.packageJSON.bugs&&void 0!==e.packageJSON.bugs.url&&(n+=` Bug Reporting : ${e.packageJSON.bugs.url}\n`),void 0!==e.packageJSON.bugs&&void 0!==e.packageJSON.bugs.email&&(n+=` Bug Email     : ${e.packageJSON.bugs.email}\n`),0!==n.length&&(n+="\n")),n}let he=!1;function pe(e,t){let n="";t&&(n=function(){let e="";for(const t of h.extensions.all){const n=[];let o=!1;if(void 0!==t&&void 0!==t.packageJSON){if(void 0!==t.packageJSON.id){if("bitlang.cobol"===t.packageJSON.id)continue;for(const e of le)e===t.packageJSON.id&&(o=!0);if(!o)for(const[e,o]of ue)o===t.packageJSON.id&&n.push(`contributes ${e} that does not match syntax provided`)}if(!o&&void 0!==t.packageJSON.contributes){const e=t.packageJSON.contributes.grammars;if(void 0!==e&&e instanceof Object)for(const t in e){const o=e[t];void 0!==o.language&&"COBOL"===`${o.language}`.toUpperCase()&&n.push("contributes conflicting grammar")}const o=t.packageJSON.contributes.languages;if(void 0!==o&&o instanceof Object)for(const e in o){const t=o[e];void 0!==t.id&&"COBOL"===`${t.id}`.toUpperCase()&&n.push("contributes language id")}}0!==n.length&&(e+=de(t,n))}}return e}(),0!==n.length&&Oe(n),0!==n.length&&!1===e.ignore_unsafe_extensions&&!1===he&&(he=!0,h.window.showInformationMessage("COBOL Extension has located duplicate or conflicting functionality",{modal:!0},"More information?").then((function(e){"More information?"===e&&Se(!1)})))),ae.length=0;const o=e.copybookdirs;ce=e.invalid_copybookdirs,ce.length=0;for(const t of o)if(e.disable_unc_copybooks_directories&&S.COBOLFileUtils.isNetworkPath(t))Oe(" Copybook directory "+t+" has been marked as invalid, as it is a unc filename"),ce.push(t);else if(S.COBOLFileUtils.isDirectPath(t)){we(` non portable copybook directory ${t} defined`),void 0!==h.workspace&&void 0!==R.getWorkspaceFolders()&&!1===q.VSCOBOLFileUtils.isPathInWorkspace(t)&&S.COBOLFileUtils.isNetworkPath(t)&&Oe(" The directory "+t+" for performance should be part of the workspace");const e=ke();if(ie(t)){const n=ke()-e,o=n.toFixed(2);n<=2e3?ae.push(t):(Oe(" Slow copybook directory dropped "+t+" as it took "+o+"ms"),ce.push(t))}else ce.push(t)}const i=R.getWorkspaceFolders();if(void 0!==i)for(const e of i){ae.push(e.uri.fsPath);for(const t of o)try{if(!1===S.COBOLFileUtils.isDirectPath(t)){const n=c.join(e.uri.fsPath,t);ie(n)?(S.COBOLFileUtils.isNetworkPath(n)&&!1===q.VSCOBOLFileUtils.isPathInWorkspace(n)&&Oe(" The directory "+n+" for performance should be part of the workspace"),ae.push(n)):ce.push(n)}}catch(e){ve("dir",e)}}ae=ae.filter(((e,t)=>ae.indexOf(e)===t)),ce=ce.filter(((e,t)=>ce.indexOf(e)===t))}function fe(e,t,n){n||(e?X.hide():Se(!0));const o=h.extensions.getExtension("bitlang.cobol");if(void 0!==o){"vscode"!==u.env.uriScheme?(Oe("----------------------------------------------------------------------"),Oe(`Warning: you are using a untested environment : ${u.env.uriScheme}`),Oe("----------------------------------------------------------------------"),Oe(`Version                                     : ${u.version}`)):Oe(`VSCode version                              : ${u.version}`),Oe(` Platform                                   : ${d.default.platform}`),Oe(` Architecture                               : ${d.default.arch}`),Oe("Extension Information:"),Oe(` Extension path                             : ${o.extensionPath}`),Oe(` Version                                    : ${o.packageJSON.version}`),Oe(` UNC paths disabled                         : ${t.disable_unc_copybooks_directories}`),Oe(` Parse copybook for references              : ${t.parse_copybooks_for_references}`),Oe(` Editor maxTokenizationLineLength           : ${t.editor_maxTokenizationLineLength}`),Oe(` Semantic token provider enabled            : ${t.enable_semantic_token_provider}`);try{Oe(` editor.semanticHighlighting.enabled        : ${h.workspace.getConfiguration("editor.semanticHighlighting").get("enabled")}`)}catch(e){}try{Oe(` [COBOL]editor.semanticHighlighting.enabled : ${h.workspace.getConfiguration("editor.semanticHighlighting",{languageId:"COBOL"}).get("enabled")}`)}catch(e){}try{Oe(` workbench color theme                      : ${h.workspace.getConfiguration("workbench").get("colorTheme")}`)}catch(e){}if(void 0!==u.workspace.workspaceFile&&Oe(` Active workspacefile                       : ${u.workspace.workspaceFile}`),L.VSCOBOLConfiguration.isDepreciatedDiskCachingEnabled()){Oe("----------------------------------------------------------------------"),Oe(" Deprecated Features settings"),Oe(""),Oe(" Caching"),Oe(`  Cache Strategy   : ${t.cache_metadata}`);const e=k.default.getDeprecatedCacheDirectory();void 0!==e&&Oe(`  Cache directory  : ${e}`),Oe("----------------------------------------------------------------------")}me(t)}if(pe(t,!0),void 0!==o){const e=R.getWorkspaceFolders();if(void 0!==e){Oe("  Workspace Folders:");for(const t of e)Oe("   => "+t.name+" @ "+t.uri.fsPath)}let t=oe();if(0!==t.length){Oe("  Combined Workspace and CopyBook Folders to search:");for(const e of t)Oe("   => "+e)}if(t=ce,0!==t.length){Oe("  Invalid CopyBook directories ("+t.length+")");for(const e of t)Oe("   => "+e)}Oe("")}}function me(e){for(const t of e.preprocessor_extensions)if($.COBOLPreprocessorHelper.preprocessorsExts.has(t)){const e=$.COBOLPreprocessorHelper.preprocessorsExts.get(t);void 0!==e&&(Oe(` Active preprocessor              : ${e.id}`),Oe(`                                  : ${e.description}`),Oe(`                                  : ${e.bugReportEmail}`),Oe(`                                  : ${e.bugReportUrl}`))}else Oe(""),Oe(` Registered preprocessor          : ${t}`),Oe("")}function ge(e){if(void 0!==e)if(L.VSCOBOLConfiguration.get().ignore_unsafe_extensions&&"cobol"===e.languageId)u.languages.setTextDocumentLanguage(e,"COBOL");else if(("plaintext"===e.languageId||"tsql"===e.languageId)&&e.lineCount>=3){const t=e.lineAt(0).text,n=e.lineAt(1).text;if(t.length>=1&&12===t.charCodeAt(0)&&n.startsWith("* Micro Focus COBOL "))return void u.languages.setTextDocumentLanguage(e,"COBOL_MF_LISTFILE");if(t.startsWith("Pro*COBOL: Release"))return void u.languages.setTextDocumentLanguage(e,"COBOL_PCOB_LISTFILE");if(-1!==t.indexOf("ACUCOBOL-GT ")&&-1!==t.indexOf("Page:"))return void u.languages.setTextDocumentLanguage(e,"COBOL_ACU_LISTFILE")}}function Ce(e,t){if(!1!==e.sourceview&&!t||void 0===Q||(null==ee||ee.dispose(),Q=void 0),e.sourceview&&void 0===Q)return Q=new I.SourceViewTree(e),ee=h.workspace.createFileSystemWatcher("**/*"),ee.onDidCreate((e=>{void 0!==Q&&Q.checkFile(e)})),ee.onDidDelete((e=>{void 0!==Q&&Q.clearFile(e)})),void h.window.registerTreeDataProvider("flat-source-view",Q)}function _e(e,t){void 0===se&&(se=u.window.createTerminal("COBOL Application"));let n="",o="",i="";void 0!==e&&void 0!==e.uri&&(i=e.uri.path),S.COBOLFileUtils.isWin32?i.endsWith("acu")?(n="wrun32",o=t?"-d ":""):(i.endsWith("int")||i.endsWith("gnt"))&&(n="cobrun",o=t?"(+A) ":""):i.endsWith("int")||i.endsWith("gnt")?n=t?"anim":"cobrun":i.endsWith("acu")&&(n="runcbl",o=t?"-d ":""),se.show(!0),se.sendText(`${n} ${o}${i}`)}t.dumpPreProcInfo=me,t.getCurrentContext=function(){return Z};let be=!1;function ye(){return s(this,void 0,void 0,(function*(){P.COBOLUtils.saveGlobalCacheToWorkspace(L.VSCOBOLConfiguration.get())}))}function ve(e,t){Oe(t.name+": "+e),void 0!==t&&void 0!==t.stack&&Oe(t.stack)}function Oe(e,...t){void 0===t&&null===t||0===t.length?X.appendLine(e):X.appendLine(D.default.format(e,t))}function we(e,...t){const n=e.length-e.trimLeft().length,o=" ".repeat(n);void 0===t&&null===t||0===t.length?X.appendLine(`${o}WARNING: ${e}`):X.appendLine(`${o}WARNING: ${D.default.format(e,t)}`)}function Se(e){X.show(e)}function ke(){if(!process.env.BROWSER)try{return n(75).performance.now}catch(e){return Date.now()}return Date.now()}t.activate=function(e){return s(this,void 0,void 0,(function*(){Z=e;const n=u.extensions.onDidChange((()=>{fe(!0,L.VSCOBOLConfiguration.init(),!1),Oe("extensions changed")}));e.subscriptions.push(n);const o=h.workspace.onDidChangeConfiguration((e=>{const n=e.affectsConfiguration("coboleditor"),o=e.affectsConfiguration("coboleditor.metadata_symbols"),i=e.affectsConfiguration("coboleditor.metadata_entrypoints"),r=e.affectsConfiguration("coboleditor.metadata_types"),s=e.affectsConfiguration("coboleditor.metadata_files"),a=e.affectsConfiguration("coboleditor.metadata_knowncopybooks"),c=e.affectsConfiguration("coboleditor.enable_semantic_token_provider"),l=e.affectsConfiguration("coboleditor.maintain_metadata_recursive_search");if(n){const e=L.VSCOBOLConfiguration.init();o||i||r||s||a||c||(k.clearCOBOLCache(),fe(!0,e,!0),Ce(e,!0)),o&&G.COBOLWorkspaceSymbolCacheHelper.loadGlobalCacheFromArray(e,e.metadata_symbols,!0),i&&G.COBOLWorkspaceSymbolCacheHelper.loadGlobalEntryCacheFromArray(e,e.metadata_entrypoints,!0),r&&G.COBOLWorkspaceSymbolCacheHelper.loadGlobalTypesCacheFromArray(e,e.metadata_types,!0),s&&G.COBOLWorkspaceSymbolCacheHelper.loadFileCacheFromArray(e,t.ExternalFeatures,e.metadata_files,!0),c&&!be&&(be=!0,u.window.showInformationMessage("The configuration setting 'coboleditor.enable_semantic_token_provider' has changed but you may not see the affects until you have either close/reload your documents or restarted this session")),a&&G.COBOLWorkspaceSymbolCacheHelper.loadGlobalKnownCopybooksFromArray(e,e.metadata_knowncopybooks,!0),l&&P.COBOLUtils.populateDefaultCallableSymbolsSync(e,!0)}}));e.subscriptions.push(o);const i=L.VSCOBOLConfiguration.init(),r=h.languages.createDiagnosticCollection("cobolDiag"),a=new E.CobolLinterProvider(r,L.VSCOBOLConfiguration.get()),l=new E.CobolLinterActionFixer;pe(i,!1),fe(!0,i,!1),G.COBOLWorkspaceSymbolCacheHelper.loadGlobalCacheFromArray(i,i.metadata_symbols,!1),G.COBOLWorkspaceSymbolCacheHelper.loadGlobalEntryCacheFromArray(i,i.metadata_entrypoints,!1),G.COBOLWorkspaceSymbolCacheHelper.loadGlobalTypesCacheFromArray(i,i.metadata_types,!1),G.COBOLWorkspaceSymbolCacheHelper.loadFileCacheFromArray(i,t.ExternalFeatures,i.metadata_files,!1),G.COBOLWorkspaceSymbolCacheHelper.loadGlobalKnownCopybooksFromArray(i,i.metadata_knowncopybooks,!1);const I=h.commands.registerCommand("cobolplugin.insertIgnoreCommentLine",(function(e,t,n){l.insertIgnoreCommentLine(e,t,n)})),D=h.commands.registerCommand("cobolplugin.move2pd",(function(){p.move2pd()})),U=h.commands.registerCommand("cobolplugin.move2dd",(function(){p.move2dd()})),$=h.commands.registerCommand("cobolplugin.move2ws",(function(){p.move2ws()})),q=h.commands.registerCommand("cobolplugin.move2anyforward",(function(){p.move2anyforward()})),X=h.commands.registerCommand("cobolplugin.move2anybackwards",(function(){p.move2anybackwards()})),Q=h.commands.registerCommand("cobolplugin.tab",(function(){i.enable_tabstop?f.processTabKey(!0):h.commands.executeCommand("tab")})),ee=h.commands.registerCommand("cobolplugin.revtab",(function(){i.enable_tabstop?f.processTabKey(!1):h.commands.executeCommand("outdent")})),oe=h.commands.registerCommand("cobolplugin.commentline",(function(){void 0===h.window.activeTextEditor?h.commands.executeCommand("editor.action.commentLine"):ne(h.window.activeTextEditor.document.languageId)&&(i.line_comment?g.processCommentLine():h.commands.executeCommand("editor.action.commentLine"))})),ie=h.commands.registerCommand("cobolplugin.change_source_format",(function(){const e="Open Settings";h.window.showWarningMessage("Change coboleditor setting?",e).then((t=>{if(e===t){null==h.workspace.workspaceFile?h.commands.executeCommand("workbench.action.openGlobalSettings"):h.commands.executeCommand("workbench.action.openWorkspaceSettings")}}))})),se=h.commands.registerCommand("cobolplugin.change_lang_to_acu",(function(){const e=h.window.activeTextEditor;null!=e&&h.languages.setTextDocumentLanguage(e.document,"ACUCOBOL")})),ae=h.commands.registerCommand("cobolplugin.change_lang_to_cobol",(function(){const e=h.window.activeTextEditor;null!=e&&h.languages.setTextDocumentLanguage(e.document,"COBOL")})),ce=h.commands.registerCommand("cobolplugin.toggle_margin",(function(){const e=h.window.activeTextEditor;null!=e&&(b.enableMarginCobolMargin(!b.isEnabledViaWorkspace4cobol()),w.default(e))})),le=h.commands.registerCommand("cobolplugin.checkWorkspaceForMissingCopybookDirs",(()=>s(this,void 0,void 0,(function*(){yield k.default.checkWorkspaceForMissingCopybookDirs()})))),ue=h.commands.registerCommand("cobolplugin.deprecated.processAllFilesInWorkspace",(()=>s(this,void 0,void 0,(function*(){yield J.VSCobScanner_depreciated.deprecated_processAllFilesInWorkspaceOutOfProcess(!0)})))),de=h.commands.registerCommand("cobolplugin.processAllFilesInWorkspace",(()=>s(this,void 0,void 0,(function*(){Y.InMemoryGlobalSymbolCache.defaultCallableSymbols.size<500?j.VSCobScanner.processAllFilesInWorkspaceOutOfProcess(!0,!1,-1):h.window.showQuickPick(["Yes","No"],{placeHolder:"Your workspace is large, do you want to extra threads for your metadata scan?"}).then((function(e){if("Yes"===e){const e=d.default.cpus().length,t=e>=4?e/2:e;u.window.showInputBox({prompt:"How many threads do you want to use?",value:""+t,validateInput:e=>{const n=Number.parseInt(e,10);return n<2||n>3*t?"Thread count must be between 2 and "+3*t:void 0}}).then((e=>{if(void 0===e)return;const t=Number.parseInt(e,10);j.VSCobScanner.processAllFilesInWorkspaceOutOfProcess(!0,!0,t)}))}else j.VSCobScanner.processAllFilesInWorkspaceOutOfProcess(!0,!1,-1)}))})))),he=h.commands.registerCommand("cobolplugin.deprecated.dumpMetaData",(function(){const e=k.default.getDeprecatedCacheDirectory();void 0!==e?F.COBOLSourceScannerUtils.dumpMetaData(i,e):Oe("Metadata caching is turned off (or invalid)")})),me=h.commands.registerCommand("cobolplugin.deprecated.clearMetaData",(function(){const e=k.default.getDeprecatedCacheDirectory();void 0!==e?k.default.deprecatedClearMetaData(i,e):Oe("Metadata caching is turned off (or invalid)")})),ye=h.commands.registerCommand("cobolplugin.clearGlobalCache",(function(){h.window.showQuickPick(["Yes","No"],{placeHolder:"Are you sure you want to clear the metadata?"}).then((function(e){"Yes"===e&&(P.COBOLUtils.clearGlobalCache(),Oe("Metadata cache cleared"))}))}));e.subscriptions.push(ye);const ve=h.workspace.onDidChangeWorkspaceFolders((()=>s(this,void 0,void 0,(function*(){fe(!1,L.VSCOBOLConfiguration.init(),!0)}))));e.subscriptions.push(ve);const we=h.workspace.onDidOpenTextDocument((e=>s(this,void 0,void 0,(function*(){ge(e),void 0!==R.getWorkspaceFolders()&&b.isSupportedLanguage(e)&&(yield P.COBOLUtils.populateDefaultCallableSymbols(i,!1))}))));e.subscriptions.push(we);for(let e=0;e<h.workspace.textDocuments.length;e++)ge(h.workspace.textDocuments[e]);Ce(L.VSCOBOLConfiguration.get(),!1);const ke=h.workspace.onDidSaveTextDocument((e=>s(this,void 0,void 0,(function*(){i.process_metadata_cache_on_file_save&&(yield J.VSCobScanner_depreciated.depreciatedProcessSavedFile(e.uri.fsPath,i))}))));e.subscriptions.push(ke),e.subscriptions.push(D),e.subscriptions.push(U),e.subscriptions.push($),e.subscriptions.push(q),e.subscriptions.push(X),e.subscriptions.push(Q),e.subscriptions.push(ee),e.subscriptions.push(oe),e.subscriptions.push(ie),e.subscriptions.push(se),e.subscriptions.push(ae),e.subscriptions.push(ce),e.subscriptions.push(le),e.subscriptions.push(ue),e.subscriptions.push(de),e.subscriptions.push(he),e.subscriptions.push(me),e.subscriptions.push(C.COBOLDocumentationCommentHandler.register()),e.subscriptions.push(V.COBOLCaseFormatter.register()),e.subscriptions.push(I);const Le=h.languages.registerDefinitionProvider([{scheme:"file",language:"COBOL_MF_LISTFILE"},{scheme:"file",language:"COBOL"},{scheme:"file",language:"COBOLIT"},{scheme:"file",language:"ACUCOBOL"}],{provideDefinition:(e,t,n)=>(new m.COBOLCopyBookProvider).provideDefinition(e,t,n)});e.subscriptions.push(Le);const Te=h.languages.registerDefinitionProvider([{scheme:"file",language:"COBOL_MF_LISTFILE"},{scheme:"file",language:"COBOL"},{scheme:"file",language:"COBOLIT"},{scheme:"file",language:"ACUCOBOL"}],{provideDefinition:(e,t,n)=>(new A.COBOLSourceDefinition).provideDefinition(e,t,n)});if(e.subscriptions.push(Te),L.VSCOBOLConfiguration.isDepreciatedDiskCachingEnabled()){const t=h.languages.registerDefinitionProvider([{scheme:"file",language:"COBOL_MF_LISTFILE"},{scheme:"file",language:"COBOL"},{scheme:"file",language:"COBOLIT"},{scheme:"file",language:"ACUCOBOL"}],{provideDefinition:(e,t,n)=>(new M.CachedCOBOLSourceDefinition).provideDefinition(e,t,n)});e.subscriptions.push(t)}const Ee=h.languages.registerDefinitionProvider([{scheme:"file",language:"COBOL_MF_LISTFILE"},{scheme:"file",language:"COBOL"},{scheme:"file",language:"COBOLIT"},{scheme:"file",language:"ACUCOBOL"}],{provideDefinition:(e,t,n)=>(new H.COBOLCallTargetProvider).provideDefinition(e,t,n)});e.subscriptions.push(Ee),e.subscriptions.push(h.languages.registerReferenceProvider([{scheme:"file",language:"COBOL_MF_LISTFILE"},{scheme:"file",language:"COBOL"},{scheme:"file",language:"COBOLIT"},{scheme:"file",language:"ACUCOBOL"}],new T.CobolReferenceProvider)),e.subscriptions.push(h.languages.registerCodeActionsProvider([{scheme:"file",language:"COBOL_MF_LISTFILE"},{scheme:"file",language:"COBOL"},{scheme:"file",language:"COBOLIT"},{scheme:"file",language:"ACUCOBOL"}],l));const Ie=[{scheme:"file",language:"JCL"}],Be=new _.KeywordAutocompleteCompletionItemProvider(y.jclStatements,!1),Pe=h.languages.registerCompletionItemProvider(Ie,Be);e.subscriptions.push(Pe);const xe=v.cobolKeywords.concat(v.cobolStorageKeywords).concat(v.cobolRegisters).concat(v.cobolProcedureKeywords).concat(v.acuKeywords),De=[...new Set(xe)],Re=new _.KeywordAutocompleteCompletionItemProvider(De,!0),Fe=h.languages.registerCompletionItemProvider([{scheme:"file",language:"COBOL_MF_LISTFILE"},{scheme:"file",language:"COBOL"},{scheme:"file",language:"COBOLIT"},{scheme:"file",language:"ACUCOBOL"}],Re);if(e.subscriptions.push(Fe),i.outline){const t=new O.JCLDocumentSymbolProvider;e.subscriptions.push(h.languages.registerDocumentSymbolProvider(Ie,t));const n=new O.CobolDocumentSymbolProvider;e.subscriptions.push(h.languages.registerDocumentSymbolProvider([{scheme:"file",language:"COBOL_MF_LISTFILE"},{scheme:"file",language:"COBOL"},{scheme:"file",language:"COBOLIT"},{scheme:"file",language:"ACUCOBOL"}],n))}const Ae=new B.CobolSourceCompletionItemProvider(L.VSCOBOLConfiguration.get()),Me=h.languages.registerCompletionItemProvider([{scheme:"file",language:"COBOL_MF_LISTFILE"},{scheme:"file",language:"COBOL"},{scheme:"file",language:"COBOLIT"},{scheme:"file",language:"ACUCOBOL"}],Ae);e.subscriptions.push(Me),h.window.onDidChangeActiveTextEditor((e=>{e&&(w.default(e),a.updateLinter(e.document))}),null,e.subscriptions),h.window.onDidChangeTextEditorSelection((e=>{e.textEditor&&w.default(e.textEditor)}),null,e.subscriptions),h.workspace.onDidChangeTextDocument((e=>{h.window.activeTextEditor&&(w.default(h.window.activeTextEditor),a.updateLinter(h.window.activeTextEditor.document))}),null,e.subscriptions),t.progressStatusBarItem.command="cobolplugin.showCOBOLChannel",t.progressStatusBarItem.hide(),e.subscriptions.push(t.progressStatusBarItem),void 0!==h.window.activeTextEditor&&(w.default(h.window.activeTextEditor),a.updateLinter(h.window.activeTextEditor.document));const Ne=u.commands.registerCommand("cobolplugin.mfurunMenu",(function(e){void 0===re&&(re=u.window.createTerminal("UnitTest")),re.show(!0);const t=P.COBOLUtils.getMFUnitAnsiColorConfig(),n=x(e.fsPath).get("global.preferred-runner");re.sendText(n+" -show-progress "+(t?" -dc:ansi ":" ")+e.fsPath)}));e.subscriptions.push(Ne);const Ue=u.commands.registerCommand("cobolplugin.runDebugCommand",(function(e){void 0!==e&&_e(e,!0)}));e.subscriptions.push(Ue);const je=u.commands.registerCommand("cobolplugin.runCommand",(function(e){void 0!==e&&_e(e,!1)}));e.subscriptions.push(je);const We=u.commands.registerCommand("cobolplugin.removeAllComments",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.RemoveComments(u.window.activeTextEditor)}));e.subscriptions.push(We);const Ve=u.commands.registerCommand("cobolplugin.removeIdentificationArea",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.RemoveIdentificationArea(u.window.activeTextEditor)}));e.subscriptions.push(Ve);const He=u.commands.registerCommand("cobolplugin.removeColumnNumbers",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.removeColumnNumbers(u.window.activeTextEditor)}));e.subscriptions.push(He);const Ge=u.commands.registerCommand("cobolplugin.makeKeywordsLowercase",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.foldToken(u.window.activeTextEditor,P.FoldAction.Keywords,P.FoldStyle.LowerCase)}));e.subscriptions.push(Ge);const $e=u.commands.registerCommand("cobolplugin.makeKeywordsUppercase",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.foldToken(u.window.activeTextEditor,P.FoldAction.Keywords,P.FoldStyle.UpperCase)}));e.subscriptions.push($e);const Ke=u.commands.registerCommand("cobolplugin.makeKeywordsCamelCase",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.foldToken(u.window.activeTextEditor,P.FoldAction.Keywords,P.FoldStyle.CamelCase)}));e.subscriptions.push(Ke);const ze=u.commands.registerCommand("cobolplugin.makeFieldsLowercase",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.foldToken(u.window.activeTextEditor,P.FoldAction.ConstantsOrVariables,P.FoldStyle.UpperCase)}));e.subscriptions.push(ze);const Je=u.commands.registerCommand("cobolplugin.makeFieldsUppercase",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.foldToken(u.window.activeTextEditor,P.FoldAction.ConstantsOrVariables,P.FoldStyle.UpperCase)}));e.subscriptions.push(Je);const Ye=u.commands.registerCommand("cobolplugin.makeFieldsCamelCase",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.foldToken(u.window.activeTextEditor,P.FoldAction.ConstantsOrVariables,P.FoldStyle.CamelCase)}));e.subscriptions.push(Ye);const qe=u.commands.registerCommand("cobolplugin.makePerformTargetsLowerCase",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.foldToken(u.window.activeTextEditor,P.FoldAction.PerformTargets,P.FoldStyle.LowerCase)}));e.subscriptions.push(qe);const Ze=u.commands.registerCommand("cobolplugin.makePerformTargetsUpperCase",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.foldToken(u.window.activeTextEditor,P.FoldAction.PerformTargets,P.FoldStyle.UpperCase)}));e.subscriptions.push(Ze);const Xe=u.commands.registerCommand("cobolplugin.makePerformTargetsCamelCase",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.foldToken(u.window.activeTextEditor,P.FoldAction.PerformTargets,P.FoldStyle.CamelCase)}));e.subscriptions.push(Xe);const Qe=u.commands.registerCommand("cobolplugin.extractSelectionToParagraph",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.extractSelectionTo(u.window.activeTextEditor,!0)}));e.subscriptions.push(Qe);const et=u.commands.registerCommand("cobolplugin.extractSelectionToSection",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.extractSelectionTo(u.window.activeTextEditor,!1)}));e.subscriptions.push(et);const tt=u.commands.registerCommand("cobolplugin.extractSelectionToCopybook",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&P.COBOLUtils.extractSelectionToCopybook(u.window.activeTextEditor)}));e.subscriptions.push(tt);const nt=u.commands.registerCommand("cobolplugin.migrateCopybooksToWorkspace",(()=>{P.COBOLUtils.migrateCopybooksToWorkspace()}));e.subscriptions.push(nt);const ot=u.commands.registerCommand("cobolplugin.showCOBOLChannel",(()=>{Se(!0)}));e.subscriptions.push(ot);const it=u.commands.registerCommand("cobolplugin.resequenceColumnNumbers",(()=>{u.window.activeTextEditor&&ne(u.window.activeTextEditor.document.languageId)&&u.window.showInputBox({prompt:"Enter start line number and increment",validateInput:e=>e&&-1!==e.indexOf(" ")?void 0:"You must enter two numbers"}).then((e=>{if(void 0===e)return;const t=e.split(" "),n=Number.parseInt(t[0],10),o=Number.parseInt(t[1],10);n>=0&&o>=1?P.COBOLUtils.resequenceColumnNumbers(u.window.activeTextEditor,n,o):u.window.showErrorMessage("Sorry invalid re-sequence given")}))}));e.subscriptions.push(it),te=u.tasks.registerTaskProvider(W.BldScriptTaskProvider.BldScriptType,new W.BldScriptTaskProvider),e.subscriptions.push(te);const rt=K.VSSemanticProvider.provider();u.languages.registerDocumentSemanticTokensProvider([{scheme:"file",language:"COBOL_MF_LISTFILE"},{scheme:"file",language:"COBOL"},{scheme:"file",language:"COBOLIT"},{scheme:"file",language:"ACUCOBOL"}],rt,K.VSSemanticProvider.getLegend());const st=h.commands.registerCommand("coboleditor.ppcodelenaction",(e=>{z.VSPPCodeLens.actionCodeLens(e)}));e.subscriptions.push(st);const at=new z.VSPPCodeLens;h.languages.registerCodeLensProvider([{scheme:"file",language:"COBOL_MF_LISTFILE"},{scheme:"file",language:"COBOL"},{scheme:"file",language:"COBOLIT"},{scheme:"file",language:"ACUCOBOL"}],at),i.maintain_metadata_cache&&i.cache_metadata!==N.CacheDirectoryStrategy.Off&&void 0!==R.getWorkspaceFolders()&&(u.workspace.getConfiguration("coboleditor").update("cache_metadata",!1,!1),P.COBOLUtils.clearGlobalCache(),Oe("WARNING: Both coboleditor.maintain_metadata_cache and the depreciated coboleditor.cache_metadata are active"),Oe("         cache_metadata turned off, please review settings")),i.process_metadata_cache_on_start&&(!1==(i.cache_metadata!==N.CacheDirectoryStrategy.Off)?j.VSCobScanner.processAllFilesInWorkspaceOutOfProcess(!1,!1,-1):J.VSCobScanner_depreciated.deprecated_processAllFilesInWorkspaceOutOfProcess(!1)).then((()=>{})),function(){const e=h.extensions.getExtension("bitlang.cobol");if(void 0!==e){const t=`${e.extensionPath}`,n=`${e.packageJSON.version}`;if(Z.globalState.get("bitlang.cobol.version")!==n){const e=c.join(t,`CHANGELOG_${n}.md`);if(S.COBOLFileUtils.isFile(e)){const t=u.Uri.file(e);h.commands.executeCommand("markdown.showPreview",t,h.ViewColumn.One,{locked:!0}),Z.globalState.update("bitlang.cobol.version",n)}}}}()}))},t.deactivateAsync=ye,t.deactivate=function(){return s(this,void 0,void 0,(function*(){F.COBOLSourceScannerUtils.cleanup(),te&&te.dispose(),yield ye()}))},t.logException=ve,t.logTimeThreshold=500,t.logTimedMessage=function(e,n,...o){const i=" ("+e.toFixed(2)+"ms)";if(e<t.logTimeThreshold)return!1;if(void 0===o&&null===o||0===o.length)X.appendLine(n.padEnd(60)+i);else{const e=D.default.format(n,o);X.appendLine(e.padEnd(60)+i)}return!0},t.logMessage=Oe,t.logWarningMessage=we,t.logChannelSetPreserveFocus=Se,t.logChannelHide=function(){X.hide()},t.performance_now=ke},842:(e,t)=>{"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyExternalFeature=t.CobolLinterProviderSymbols=t.CacheDirectoryStrategy=t.ESourceFormat=void 0,function(e){e.unknown="unknown",e.fixed="fixed",e.free="free",e.terminal="terminal",e.variable="variable",e.jcl="jcl"}(n=t.ESourceFormat||(t.ESourceFormat={})),(o=t.CacheDirectoryStrategy||(t.CacheDirectoryStrategy={})).Workspace="workspace",o.UserDefinedDirectory="user_defined_directory",o.Off="off";class i{}t.CobolLinterProviderSymbols=i,i.NotReferencedMarker_internal="COBOL_NOT_REF",i.NotReferencedMarker_external="ignore";class r{logMessage(e){}logException(e,t){}logTimedMessage(e,t,...n){return!1}performance_now(){return Date.now()}expandLogicalCopyBookToFilenameOrEmpty(e,t,n){return""}getCOBOLSourceFormat(e,t){return n.unknown}getFullWorkspaceFilename(e,t){}setWorkspaceFolders(e){}getWorkspaceFolders(){return[]}}t.EmptyExternalFeature=r,r.Default=new r},924:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FileSourceHandler=void 0;const i=o(n(5747)),r=n(7530),s=n(3320),a=n(842),c=n(8835),l=o(n(5622));class u{constructor(e,t,n,o){this.document=e,this.dumpNumbersInAreaA=t,this.commentCallback=n,this.dumpAreaBOnwards=!1,this.lines=[],this.commentCount=0,this.isSourceInWorkspace=!1,this.updatedSource=new Map,void 0===o&&(o=a.EmptyExternalFeature.Default),this.shortFilename=this.findShortWorkspaceFilename(e,o);const r=i.default.statSync(e,{bigint:!0}),c=r.size<4096?4096:98304;let l;this.documentVersionId=r.mtimeMs;const u=o.performance_now();try{const t=new s(e,{readChunk:c});for(;l=t.next();)this.lines.push(l.toString());o.logTimedMessage(o.performance_now()-u," - Loading File "+e)}catch(t){o.logException("File failed! ("+e+")",t)}}getDocumentVersionId(){return this.documentVersionId}sendCommentCallback(e,t){void 0!==this.commentCallback&&this.commentCallback.processComment(e,this.getFilename(),t)}getUriAsString(){return c.pathToFileURL(this.getFilename()).href}getLineCount(){return this.lines.length}getCommentCount(){return this.commentCount}getLine(e,t){let n;try{if(e>=this.lines.length)return;if(n=this.lines[e],t)return n;const o=n.indexOf("*>");if(-1!==o&&(this.sendCommentCallback(n,e),n=n.substring(0,o),this.commentCount++),n.length>1&&"*"===n[0])return this.commentCount++,this.sendCommentCallback(n,e),"";if(n.length>7&&"*"===n[6])return this.commentCount++,this.sendCommentCallback(n,e),"";if(this.dumpNumbersInAreaA)if(n.match(u.paraPrefixRegex1))n="      "+n.substr(6);else if(n.length>7&&" "===n[6]){const e=n.substr(0,6).trim();!1===this.isValidKeyword(e)&&(n="       "+n.substr(6))}this.dumpAreaBOnwards&&n.length>=73&&(n=n.substr(0,72))}catch(e){return}return n}setDumpAreaA(e){this.dumpNumbersInAreaA=e}setDumpAreaBOnwards(e){this.dumpAreaBOnwards=e}isValidKeyword(e){return r.cobolKeywordDictionary.has(e)}getFilename(){return this.document}setCommentCallback(e){this.commentCallback=e}resetCommentCount(){this.commentCount=0}getIsSourceInWorkSpace(){return this.isSourceInWorkspace}getShortWorkspaceFilename(){return this.shortFilename}getUpdatedLine(e){return this.updatedSource.has(e)?this.updatedSource.get(e):this.getLine(e,!1)}setUpdatedLine(e,t){this.updatedSource.set(e,t)}findShortWorkspaceFilename(e,t){const n=t.getWorkspaceFolders();if(void 0===n||0===n.length)return"";const o=l.default.normalize(e);let i="";for(const e of n)if(o.startsWith(e)){const t=o.substr(1+e.length);(0===i.length||t.length<t.length)&&(i=t)}return i}}t.FileSourceHandler=u,u.paraPrefixRegex1=/^[0-9 ][0-9 ][0-9 ][0-9 ][0-9 ][0-9 ]/g},6271:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.COBOLFileUtils=void 0;const s=r(n(5747));class a{static isFileT(e){try{if(s.existsSync(e)){const t=s.statSync(e,{bigint:!0});if(t&&t.isFile())return[!0,t]}}catch(e){return[!1,void 0]}return[!1,void 0]}static isFile(e){try{if(s.existsSync(e))return!0}catch(e){return!1}return!1}static isValidCopybookExtension(e,t){const n=e.lastIndexOf(".");let o=e;-1!==n&&(o=e.substr(1+n));const i=t.copybookexts;for(let e=0;e<i.length;e++)if(i[e]===o)return!0;return!1}static isValidProgramExtension(e,t){const n=e.lastIndexOf(".");let o="";-1!==n&&(o=e.substr(1+n));const i=t.program_extensions;for(let e=0;e<i.length;e++)if(i[e]===o)return!0;return!1}static isDirectPath(e){return(void 0!==e||null!==e)&&(a.isWin32?e.length>2&&":"===e[1]||e.length>1&&"\\"===e[0]:e.length>1&&"/"===e[0])}static isNetworkPath(e){return(void 0!==e||null!==e)&&!!(a.isWin32&&e.length>1&&"\\"===e[0])}}t.COBOLFileUtils=a,a.isWin32="win32"===process.platform},5363:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryGlobalCacheHelper=t.InMemoryGlobalSymbolCache=void 0;const s=r(n(5622)),a=n(4669),c=n(6271);t.InMemoryGlobalSymbolCache=new a.COBOLGlobalSymbolTable;class l{static(e){const t=s.join(e,l.globalSymbolFilename);return!!c.COBOLFileUtils.isFileT(t)[0]}static getFilenameWithoutPath(e){const t=e.lastIndexOf(s.sep);return-1===t?e:e.substr(1+t)}static addFilename(e,n){t.InMemoryGlobalSymbolCache.sourceFilenameModified.has(e)?(t.InMemoryGlobalSymbolCache.sourceFilenameModified.delete(e),t.InMemoryGlobalSymbolCache.sourceFilenameModified.set(e,n)):t.InMemoryGlobalSymbolCache.sourceFilenameModified.set(e,n),t.InMemoryGlobalSymbolCache.isDirty=!0}static getSourceFilenameModifiedTable(){const e=[];for(const[n,o]of t.InMemoryGlobalSymbolCache.sourceFilenameModified)e.push(`${n},${o}`);return e}}t.InMemoryGlobalCacheHelper=l,l.globalSymbolFilename="globalsymbols.sym"},7925:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.COBOLSettings=t.formatOnReturn=t.outlineFlag=void 0;const o=n(842);var i,r;!function(e){e.On="on",e.Off="off",e.Partial="partial",e.Skeleton="skeleton"}(i=t.outlineFlag||(t.outlineFlag={})),function(e){e.Off="off",e.CamelCase="camelcase",e.UpperCase="uppercase"}(r=t.formatOnReturn||(t.formatOnReturn={})),t.COBOLSettings=class{constructor(){this.init_required=!0,this.enable_tabstop=!0,this.pre_parse_line_limit=25,this.ignorecolumn_b_onwards=!1,this.copybooks_nested=!1,this.fuzzy_variable_search=!1,this.fileformat_strategy="normal",this.outline=i.Off,this.copybookdirs=[],this.copybookexts=[],this.program_extensions=[],this.invalid_copybookdirs=[],this.tabstops=[],this.linter=!1,this.line_comment=!1,this.enable_data_provider=!0,this.disable_unc_copybooks_directories=!1,this.intellisense_include_unchanged=!0,this.intellisense_include_camelcase=!1,this.intellisense_include_uppercase=!1,this.intellisense_include_lowercase=!1,this.intellisense_item_limit=30,this.process_metadata_cache_on_start=!1,this.cache_metadata=o.CacheDirectoryStrategy.Off,this.cache_metadata_inactivity_timeout=5e3,this.cache_metadata_max_directory_scan_depth=32,this.cache_metadata_show_progress_messages=!1,this.parse_copybooks_for_references=!1,this.workspacefolders_order=[],this.linter_mark_as_information=!1,this.linter_unused_paragraphs_or_sections=!0,this.linter_house_standards=!0,this.linter_house_standards_rules=[],this.linter_ignore_missing_copybook=!1,this.ignore_unsafe_extensions=!1,this.scan_comments_for_hints=!1,this.scan_comment_copybook_token="source-dependency",this.coboldoc_workspace_folder="coboldoc",this.process_metadata_cache_on_file_save=!1,this.cache_metadata_user_directory="",this.editor_maxTokenizationLineLength=2e4,this.sourceview=!1,this.sourceview_include_jcl_files=!0,this.sourceview_include_hlasm_files=!0,this.sourceview_include_pli_files=!0,this.sourceview_include_doc_files=!0,this.sourceview_include_script_files=!0,this.sourceview_include_object_files=!0,this.linter_ignore_section_before_entry=!0,this.format_on_return=r.Off,this.format_constants_to_uppercase=!0,this.metadata_symbols=[],this.metadata_entrypoints=[],this.metadata_types=[],this.preprocessor_extensions=[],this.metadata_files=[],this.metadata_knowncopybooks=[],this.maintain_metadata_cache=!0,this.maintain_metadata_cache_single_folder=!1,this.maintain_metadata_recursive_search=!1,this.enable_semantic_token_provider=!1,this.enable_text_replacement=!1}}},2462:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.KeywordAutocompleteCompletionItemProvider=void 0;const i=o(n(7337)),r=n(7549),s=n(8202),a=n(7892);t.KeywordAutocompleteCompletionItemProvider=class{constructor(e,t){this.words=new i.default("key");let n=0;this.isCOBOL=t,this.words.addAll(e.map((e=>({key:e,index:++n}))))}getKeywordsGivenPartialWord(e,t){const n=a.VSCOBOLConfiguration.get(),o=this.words.get(e),i=n.intellisense_include_camelcase,c=n.intellisense_include_uppercase,l=n.intellisense_include_lowercase,u=n.intellisense_include_unchanged;o.sort(((e,t)=>e.index-t.index));const d=[];for(const[,e]of o.entries()){const n=[],o=e.key;u&&n.push(o),this.isCOBOL&&i&&n.push(s.camelize(o)),c&&n.push(o.toUpperCase()),l&&n.push(o.toLowerCase());const a=n.filter((function(e,t,n){return t===n.indexOf(e)}));for(const e of a)d.push(new r.CompletionItem(e,r.CompletionItemKind.Keyword));if(d.length>=t)return d}return d}provideCompletionItems(e,t,n,o){let i="",s="";const a=e.getWordRangeAtPosition(t);if(a&&(i=e.getText(new r.Range(a.start,t)),s=e.getText(new r.Range(new r.Position(a.start.line,0),new r.Position(t.line,t.character-i.length))).trim()),this.isCOBOL){let e=!1;if(-1!==s.indexOf("*>")&&(e=!0),s.length>7&&"*"===s[6]&&(e=!0),e)return[]}return this.getKeywordsGivenPartialWord(i,128)}}},7530:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cobolRegistersDictionary=t.cobolStorageKeywordDictionary=t.cobolProcedureKeywordDictionary=t.cobolKeywordDictionary=t.cobolCBLApis=t.cobolProcedureKeywords=t.cobolRegisters=t.cobolStorageKeywords=t.acuKeywords=t.cobolFunctions=t.cobolKeywords=void 0,t.cobolKeywords=["accept","access","add","address","advancing","after","all","alphabet","alphabetic-lower","alphabetic-upper","alphabetic","alphanumeric-edited","alphanumeric","also","alter","alternate","and","any","apply","are","area","areas","ascending","assign","at","author","basis","before","beginning","binary","blank","block","bottom","by","call","cancel","cbl","cd","cells","cf","ch","chain","chaining","character","characters","class-id","class","clock-units","close","code-set","code","collating","column","com-reg","comma","common","communication","comp-0","comp-2","comp-3","comp-4","comp-5","comp-6","comp","computational-1","computational-2","computational-3","computational-4","computational-5","computational-6","computational","compute","configuration","constraints","contains","content","continue","control","controls","converting","copy","corr","corresponding","count","currency","data","date-compiled","date-written","day-of-week","day","dbcs","de","debug-contents","debug-item","debug-line","debug-name","debug-sub-1","debug-sub-2","debug-sub-3","debugging","decimal-point","declaratives","declare","delete","delimited","delimiter","depending","descending","destination","detail","display-1","display","divide","division","down","duplicates","dynamic","egcs","egi","eject","else","emi","enable","end-add","end-call","end-chain","end-compute","end-delete","end-display","end-divide","end-evaluate","end-exec","end-if","end-invoke","end-multiply","end-of-page","end-perform","end-read","end-receive","end-return","end-rewrite","end-search","end-start","end-string","end-subtract","end-unstring","end-write","end","enum-id","ending","enter","entry","environment-name","environment-value","environment","eop","equal","equals","error","esi","evaluate","every","exception","exec","exit","extend","external","factory","false","fd","file-control","file","filler","final","first","footing","for","from","function","generate","giving","global","go","goback","greater","group","heading","high-value","high-values","i-o-control","i-o","id","identification","if","in","index","indexed","indicate","inherits","initial","interface-id","initialize","initiate","input-output","input","insert","inspect","installation","into","invalid","invoke","is","just","justified","kanjikey","kept","label","last","leading","left","length","less","limit","limits","linage-counter","linage","line-counter","line","lines","linkage","local-storage","lock","low-value","low-values","memory","merge","message","metaclass","method-id","method","mode","modules","more-labels","move","multiple","multiply","native_binary","native","negative","next","no","not","null","nulls","number","numeric-edited","numeric","object-computer","object","occurs","of","off","omitted","on","open","optional","or","order","organization","other","output","overflow","override","packed-decimal","padding","page-counter","page","password","perform","pf","ph","pic","picture","plus","pointer","position","positive","printing","procedure-pointer","procedure","procedures","proceed","processing","program-id","program","purge","queue","quote","quotes","random","rd","read","ready","receive","record","recording","records","recursive","redefines","redefines","reel","reference","references","relative","release","reload","remainder","remarks","removal","renames","replace","replacing","report","reporting","reports","repository","rerun","reserve","reset","return-code","return","returning","reversed","rewind","rewrite","rf","rh","right","rounded","run","same","sd","search","section","security","segment-limit","segment","select","self","send","sentence","separate","sequence","sequential","service","set","shift-in","shift-out","sign","size","skip1","skip2","skip3","sort-control","sort-core-size","sort-file-size","sort-merge","sort-message","sort-mode-size","sort-return","sort","source-computer","source","space","spaces","special-names","standard-1","standard-2","standard","start","static","status","stop","string","sub-queue-1","sub-queue-2","sub-queue-3","subtract","sum","super","suppress","symbolic","sync","synchronized","table","tally","tallying","tape","terminal","terminate","test","text","than","then","thread-local","through","thru","time","times","title","to","top","trace","trailing","true","type","unit","unstring","until","up","upon","usage","use","using","value","values","varying","when-compiled","when","with","words","working-storage","write-only","write","zero","zeroes","zeros"],t.cobolFunctions=["abs","acos","addr","annuity","asin","atan","char-national","char","combined-datetime","concatenate","cos","current-date","date-of-integer","date-to-yyyymmdd","day-of-integer","day-to-yyyyddd","display-of","e","exception-file","exception-location","exception-statement","exception-status","exp","exp","exp10","factorial","fraction-part","integer-of-boolean","integer-of-date","integer-of-day","integer-part","integer","length-an","length","locale-date","locale-time-from-seconds","locale-time","log","log10","lower-case","max","mean","median","midrange","min","mod","national-of","numval-c","numval","ord-max","ord-min","ord","pi","present-value","random","range","rem","reverse","seconds-from-formatted-time","seconds-past-midnight","seconds-past-midnight","sin","sqrt","standard-deviation","stored-char-length","substitute-case","substitute","sum","tan","trim","upper-case","variance","when-compiled","year-to-yyyy"],t.acuKeywords=["3-d","active-x-control","activex-res","acuactivexcontrol","alignment","auto-minimize","auto-resize","bind","box","cancel-button","cell","cells","center","centered-headings","clsid","color","column-headings","cursor-frame-width","data-columns","default-font","default-interface","default-source","destroy","display-columns","divider-color","drag-color","engraved","erase","event","frame","grid","heading-color","heading-divider-color","height","help-id","id","initial-state","inquire","label-offset","label","large-font","list-box","menu","message","modeless","modify","newline","no-tab","num-rows","primary-interface","push-button","radio-button","page-layout-screen","entry-field","record-data","record-position","report-composer","resizeable","resource","scroll","self-act","separation","system","thread","tiled-headings","title-bar","title","unsorted","user-gray","vpadding","vscroll","width","wrap"],t.cobolStorageKeywords=["binary-char","binary-double","binary-long","binary-short","boolean","character","comp-1","comp-2","comp-3","comp-4","comp-5","comp-n","comp-x","comp","computational-1","computational-2","computational-3","computational-4","computational-5","computational-n","computational-x","computational","conditional-value","constant","decimal","external","float-long","float-short","low-value","low-values","occurs","pic","picture","property","redefines","sign","signed-int","signed-long","signed-short","signed","unsigned","value","values","when","zero","zeroes","zeros"],t.cobolRegisters=["address-of","debug-item","jnienvptr","json-code","json-status","return-code","sort-control","sort-core-size","sort-file-size","sort-message","sort-mode-size","sort-return","tally","when-compiled","xml-code","xml-code","xml-event","xml-information","xml-namespace-prefix","xml-namespace","xml-nnamespace-prefix","xml-nnamespace","xml-ntext","xml-text"],t.cobolProcedureKeywords=["accept","add","address","advancing","after","all","also","alter","alternate","and","apply","at","call","cancel","chain","close","compute","controls","count","declare","delete","delimited","delimiter","depending","detail","display","divide","eject","else","end-add","end-call","end-chain","end-compute","end-delete","end-display","end-divide","end-evaluate","end-exec","end-if","end-invoke","end-multiply","end-of-page","end-perform","end-read","end-receive","end-return","end-rewrite","end-search","end-start","end-string","end-subtract","end-unstring","end-write","end","entry","equal","error","evaluate","every","exec","exit","external","false","function","giving","go","goback","greater","high-value","high-values","if","initialize","initiate","insert","inspect","into","invoke","method-id","method","move","multiple","multiply","object-computer","object","perform","release","replace","replacing","return-code","returning","rewind","rewrite","search","section","self","sentence","set","space","spaces","stop","string","subtract","sum","super","tally","tallying","than","then","through","thru","time","times","unit","unstring","until","varying","write"],t.cobolCBLApis=["CBL_ABORT_RUN_UNIT","CBL_ALLOC_DYN_MEM","CBL_ALLOC_MEM","CBL_ALLOC_SHMEM","CBL_ALLOC_THREAD_MEM","CBL_AND","CBL_CALL","CBL_CANCEL","CBL_CANCEL_PROC","CBL_CHANGE_DIR","CBL_CHECK_FILE_EXIST","CBL_CLEAR_SCR","CBL_CLOSE_FILE","CBL_CLOSE_VFILE","CBL_CMPNLS","CBL_COPY_FILE","CBL_CREATE_DIR","CBL_CREATE_FILE","CBL_CTF_COMP_PROPERTY_GET","CBL_CTF_COMP_PROPERTY_SET","CBL_CTF_DEST","CBL_CTF_EMITTER","CBL_CTF_EMITTER_PROPERTY_GET","CBL_CTF_EMITTER_PROPERTY_SET","CBL_CTF_LEVEL","CBL_CTF_TRACE","CBL_CTF_TRACER_GET","CBL_CTF_TRACER_LEVEL_GET","CBL_CTF_TRACER_NOTIFY","CBL_CULL_RUN_UNITS","CBL_DATETIME","CBL_DEBUGBREAK","CBL_DEBUG_START","CBL_DEBUG_STOP","CBL_DELETE_DIR","CBL_DELETE_FILE","CBL_DIR_SCAN_END","CBL_DIR_SCAN_READ","CBL_DIR_SCAN_START","CBL_EQ","CBL_ERROR_API_REPORT","CBL_ERROR_PROC","CBL_EVENT_CLEAR","CBL_EVENT_CLOSE","CBL_EVENT_OPEN_INTRA","CBL_EVENT_POST","CBL_EVENT_WAIT","CBL_EXEC_FILE_INFO","CBL_EXEC_RUN_UNIT","CBL_EXITPRC","CBL_EXIT_PROC","CBL_FILE_ERROR","CBL_FILE_LENGTH","CBL_FILENAME_CONVERT","CBL_FILENAME_MAX_LENGTH","CBL_FLUSH_FILE","CBL_FREE_DYN_MEM","CBL_FREE_ENTRYPOINTS","CBL_FREE_LOCK","CBL_FREE_MEM","CBL_FREE_RECORD_LOCK","CBL_FREE_SEMAPHORE","CBL_FREE_SHMEM","CBL_FREE_THREAD_MEM","CBL_GET_COBOL_SWITCH","CBL_GET_CSR_POS","CBL_GET_CURRENT_DIR","CBL_GET_DATETIME","CBL_GET_ENTRYPOINTS","CBL_GET_EXIT_INFO","CBL_GET_FILE_INFO","CBL_GET_FILE_SYSTEM_INFO","CBL_GET_HOSTNAME","CBL_GET_KBD_STATUS","CBL_GET_LOCK","CBL_GET_MOUSE_MASK","CBL_GET_MOUSE_POSITION","CBL_GET_MOUSE_SHAPE","CBL_GET_MOUSE_STATUS","CBL_GET_OS_INFO","CBL_GET_PROGRAM_INFO","CBL_GET_RECORD_LOCK","CBL_GET_SCR_DRAW_CHARS","CBL_GET_SCR_GRAPHICS","CBL_GET_SCR_LINE_DRAW","CBL_GET_SCR_SIZE","CBL_GET_SHMEM_PTR","CBL_HIDE_MOUSE","CBL_IMP","CBL_INIT_MOUSE","CBL_JOIN_FILENAME","CBL_LOAD_VFILE","CBL_LOCATE_FILE","CBL_MBCS_CHAR_LEN","CBL_MEMES","CBL_MEM_STRATEGY","CBL_MEM_VALIDATE","CBL_MONITOR_BROWSE","CBL_MONITOR_BROWSE_TO_READ","CBL_MONITOR_BROWSE_TO_WRITE","CBL_MONITOR_CLOSE","CBL_MONITOR_OPEN_INTRA","CBL_MONITOR_READ","CBL_MONITOR_RELEASE","CBL_MONITOR_UNBROWSE","CBL_MONITOR_UNREAD","CBL_MONITOR_UNWRITE","CBL_MONITOR_WRITE","CBL_MONITOR_WRITE_TO_BROWSE","CBL_MUTEX_ACQUIRE","CBL_MUTEX_CLOSE","CBL_MUTEX_OPEN_INTRA","CBL_MUTEX_RELEASE","CBL_NLS_CLOSE_MSG_FILE","CBL_NLS_COMPARE","CBL_NLS_GET_MSG","CBL_NLS_INFO","CBL_NLS_OPEN_MSG_FILE","CBL_NLS_READ_MSG","CBL_NLS_TRANSFORM","CBL_NOT","CBL_OPEN_FILE","CBL_OPEN_VFILE","CBL_OR","CBL_PUT_SHMEM_PTR","CBL_READ_DIR","CBL_READ_FILE","CBL_READ_KBD_CHAR","CBL_READ_MOUSE_EVENT","CBL_READ_SCR_ATTRS","CBL_READ_SCR_CHARS","CBL_READ_SCR_CHATTRS","CBL_READ_VFILE","CBL_REF_EXT_DATA","CBL_RELSEMA","CBL_RENAME_FILE","CBL_RESNAME","CBL_RTS_ERROR","CBL_RUNTIME_ERROR","CBL_SCR_ALLOCATE_ATTR","CBL_SCR_ALLOCATE_COLOR","CBL_SCR_ALLOCATE_VC_COLOR","CBL_SCR_CONTEXT_ATTACH","CBL_SCR_CONTEXT_CREATE","CBL_SCR_CONTEXT_DESTROY","CBL_SCR_CONTEXT_DETACH","CBL_SCR_CONTEXT_GET","CBL_SCR_CREATE_VC","CBL_SCR_DESTROY_VC","CBL_SCR_FREE_ATTR","CBL_SCR_FREE_ATTRS","CBL_SCR_GET_ATTR_DETAILS","CBL_SCR_GET_ATTRIBUTES","CBL_SCR_GET_ATTR_INFO","CBL_SCR_NAME_TO_RGB","CBL_SCR_QUERY_COLORMAP","CBL_SCR_RESTORE","CBL_SCR_RESTORE_ATTRIBUTES","CBL_SCR_SAVE","CBL_SCR_SAVE_ATTRIBUTES","CBL_SCR_SET_ATTRIBUTES","CBL_SCR_SET_KEISEN_COLOR","CBL_SCR_SET_PC_ATTRIBUTES","CBL_SEMAPHORE_ACQUIRE","CBL_SEMAPHORE_CLOSE","CBL_SEMAPHORE_OPEN_INTRA","CBL_SEMAPHORE_RELEASE","CBL_SETSEMA","CBL_SHIFT_LEFT","CBL_SHIFT_RIGHT","CBL_SHOW_MOUSE","CBL_SPLIT_FILENAME","CBL_SRV_SERVICE_FLAGS_GET","CBL_SRV_SERVICE_FLAGS_SET","CBL_STREAM_CLOSE","CBL_STREAM_OPEN","CBL_STREAM_READ","CBL_STREAM_WRITE","CBL_STRING_CONVERT","CBL_SUBSYSTEM","CBL_SWAP_SCR_CHATTRS","CBL_TERM_MOUSE","CBL_TEST_LOCK","CBL_TEST_RECORD_LOCK","CBL_THREAD_CLEARC","CBL_THREAD_CREATE","CBL_THREAD_CREATE_P","CBL_THREAD_DETACH","CBL_THREAD_EXIT","CBL_THREAD_IDDATA_ALLOC","CBL_THREAD_IDDATA_GET","CBL_THREAD_KILL","CBL_THREAD_LIST_END","CBL_THREAD_LIST_NEXT","CBL_THREAD_LIST_START","CBL_THREAD_LOCK","CBL_THREAD_PROG_LOCK","CBL_THREAD_PROG_UNLOCK","CBL_THREAD_RESUME","CBL_THREAD_SELF","CBL_THREAD_SETC","CBL_THREAD_SLEEP","CBL_THREAD_SUSPEND","CBL_THREAD_TESTC","CBL_THREAD_UNLOCK","CBL_THREAD_WAIT","CBL_THREAD_YIELD","CBL_TOLOWER","CBL_TOUPPER","CBL_TSTORE_CLOSE","CBL_TSTORE_CREATE","CBL_TSTORE_GET","CBL_UNLOCK","CBL_VALIDATE_DBCS_STR","CBL_WRITE_FILE","CBL_WRITE_SCR_ATTRS","CBL_WRITE_SCR_CHARS","CBL_WRITE_SCR_CHARS_ATTR","CBL_WRITE_SCR_CHATTRS","CBL_WRITE_SCR_N_ATTR","CBL_WRITE_SCR_N_CHAR","CBL_WRITE_SCR_N_CHATTERS","CBL_WRITE_SCR_TTY","CBL_WRITE_VFILE","CBL_XOR","CBL_YIELD_RUN_UNIT"],t.cobolKeywordDictionary=new Map,t.cobolProcedureKeywordDictionary=new Map,t.cobolStorageKeywordDictionary=new Map,t.cobolRegistersDictionary=new Map;for(const e of t.cobolKeywords)t.cobolKeywordDictionary.set(e,e);for(const e of t.acuKeywords)t.cobolKeywordDictionary.set(e,e);for(const e of t.cobolProcedureKeywords)t.cobolProcedureKeywordDictionary.set(e,e);for(const e of t.cobolStorageKeywords)t.cobolStorageKeywordDictionary.set(e,e);for(const e of t.cobolRegisters)t.cobolRegistersDictionary.set(e,e)},2557:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.jclStatements=void 0,t.jclStatements=["//*","CNTL","DD","ELSE","ENDCNTL","ENDIF","EXEC","IF","INCLUDE","JCLLIB","JOB","OUTPUT","PEND","PROC","SET","THEN","XMIT"]},9131:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isSupportedLanguage=t.TextLanguage=t.getCOBOLSourceFormat=t.sourceformatMessages=t.isEnabledViaWorkspace4cobol=t.enableMarginCobolMargin=void 0;const r=n(7549),s=n(112),a=i(n(1171)),c=n(7892),l=n(842),u=i(n(6560)),d=r.window.createTextEditorDecorationType({light:{color:new r.ThemeColor("editorLineNumber.foreground"),backgroundColor:new r.ThemeColor("editor.background"),textDecoration:"solid"},dark:{color:new r.ThemeColor("editorLineNumber.foreground"),backgroundColor:new r.ThemeColor("editor.background"),textDecoration:"solid"}});function h(e){const t=s.getCurrentContext().workspaceState.get(e);if(null!=t&&!0===t)return!0;const n=r.workspace.getConfiguration(e).get("margin");return void 0===n||n}function p(){return h("coboleditor")}function f(){return h("jcleditor")}t.enableMarginCobolMargin=function(e){s.getCurrentContext().workspaceState.update("coboleditor",e)},t.isEnabledViaWorkspace4cobol=p,t.sourceformatMessages=["unknown","fixed","free","variable"];const m=["sourceformat",">>source format"];function g(e){if(e.length>7)switch(e[6]){case"*":case"D":case"/":case" ":case"-":return!0}return!1}var C;function _(e){switch(e.languageId.toLowerCase()){case"cobolit":case"cobol":case"acucobol":return C.COBOL;case"jcl":return C.JCL}return C.Unknown}t.getCOBOLSourceFormat=function(e,t){if("always_fixed"===t.fileformat_strategy)return l.ESourceFormat.fixed;let n=0,o=0;const i=e.getLineCount()>10?10:e.getLineCount();let s=l.ESourceFormat.unknown,c="";void 0!==r.window.activeTextEditor&&(c=r.window.activeTextEditor.document.languageId.toLowerCase());const u="acucobol"===c;let d="",h=0;for(let t=0;t<i;t++){const i=e.getLine(t,!0);if(void 0===i)break;const r=i.toLowerCase();g(r)&&h++,s===l.ESourceFormat.unknown&&u&&(r.startsWith("*")||r.startsWith("|")||r.startsWith("\\D"))&&(s=l.ESourceFormat.terminal),s!==l.ESourceFormat.unknown||u||-1!==r.indexOf("*>")&&s===l.ESourceFormat.unknown&&(s=l.ESourceFormat.variable);let a=0;for(let e=0;e<m.length;e++){const t=r.indexOf(m[e]);if(-1!==t){a=t+m[e].length+1;break}}if(0!==a){const e=r.substr(a);if(-1!==e.indexOf("fixed"))return l.ESourceFormat.fixed;if(-1!==e.indexOf("variable"))return l.ESourceFormat.variable;if(-1!==e.indexOf("free"))return l.ESourceFormat.free}else{if(r.length>80){s=l.ESourceFormat.variable;continue}if(g(r)){if(r.length>72){const e=r.substr(72).trim();d===e?o++:0===(p=e).toString().length||isNaN(Number(p.toString()))||n++,d=e}}else s=l.ESourceFormat.variable}}var p;if(h==i)return l.ESourceFormat.fixed;if(n>7||o>7)return l.ESourceFormat.fixed;const f=function(){const e=r.workspace.getConfiguration("coboleditor").get("fileformat");return null==e?[]:e}();if(f.length>=1){const t=e.getFilename();for(let e=0;e<f.length;e++){const n=f[e];if(a.default(t,n.pattern,{nocase:!0}))return l.ESourceFormat[n.sourceformat]}}return s},function(e){e[e.Unknown=0]="Unknown",e[e.COBOL=1]="COBOL",e[e.JCL=2]="JCL"}(C=t.TextLanguage||(t.TextLanguage={})),t.isSupportedLanguage=_,t.default=function(e){return o(this,void 0,void 0,(function*(){if(!e)return;const t=e.document,n=[],o=_(t);if(o!==C.Unknown)if(o!==C.COBOL||p)if(o!==C.JCL||f){if(o===C.COBOL){const o=c.VSCOBOLConfiguration.get(),i=u.default.getCachedObject(t,o);if(void 0===i)return void e.setDecorations(d,n);const s=i.sourceFormat;switch(s){case l.ESourceFormat.free:case l.ESourceFormat.variable:case l.ESourceFormat.unknown:return void e.setDecorations(d,n)}const a=o.editor_maxTokenizationLineLength;let h=t.lineCount;h>a&&(h=a);for(let e=0;e<h;e++){const o=t.lineAt(e).text;if(s===l.ESourceFormat.fixed&&o.length>6){const t=new r.Position(e,0),o=new r.Position(e,6),i={range:new r.Range(t,o)};n.push(i)}if(o.length>72){const t=new r.Position(e,72),i=new r.Position(e,o.length),s={range:new r.Range(t,i)};n.push(s)}}}if(o===C.JCL)for(let e=0;e<t.lineCount;e++){const o=t.lineAt(e).text;if(o.length>72){const t=new r.Position(e,72),i=new r.Position(e,o.length),s={range:new r.Range(t,i)};n.push(s)}}e.setDecorations(d,n)}else e.setDecorations(d,n);else e.setDecorations(d,n);else e.setDecorations(d,n)}))}},9811:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.COBOLCopyBookProvider=void 0;const c=r(n(5622)),l=r(n(7549)),u=n(7549),d=n(7892),h=a(n(6560)),p=n(3412);class f{provideDefinition(e,t,n){return this.resolveDefinitions(e,t,n)}resolveDefinitions(e,t,n){return s(this,void 0,void 0,(function*(){const o=d.VSCOBOLConfiguration.get(),i=h.default.getCachedObject(e,o);if(void 0===i)return this.resolveDefinitionsFallback(e,t,n);for(const[,e]of i.copyBooksUsed){const n=e.statementInformation;if(0!==n.fileName.length&&new u.Range(new u.Position(n.startLineNumber,n.startCol),new u.Position(n.endLineNumber,n.endCol)).contains(t))return new l.Location(u.Uri.file(n.fileName),new u.Range(new u.Position(0,0),new u.Position(0,0)))}return[]}))}resolveDefinitionsFallback(e,t,n){return s(this,void 0,void 0,(function*(){const n=d.VSCOBOLConfiguration.get(),o=e.lineAt(t).text,i=o.toLowerCase().replace("\t"," ");let r=this.extractCopyBoolFilename(o),s=0;const a=l.window.activeTextEditor;if(a&&void 0===r){const e=a.selection,t=new l.Range(e.start,e.end),n=a.document.getText(t);void 0!==n&&(r=n.trim())}if(void 0===r)return[];-1!==i.indexOf("copy")&&(s=i.indexOf(" in "),-1===s&&(s=i.indexOf(" of ")),-1!==s?s+=4:s=0);let c=0!==s?o.substr(s):"";if(0!==c.length){let e=c.trim();e.endsWith(".")&&(e=e.substr(0,e.length-1)),e.endsWith('"')&&e.startsWith('"')&&(e=e.substr(1,e.length-2)),e.endsWith("'")&&e.startsWith("'")&&(e=e.substr(1,e.length-2)),c=e}if(null!==r&&0!==r.length){const e=f.expandLogicalCopyBookToFilenameOrEmpty(r.trim(),c,n);if(0!==e.length)return new l.Location(u.Uri.file(e),new u.Range(new u.Position(0,0),new u.Position(0,0)))}return[]}))}static expandLogicalCopyBookToFilenameOrEmpty(e,t,n){if(null===t||0===t.length){const t=p.VSCOBOLFileUtils.findCopyBook(e,n);return 0!==t.length?c.normalize(t):t}const o=p.VSCOBOLFileUtils.findCopyBookInDirectory(e,t,n);return 0!==o.length?c.normalize(o):o}extractCopyBoolFilename(e){const t=e.toLowerCase().indexOf("copy");if(-1!==t){const n=e.substr(4+t).trimLeft(),o=n.indexOf(" ");let i=n;return-1!==o&&(i=i.substr(0,o).trim()),i.endsWith(".")&&(i=i.substr(0,i.length-1),i=i.trim()),i.startsWith('"')&&i.endsWith('"')?(i=i.substr(1,i.length-2),i=i.trim(),i):(i.startsWith("'")&&i.endsWith("'")&&(i=i.substr(1,i.length-2),i=i.trim()),i)}const n=e.toLowerCase();if(-1!==n.indexOf("exec")&&n.includes("sql",n.indexOf("exec"))){let t=n.indexOf("include");if(-1!==t){t+=7;const n=e.substr(t).trimLeft(),o=n.toLowerCase().indexOf("end-exec");if(-1!==o)return n.substr(0,o).trim()}}}}t.COBOLCopyBookProvider=f},6763:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.SourceItem=t.SourceFolderItem=void 0;const s=r(n(7549)),a=r(n(5622)),c=e=>({light:a.join(__filename,"..","..","images","light",e),dark:a.join(__filename,"..","..","images","dark",e)});class l extends s.TreeItem{constructor(e,t,n){super(e,s.TreeItemCollapsibleState.None),this.label=e,this.uri=t,this.line=n,this.iconPath=c("folder.svg"),this.contextValue="Source Folder"}}t.SourceFolderItem=l;class u extends s.TreeItem{constructor(e,t,n){super(e,s.TreeItemCollapsibleState.None),this.label=e,this.uri=t,this.line=n,this.iconPath=c("sourceitem.svg"),this.contextValue="Source"}}t.SourceItem=u},6232:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.COBOLSourceDefinition=void 0;const c=r(n(7549)),l=n(112),u=n(8202),d=a(n(6560)),h=n(7892),p=n(7530);t.COBOLSourceDefinition=class{constructor(){this.sectionRegEx=new RegExp("[0-9a-zA-Z][a-zA-Z0-9-_]*"),this.variableRegEx=new RegExp("[#0-9a-zA-Z][a-zA-Z0-9-_]*"),this.classRegEx=new RegExp("[0-9a-zA-Z][a-zA-Z0-9-_]*"),this.methodRegEx=new RegExp("[0-9a-zA-Z][a-zA-Z0-9-_]*")}provideDefinition(e,t,n){return this.resolveDefinitions(e,t,n)}resolveDefinitions(e,t,n){return s(this,void 0,void 0,(function*(){const n=[];let o;const i=h.VSCOBOLConfiguration.get(),r=e.lineAt(t.line).text;if(r.match(/.*(perform|thru|go\s*to|until|varying).*$/i)){const r=d.default.getCachedObject(e,i);if(void 0===r)return n;if(o=this.getSectionOrParaLocation(e,r,t),o)return n.push(o),n}if(r.match(/.*(new\s*|type).*$/i)){const r=d.default.getCachedObject(e,i);if(void 0===r)return n;if(o=this.getClassTarget(e,r,t),void 0!==o)return n.push(o),n}if(r.match(/.*(invoke\s*|::)(.*$)/i)){const r=d.default.getCachedObject(e,i);if(void 0===r)return n;if(o=this.getMethodTarget(e,r,t),void 0!==o)return n.push(o),n}return this.getVariableInCurrentDocument(n,e,t,i)?n:i.fuzzy_variable_search&&(o=this.getFuzzyVariable(e,t),o)?(n.push(o),n):n}))}getFuzzyVariable(e,t){const n=e.getWordRangeAtPosition(t,new RegExp("[a-zA-Z0-9_-]+")),o=n?e.getText(n):"";if(""===o)return;const i=o.toLowerCase();for(let t=1;t<e.lineCount;t++){const n=e.lineAt(t).text;if(n.length>7&&"*"===n[6])continue;if(n.match(/.*(procedure\s+division).*$/i))return;const o=n.toLowerCase().indexOf(i);if(-1!==o){const i=n.substr(0,o).trim();if(i.match(/^[0-9 ]+$/i))return new c.Location(e.uri,new c.Position(t,o));if("fd"===i.toLowerCase())return new c.Location(e.uri,new c.Position(t,o))}}}getSectionOrParaLocation(e,t,n){const o=e.getWordRangeAtPosition(n,this.sectionRegEx),i=o?e.getText(o):"";if(""===i)return;const r=i.toLowerCase();try{if(t.sections.has(r)){const e=t.sections.get(r);if(void 0!==e){const t=new c.Position(e.startLine,e.startColumn),n=c.Uri.file(e.filename);return new c.Location(n,new c.Range(t,t))}}}catch(e){l.logMessage(e)}try{if(t.paragraphs.has(r)){const e=t.paragraphs.get(r);if(void 0!==e){const t=new c.Position(e.startLine,e.startColumn),n=c.Uri.file(e.filename);return new c.Location(n,new c.Range(t,t))}}}catch(e){l.logMessage(e)}}isValidKeyword(e){return p.cobolKeywordDictionary.has(e)}getVariableInCurrentDocument(e,t,n,o){const i=t.getWordRangeAtPosition(n,this.variableRegEx),r=i?t.getText(i):"";if(""===r)return!1;const s=r.toLowerCase();if(this.isValidKeyword(s))return!1;const a=d.default.getCachedObject(t,o);if(void 0===a)return!1;const l=a.constantsOrVariables.get(s);if(void 0===l||0===l.length)return!1;for(let t=0;t<l.length;t++){const n=l[t];if("filler"!==n.tokenNameLower)switch(n.tokenType){case u.COBOLTokenStyle.Union:{const t=new c.Position(n.startLine,n.startColumn),o=c.Uri.file(n.filename);e.push(new c.Location(o,t));break}case u.COBOLTokenStyle.Constant:{const t=new c.Position(n.startLine,n.startColumn),o=c.Uri.file(n.filename);e.push(new c.Location(o,t));break}case u.COBOLTokenStyle.ConditionName:{const t=new c.Position(n.startLine,n.startColumn),o=c.Uri.file(n.filename);e.push(new c.Location(o,t));break}case u.COBOLTokenStyle.Variable:{const t=new c.Position(n.startLine,n.startColumn),o=c.Uri.file(n.filename);e.push(new c.Location(o,t));break}}}return 0!==e.length}getGenericTarget(e,t,n,o){const i=n.getWordRangeAtPosition(o,e),r=i?n.getText(i):"";if(""===r)return;const s=r.toLowerCase();if(t.has(s)){const e=t.get(s);if(void 0!==e){const t=new c.Position(e.startLine,e.startColumn),n=c.Uri.file(e.filename);return new c.Location(n,t)}}}getClassTarget(e,t,n){return this.getGenericTarget(this.classRegEx,t.classes,e,n)}getMethodTarget(e,t,n){return this.getGenericTarget(this.methodRegEx,t.methods,e,n)}}},3722:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SourceViewTree=void 0;const c=r(n(7549)),l=r(n(5622)),u=n(6763),d=n(7549),h=n(627),p=n(112),f=a(n(6560));t.SourceViewTree=class{constructor(e){this.topLevelItems=[],this.cobolItems=new Map,this.copyBookItems=new Map,this.jclItems=new Map,this.pliItems=new Map,this.hlasmItems=new Map,this.documentItems=new Map,this.scriptItems=new Map,this.objectItems=new Map,this._onDidChangeTreeData=new c.EventEmitter,this.onDidChangeTreeData=this._onDidChangeTreeData.event,this.settings=e,this.cobolItem=new u.SourceFolderItem("COBOL"),this.copyBookItem=new u.SourceFolderItem("Copybooks"),this.jclItem=new u.SourceFolderItem("JCL"),this.hlasmItem=new u.SourceFolderItem("HLASM"),this.pliItem=new u.SourceFolderItem("PL/I"),this.documentItem=new u.SourceFolderItem("Documents"),this.scriptItem=new u.SourceFolderItem("Scripts"),this.objectItem=new u.SourceFolderItem("Objects"),this.topLevelItems.push(this.cobolItem),this.topLevelItems.push(this.copyBookItem),e.sourceview_include_jcl_files&&this.topLevelItems.push(this.jclItem),e.sourceview_include_hlasm_files&&this.topLevelItems.push(this.hlasmItem),e.sourceview_include_pli_files&&this.topLevelItems.push(this.pliItem),e.sourceview_include_doc_files&&this.topLevelItems.push(this.documentItem),e.sourceview_include_script_files&&this.topLevelItems.push(this.scriptItem),e.sourceview_include_object_files&&this.topLevelItems.push(this.objectItem);const t=h.getWorkspaceFolders();if(t)for(const e of t)this.addWorkspace(e)}addWorkspace(e){return s(this,void 0,void 0,(function*(){this.addFolder(e.uri.fsPath)}))}addFolder(e){return s(this,void 0,void 0,(function*(){const t=c.Uri.file(e),n=yield d.workspace.fs.readDirectory(t);for(const t of n)switch(t[1]){case c.FileType.File:{const n=t[0],o=n.lastIndexOf(".");if(-1!==o){const i=n.substr(1+o),r=l.join(e,t[0]);this.addExtension(i,c.Uri.file(r))}}break;case c.FileType.Directory:if(!f.default.ignoreDirectory(t[0])){const n=l.join(e,t[0]);this.addFolder(n)}}this.refreshItems()}))}getCommand(e,t){let n="vscode.open";return"acu"!==t&&"int"!==t&&"gnt"!==t||(n=""),{arguments:[e,{selection:new c.Range(new c.Position(0,0),new c.Position(0,0))}],command:n,title:"Open"}}newSourceItem(e,t,n,o,i){const r=new u.SourceItem(t,n,o);return r.command=this.getCommand(n,i),r.contextValue=e,r.tooltip=n.fsPath,r}refreshAll(){this._onDidChangeTreeData.fire(this.cobolItem),this._onDidChangeTreeData.fire(this.copyBookItem),this._onDidChangeTreeData.fire(this.jclItem),this._onDidChangeTreeData.fire(this.pliItem),this._onDidChangeTreeData.fire(this.hlasmItem),this._onDidChangeTreeData.fire(this.documentItem),this._onDidChangeTreeData.fire(this.scriptItem),this._onDidChangeTreeData.fire(this.objectItem)}addExtensionIfInList(e,t,n,o,i,r){for(const s of n)if(s.length>0&&e===s){const e=t.fsPath;if(!1===r.has(e))return r.set(e,this.newSourceItem(o,i,t,0,s)),!0}return!1}addExtension(e,t){const n=l.basename(t.fsPath);if(void 0!==e){this.addExtensionIfInList(e.toLowerCase(),t,this.settings.program_extensions,this.cobolItem.contextValue,n,this.cobolItems),this.addExtensionIfInList(e.toLowerCase(),t,this.settings.copybookexts,"copybook",n,this.copyBookItems);const o=t.fsPath,i=e.toLowerCase();switch(i){case"jcl":case"job":case"cntl":case"prc":case"proc":!1===this.jclItems.has(o)&&this.jclItems.set(o,this.newSourceItem("jcl",n,t,0,i));break;case"hlasm":case"asm":case"s":case"asmpgm":case"mac":case"mlc":case"asmmac":!1===this.hlasmItems.has(o)&&this.hlasmItems.set(o,this.newSourceItem("hlasm",n,t,0,i));break;case"pl1":case"pli":case"plinc":case"pc":case"pci":case"pcx":case"inc":!1===this.pliItems.has(o)&&this.pliItems.set(o,this.newSourceItem("pli",n,t,0,i));break;case"md":case"txt":case"html":!1===this.documentItems.has(o)&&this.documentItems.set(o,this.newSourceItem("document",n,t,0,i));break;case"sh":case"bat":!1===this.scriptItems.has(o)&&this.scriptItems.set(o,this.newSourceItem("scripts",n,t,0,i));break;case"int":case"gnt":case"acu":!1===this.objectItems.has(o)&&this.objectItems.set(o,this.newSourceItem("objects",n,t,0,i))}}}setTreeState(e,t){0!==e.size?t.collapsibleState=c.TreeItemCollapsibleState.Collapsed:t.collapsibleState=c.TreeItemCollapsibleState.None}refreshItems(){this.setTreeState(this.cobolItems,this.cobolItem),this.setTreeState(this.copyBookItems,this.copyBookItem),this.setTreeState(this.jclItems,this.jclItem),this.setTreeState(this.hlasmItems,this.hlasmItem),this.setTreeState(this.pliItems,this.pliItem),this.setTreeState(this.documentItems,this.documentItem),this.setTreeState(this.scriptItems,this.scriptItem),this.setTreeState(this.objectItems,this.objectItem),this.refreshAll()}checkFile(e){return s(this,void 0,void 0,(function*(){try{const t=e.fsPath.split(".").pop();void 0!==t&&(this.addExtension(t,e),this.refreshItems())}catch(e){p.logException("checkFile",e)}}))}clearFile(e){const t=e.fsPath;this.cobolItems.delete(t),this.copyBookItems.delete(t),this.jclItems.delete(t),this.hlasmItems.delete(t),this.pliItems.delete(t),this.documentItems.delete(t),this.scriptItems.delete(t),this.objectItems.delete(t),this.refreshItems()}getItemsFromMap(e){return[...e.values()]}getChildren(e){return new Promise(void 0===e?e=>{e(this.topLevelItems)}:t=>{let n=[];switch(e.label){case"COBOL":n=this.getItemsFromMap(this.cobolItems);break;case"Copybooks":n=this.getItemsFromMap(this.copyBookItems);break;case"JCL":n=this.getItemsFromMap(this.jclItems);break;case"PL/I":n=this.getItemsFromMap(this.pliItems);break;case"HLASM":n=this.getItemsFromMap(this.hlasmItems);break;case"Documents":n=this.getItemsFromMap(this.documentItems);break;case"Scripts":n=this.getItemsFromMap(this.scriptItems);break;case"Objects":n=this.getItemsFromMap(this.objectItems)}t(n)})}getTreeItem(e){return e}}},6825:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CobolDocumentSymbolProvider=t.JCLDocumentSymbolProvider=void 0;const c=r(n(7549)),l=n(8202),u=n(7892),d=n(7925),h=a(n(6560)),p=n(4733);t.JCLDocumentSymbolProvider=class{provideDocumentSymbols(e,t){return s(this,void 0,void 0,(function*(){const t=[];if(u.VSCOBOLConfiguration.get().outline===d.outlineFlag.Off)return t;const n=e.uri,o=e.lineCount,i=e.lineAt(o-1).text.length;let r="";for(let s=0;s<e.lineCount;s++){const a=e.lineAt(s).text;if(!a.startsWith("//*")&&a.startsWith("//")){const e=a.substr(2),u=[],d=[];l.splitArgument(e,!1,d);for(let e=0;e<d.length;e++)if(void 0!==d[e]){const t=d[e].trim();t.length>0&&u.push(t)}if(u.length>0&&u.length>1){if(-1!==u[1].toLowerCase().indexOf("job")){const e=new c.Range(new c.Position(s,0),new c.Position(o,i)),a=new c.Location(n,e);t.push(new c.SymbolInformation(u[0],c.SymbolKind.Field,r,a)),r=u[0]}if(-1!==u[1].toLowerCase().indexOf("exec")){const e=new c.Range(new c.Position(s,0),new c.Position(s,u.length)),o=new c.Location(n,e);t.push(new c.SymbolInformation(u[0],c.SymbolKind.Function,r,o))}}}}return t}))}},t.CobolDocumentSymbolProvider=class{provideDocumentSymbols(e,t){return s(this,void 0,void 0,(function*(){const t=[],n=u.VSCOBOLConfiguration.get(),o=n.outline;if(o===d.outlineFlag.Off)return t;if(!1===p.VSPreProc.areAllPreProcessorsReady(n))return t;const i=h.default.getCachedObject(e,n);if(void 0===i)return t;const r=e.uri;let s=!0,a=!0,f=!0;o===d.outlineFlag.Partial&&(s=!1),o===d.outlineFlag.Skeleton&&(a=!1,f=!1,s=!1);for(const e of i.tokensInOrder)try{if(!1===e.ignoreInOutlineView){const n=new c.Range(new c.Position(e.startLine,e.startColumn),new c.Position(e.endLine,e.endColumn)),o=new c.Location(r,n),i=void 0!==e.parentToken?e.parentToken.description:"";switch(e.tokenType){case l.COBOLTokenStyle.ClassId:case l.COBOLTokenStyle.ProgramId:t.push(new c.SymbolInformation(e.description,c.SymbolKind.Class,i,o));break;case l.COBOLTokenStyle.CopyBook:case l.COBOLTokenStyle.CopyBookInOrOf:case l.COBOLTokenStyle.File:t.push(new c.SymbolInformation(e.description,c.SymbolKind.File,i,o));break;case l.COBOLTokenStyle.Declaratives:case l.COBOLTokenStyle.Division:t.push(new c.SymbolInformation(e.description,c.SymbolKind.Method,i,o));break;case l.COBOLTokenStyle.Paragraph:if(!1===s)break;t.push(new c.SymbolInformation(e.description,c.SymbolKind.Method,i,o));break;case l.COBOLTokenStyle.DeclarativesSection:t.push(new c.SymbolInformation(e.description,c.SymbolKind.Method,i,o));break;case l.COBOLTokenStyle.Section:if(!1===f)break;t.push(new c.SymbolInformation(e.description,c.SymbolKind.Method,i,o));break;case l.COBOLTokenStyle.EntryPoint:case l.COBOLTokenStyle.FunctionId:t.push(new c.SymbolInformation(e.description,c.SymbolKind.Function,i,o));break;case l.COBOLTokenStyle.EnumId:t.push(new c.SymbolInformation(e.description,c.SymbolKind.Enum,i,o));break;case l.COBOLTokenStyle.InterfaceId:t.push(new c.SymbolInformation(e.description,c.SymbolKind.Interface,i,o));break;case l.COBOLTokenStyle.ValueTypeId:t.push(new c.SymbolInformation(e.description,c.SymbolKind.Struct,i,o));break;case l.COBOLTokenStyle.Variable:if(!1===a)break;if("filler"===e.tokenNameLower)continue;"fd"===e.extraInformation||"sd"===e.extraInformation||"rd"===e.extraInformation||"select"===e.extraInformation?t.push(new c.SymbolInformation(e.description,c.SymbolKind.File,i,o)):e.extraInformation.endsWith("-GROUP")?t.push(new c.SymbolInformation(e.description,c.SymbolKind.Struct,i,o)):e.extraInformation.endsWith("88")?t.push(new c.SymbolInformation(e.description,c.SymbolKind.EnumMember,i,o)):t.push(new c.SymbolInformation(e.description,c.SymbolKind.Field,i,o));break;case l.COBOLTokenStyle.ConditionName:if(!1===a)break;t.push(new c.SymbolInformation(e.description,c.SymbolKind.TypeParameter,i,o));break;case l.COBOLTokenStyle.Union:if(!1===a)break;t.push(new c.SymbolInformation(e.description,c.SymbolKind.Struct,i,o));break;case l.COBOLTokenStyle.Constant:if(!1===a)break;t.push(new c.SymbolInformation(e.description,c.SymbolKind.Constant,i,o));break;case l.COBOLTokenStyle.MethodId:t.push(new c.SymbolInformation(e.description,c.SymbolKind.Method,i,o));break;case l.COBOLTokenStyle.Property:t.push(new c.SymbolInformation(e.description,c.SymbolKind.Property,i,o));break;case l.COBOLTokenStyle.Constructor:t.push(new c.SymbolInformation(e.description,c.SymbolKind.Constructor,i,o))}}}catch(t){console.log("Failed "+t+" on "+JSON.stringify(e))}return t}))}}},9450:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processTabKey=void 0;const o=n(7549),i=n(7892);function r(e,t,n,o){const i=function(e,t){let n=0;for(let o=0;o<t.length;o++)if(n=t[o],n>e)return n-e;return 4-(e-t[t.length-1])%4}(n.character,o);e.insert(n," ".repeat(i))}function s(e,t,n,i){const r=function(e,t){if(e>t[t.length-1])return(e-t[t.length-1])%4==0?4:(e-t[t.length-1])%4;for(let n=t.length-1;n>-1;n--){const o=t[n];if(o<e)return e-o}return 0}(n.character,i),s=new o.Range(n.line,n.character-r,n.line,n.character);if(t.getText(s)===" ".repeat(r))e.delete(s);else for(let e=0;e<r;e++)o.commands.executeCommand("cursorMove",{to:"left"})}function a(e,t,n,i){for(let t=n.start.line;t<=n.end.line;t++)r(e,0,new o.Position(t,n.start.character),i)}const c=/^\s*/;function l(e,t,n,i){for(let r=n.start.line;r<=n.end.line;r++){let a=n.start.character;if(0===a){const e=t.getText(n);if(null!==e){const t=e.match(c);null!==t&&(a=t[0].length)}}s(e,t,new o.Position(r,a),i)}}t.processTabKey=function(e){const t=o.window.activeTextEditor;t&&function(e,t,n,o){const c=i.VSCOBOLConfiguration.get().tabstops;e.edit((e=>{for(let i=0;i<n.length;i++)if(n[i].start.line===n[i].end.line){const a=n[i].start;o?r(e,0,a,c):s(e,t,a,c)}else o?a(e,0,n[i],c):l(e,t,n[i],c)}))}(t,t.document,t.selections,e)}},6560:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.COBOLSymbolTableGlobalEventHelper=t.VSScanStats=t.clearCOBOLCache=void 0;const a=r(n(5747)),c=r(n(5622)),l=n(5323),u=n(7549),d=r(n(8202)),h=n(5363),p=n(112),f=n(7892),m=n(627),g=n(3130),C=n(4669),_=n(842),b=n(8548),y=n(646),v=n(6271),O=n(8331),w=n(4733),S=n(2124),k=new Map;function L(){k.clear(),h.InMemoryGlobalSymbolCache.isDirty=!1}t.clearCOBOLCache=L;class T extends y.ScanStats{constructor(){super(...arguments),this.directoriesScannedMap=new Map}}t.VSScanStats=T;class E{constructor(e){this.config=e}start(e){var t,n,o,i,r,s;this.qp=e,this.st=new C.COBOLSymbolTable,this.st.fileName=e.filename,this.st.lastModifiedTime=e.lastModifiedTime,void 0!==(null===(t=this.st)||void 0===t?void 0:t.fileName)&&void 0!==this.st.lastModifiedTime&&(O.COBOLWorkspaceSymbolCacheHelper.removeAllCopybookReferences(null===(n=this.st)||void 0===n?void 0:n.fileName),O.COBOLWorkspaceSymbolCacheHelper.removeAllPrograms(null===(o=this.st)||void 0===o?void 0:o.fileName),O.COBOLWorkspaceSymbolCacheHelper.removeAllProgramEntryPoints(null===(i=this.st)||void 0===i?void 0:i.fileName),O.COBOLWorkspaceSymbolCacheHelper.removeAllTypes(null===(r=this.st)||void 0===r?void 0:r.fileName),h.InMemoryGlobalCacheHelper.addFilename(null===(s=this.st)||void 0===s?void 0:s.fileName,e.workspaceFile))}processToken(e){if(!e.ignoreInOutlineView&&void 0!==this.st)switch(e.tokenType){case d.COBOLTokenStyle.CopyBook:case d.COBOLTokenStyle.CopyBookInOrOf:O.COBOLWorkspaceSymbolCacheHelper.addReferencedCopybook(e.tokenName,this.st.fileName);break;case d.COBOLTokenStyle.File:case d.COBOLTokenStyle.ImplicitProgramId:case d.COBOLTokenStyle.ProgramId:O.COBOLWorkspaceSymbolCacheHelper.addCalableSymbol(this.st.fileName,e.tokenNameLower,e.startLine);break;case d.COBOLTokenStyle.EntryPoint:O.COBOLWorkspaceSymbolCacheHelper.addEntryPoint(this.st.fileName,e.tokenNameLower,e.startLine);break;case d.COBOLTokenStyle.InterfaceId:O.COBOLWorkspaceSymbolCacheHelper.addClass(this.st.fileName,e.tokenName,e.startLine,O.TypeCategory.InterfaceId);break;case d.COBOLTokenStyle.EnumId:O.COBOLWorkspaceSymbolCacheHelper.addClass(this.st.fileName,e.tokenName,e.startLine,O.TypeCategory.EnumId);break;case d.COBOLTokenStyle.ClassId:O.COBOLWorkspaceSymbolCacheHelper.addClass(this.st.fileName,e.tokenName,e.startLine,O.TypeCategory.ClassId);break;case d.COBOLTokenStyle.MethodId:}}finish(){this.config.cache_metadata!==_.CacheDirectoryStrategy.Off&&void 0!==this.qp&&void 0!==this.st&&g.COBOLSymbolTableHelper.saveToFile(this.qp.deprecatedCacheDirectory,this.st),b.COBOLUtils.saveGlobalCacheToWorkspace(this.config)}}t.COBOLSymbolTableGlobalEventHelper=E;class I{static getCachedObject(e,t){if(e.lineCount>t.editor_maxTokenizationLineLength)return void p.logMessage(` ${e.fileName} is not parsed, line count is ${e.lineCount} and editor.maxTokenizationLineLength is ${t.editor_maxTokenizationLineLength}`);const n=e.fileName;let o=k.get(n);if(void 0!==o&&o.sourceHandler.getDocumentVersionId()!==BigInt(e.version)&&(k.delete(n),o=void 0),e.isDirty&&void 0!==u.debug.activeDebugSession)return p.logMessage("Source code has changed during debugging, in memory scanning suspended"),void p.logMessage(` ID=${u.debug.activeDebugSession.id}, Name=${u.debug.activeDebugSession.name}, Type=${u.debug.activeDebugSession.type}`);if(void 0===o)try{if(0!==t.preprocessor_extensions.length&&!1===w.VSPreProc.registerPreProcessors(t))return;const o=I.getDeprecatedCacheDirectory(),i=p.performance_now(),r=new l.VSCodeSourceHandler(e,!1),s=r.getIsSourceInWorkSpace(),a=new d.default(r,t,void 0===o?"":o,new d.SharedSourceReferences(t,!0),t.parse_copybooks_for_references,s?new E(t):d.EmptyCOBOLSourceScannerEventHandler.Default,p.ExternalFeatures);if(p.logTimedMessage(p.performance_now()-i," - Parsing "+n),k.size>I.MAX_MEM_CACHE_SIZE){let e=Number.MAX_VALUE,t="";for(const[n,o]of k)o.tokensInOrder.length<e&&(t=n,e=o.tokensInOrder.length);0!==t.length&&k.delete(t)}return k.set(n,a),a}catch(e){p.logException("getCachedObject",e)}return o}static checkWorkspaceForMissingCopybookDirs(){return s(this,void 0,void 0,(function*(){p.logChannelSetPreserveFocus(!1),p.logMessage("Checking workspace for folders that are not present in copybookdirs setting");const e=f.VSCOBOLConfiguration.get(),t=m.getWorkspaceFolders();if(void 0!==t)for(const n of t)try{yield I.checkWorkspaceForMissingCopybookDir(e,n.uri,n.uri)}catch(e){continue}p.logMessage(" -- Analysis complete")}))}static checkWorkspaceForMissingCopybookDir(e,t,n){return s(this,void 0,void 0,(function*(){const o=yield u.workspace.fs.readDirectory(n);for(const[i,r]of o)switch(r){case u.FileType.Directory|u.FileType.SymbolicLink:case u.FileType.Directory:if(!I.ignoreDirectory(i)){const o=c.join(n.fsPath,i);if(!I.ignoreDirectory(i)){const n=1+t.fsPath.length,i=o.substr(n);if(!1===b.COBOLUtils.inCopybookdirs(e,i)){const t=yield I.howManyCopyBooksInDirectory(o,e);0!==t&&p.logMessage(`  Add: ${i} to coboleditor.copybookdirs (possible copybooks ${t})`)}yield I.checkWorkspaceForMissingCopybookDir(e,t,u.Uri.file(o))}}}}))}static howManyCopyBooksInDirectory(e,t){return s(this,void 0,void 0,(function*(){const n=u.Uri.file(e),o=yield u.workspace.fs.readDirectory(n);let i=0;for(const[e,n]of o)switch(n){case u.FileType.File|u.FileType.SymbolicLink:case u.FileType.File:v.COBOLFileUtils.isValidCopybookExtension(e,t)&&i++}return i}))}static ignoreDirectory(e){return!!e.startsWith(".")}static wipeCacheDirectory(e){L();for(const t of a.readdirSync(e))if(t.endsWith(".sym")){const n=c.join(e,t);try{a.unlinkSync(n)}catch(e){}}const t=c.join(e,y.ScanDataHelper.scanFilename);try{a.unlinkSync(t)}catch(e){}}static deprecatedClearMetaData(e,t){S.VSCobScanner_depreciated.isDeprecatedScannerActive(t)?u.window.showInformationMessage(" Unable to clear metadata while caching is already in progress"):u.window.showQuickPick(["Yes","No"],{placeHolder:"Are you sure you want to clear the metadata?"}).then((function(e){"Yes"===e&&(I.wipeCacheDirectory(t),p.logMessage("Metadata cache cleared"))}))}static getDeprecatedCacheDirectory(){const e=f.VSCOBOLConfiguration.get();if(e.cache_metadata!==_.CacheDirectoryStrategy.Off&&m.getWorkspaceFolders()){if(e.cache_metadata===_.CacheDirectoryStrategy.UserDefinedDirectory){const t=I.getUserStorageDirectory(e);if(void 0===t)return;if(!p.isDirectory(t))return;return t}let t="";const n=m.getWorkspaceFolders();if(void 0!==n)for(const e of n){const n=c.join(e.uri.fsPath,".vscode_cobol");if(p.isDirectory(n))return n;""===t&&(t=n)}if(0===t.length)return;if(!1===p.isDirectory(t))try{a.mkdirSync(t)}catch(e){return}return t}}static getUserStorageDirectory(e){let t=e.cache_metadata_user_directory;if(null!==t&&0!==t.length)return v.COBOLFileUtils.isWin32&&(t=t.replace(/\$\{HOME\}/,"${USERPROFILE}")),t.replace(/\$\{([^%]+)\}/g,((e,t)=>process.env[t]||""))}}t.default=I,I.MAX_MEM_CACHE_SIZE=30},5711:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},i=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,i){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,i,(t=e[n](t)).done,t.value)}))}}},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VSCobScanner=void 0;const s=r(n(5622)),a=n(7549),c=n(627),l=n(646),u=n(7892),d=n(112),h=n(3129),p=n(8331),f=n(8548),m=n(5363),g=n(4669),C=n(3412);class _{constructor(){this.directoriesScanned=0,this.maxDirectoryDepth=0,this.fileCount=0,this.showMessage=!1,this.directoriesScannedMap=new Map}}class b{static getCobScannerDirectory(){const e=a.extensions.getExtension("bitlang.cobol");if(void 0!==e){const t=`${e.extensionPath}`;return s.default.join(t,"cobscanner")}return""}static forkScanner(e,t,n,r,a,c){var u,_,y,v;return o(this,void 0,void 0,(function*(){const o=s.default.join(b.scannerBinDir,"cobscanner.js"),O={stdio:[0,1,2,"ipc"],cwd:b.scannerBinDir,env:{SCANDATA:l.ScanDataHelper.getScanData(t),SCANDATA_TCOUNT:`${c}`}},w=a?"useenv_threaded":"useenv",S=h.fork(o,[w],O);if(null==S)return;const k=setTimeout((function(){try{S.kill()}catch(e){d.logException(`Timeout, ${n}`,e)}}),e.cache_metadata_inactivity_timeout);S.on("error",(e=>{d.logException(`Fork caused ${n}`,e)})),S.on("exit",(t=>{clearTimeout(k),0!==t?d.logMessage(`External scan completed (${S.pid}) [Exit Code=${t}}]`):d.progressStatusBarItem.hide(),r&&f.COBOLUtils.saveGlobalCacheToWorkspace(e)}));let L=0;if(S.on("message",(e=>{k.refresh();const t=e;if(t.startsWith("@@")){if(m.InMemoryGlobalSymbolCache.isDirty=!0,t.startsWith(l.COBSCANNER_STATUS)){const e=t.split(" ");d.progressStatusBarItem.show(),L+=Number.parseInt(e[1],10),d.progressStatusBarItem.text=`Processing metadata: ${L}%`}else if(t.startsWith(l.COBSCANNER_SENDEP)){const e=t.split(","),n=e[1],o=Number.parseInt(e[2],10),i=e[3];p.COBOLWorkspaceSymbolCacheHelper.addEntryPoint(i,n,o)}else if(t.startsWith(l.COBSCANNER_SENDPRGID)){const e=t.split(","),n=e[1],o=Number.parseInt(e[2],10),i=e[3];p.COBOLWorkspaceSymbolCacheHelper.removeAllProgramEntryPoints(i),p.COBOLWorkspaceSymbolCacheHelper.removeAllTypes(i),p.COBOLWorkspaceSymbolCacheHelper.addCalableSymbol(i,n,o)}else if(t.startsWith(l.COBSCANNER_SENDCLASS)){const e=t.split(","),n=e[1],o=Number.parseInt(e[2],10),i=e[3];p.COBOLWorkspaceSymbolCacheHelper.addClass(i,n,o,p.TypeCategory.ClassId)}else if(t.startsWith(l.COBSCANNER_SENDINTERFACE)){const e=t.split(","),n=e[1],o=Number.parseInt(e[2],10),i=e[3];p.COBOLWorkspaceSymbolCacheHelper.addClass(i,n,o,p.TypeCategory.InterfaceId)}else if(t.startsWith(l.COBSCANNER_SENDENUM)){const e=t.split(","),n=e[1],o=Number.parseInt(e[2],10),i=e[3];p.COBOLWorkspaceSymbolCacheHelper.addClass(i,n,o,p.TypeCategory.EnumId)}else if(t.startsWith(l.COBSCANNER_ADDFILE)){const e=t.split(","),n=BigInt(e[1]),o=e[2],i=C.VSCOBOLFileUtils.getShortWorkspaceFilename(o);if(void 0!==i){const e=new g.COBOLWorkspaceFile(n,i);p.COBOLWorkspaceSymbolCacheHelper.removeAllProgramEntryPoints(i),m.InMemoryGlobalCacheHelper.addFilename(o,e)}else d.logMessage(`Unable to getShortWorkspaceFilename for ${o}`)}else if(t.startsWith(l.COBSCANNER_KNOWNCOPYBOOK)){const e=t.split(","),n=e[1],o=e[2];p.COBOLWorkspaceSymbolCacheHelper.addReferencedCopybook(n,o)}}else d.logMessage(e)})),null!==S.stdout)try{for(var T,E=i(S.stdout);!(T=yield E.next()).done;){const e=T.value.toString();for(const t of e.split("\n"))0!==t.trim().length&&d.logMessage(` ${t}`)}}catch(e){u={error:e}}finally{try{T&&!T.done&&(_=E.return)&&(yield _.call(E))}finally{if(u)throw u.error}}if(null!==S.stderr)try{for(var I,B=i(S.stderr);!(I=yield B.next()).done;){const e=I.value.toString();for(const t of e.split("\n"))0!==t.trim().length&&d.logMessage(` [${t}]`)}}catch(e){y={error:e}}finally{try{I&&!I.done&&(v=B.return)&&(yield v.call(B))}finally{if(y)throw y.error}}}))}static getScanData(e,t,n,o){const i=new l.ScanData;if(i.scannerBinDir=b.scannerBinDir,i.directoriesScanned=n.directoriesScanned,i.maxDirectoryDepth=n.maxDirectoryDepth,i.fileCount=n.fileCount,i.parse_copybooks_for_references=e.parse_copybooks_for_references,i.Files=o,i.cache_metadata_show_progress_messages=e.cache_metadata_show_progress_messages,i.md_symbols=e.metadata_symbols,i.md_entrypoints=e.metadata_entrypoints,i.md_metadata_files=e.metadata_files,i.md_metadata_knowncopybooks=e.metadata_knowncopybooks,void 0!==t)for(const e of t)void 0!==e&&"file"===e.uri.scheme&&i.workspaceFolders.push(e.uri.fsPath);return i}static processAllFilesInWorkspaceOutOfProcess(e,t,n){return o(this,void 0,void 0,(function*(){const o="("+(e?"on demand":"startup")+")",i=u.VSCOBOLConfiguration.get(),r=c.getWorkspaceFolders(),s=new _,a=[];if(void 0===r)return void d.logMessage(`No workspace folders available ${o}`);e?d.logChannelSetPreserveFocus(!e):d.logChannelHide(),d.logMessage(""),d.logMessage(`Starting to process metadata from workspace folders ${o}`),yield f.COBOLUtils.populateDefaultCallableSymbols(i,!1);for(const[,e]of m.InMemoryGlobalSymbolCache.defaultCallableSymbols)a.push(e);f.COBOLUtils.saveGlobalCacheToWorkspace(i,!1);const l=this.getScanData(i,r,s,a);yield b.forkScanner(i,l,o,!0,t,n),f.COBOLUtils.saveGlobalCacheToWorkspace(i,!0)}))}}t.VSCobScanner=b,b.scannerBinDir=b.getCobScannerDirectory()},2124:function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function s(e){try{c(o.next(e))}catch(e){r(e)}}function a(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((o=o.apply(e,t||[])).next())}))},i=this&&this.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(o,i){!function(e,t,n,o){Promise.resolve(o).then((function(t){e({value:t,done:n})}),t)}(o,i,(t=e[n](t)).done,t.value)}))}}},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VSCobScanner_depreciated=void 0;const s=r(n(5622)),a=r(n(5747)),c=r(n(1661)),l=n(5711),u=n(7892),d=r(n(6560)),h=n(112),p=n(7549),f=n(6271),m=n(3987),g=n(627),C=n(3129),_=n(5363),b=n(646),y=n(8331);class v{constructor(){this.filesIgnored=0,this.directoriesScanned=0,this.directoryDepth=0,this.maxDirectoryDepth=0,this.fileCount=0,this.showMessage=!1,this.directoriesScannedMap=new Map}}class O{static isDeprecatedAlive(e){if(0===this.deprecatedActivePid)return!1;try{return process.kill(e,0)}catch(e){return"EPERM"===e.code}}static isDeprecatedScannerActive(e){const t=s.default.join(e,b.ScanDataHelper.scanFilename),n=f.COBOLFileUtils.isFile(t);return 0===O.deprecatedActivePid?n:n||this.isDeprecatedAlive(O.deprecatedActivePid)}static depreciatedRemoveScannerFile(e){const t=s.default.join(e,b.ScanDataHelper.scanFilename);try{a.default.unlinkSync(t)}catch(e){}}static depreciatedGenerateCOBScannerData(e,t,n,i){return o(this,void 0,void 0,(function*(){const o=yield p.workspace.fs.readDirectory(t);if(n.directoriesScanned++,n.directoriesScannedMap.has(t.fsPath))return!0;if(n.showMessage){const e=" ".repeat(n.directoryDepth);h.logMessage(` ${e}Directory : ${t.fsPath}`)}n.directoriesScannedMap.set(t.fsPath,t);const r=[];for(const[a,c]of o)switch(c){case p.FileType.File|p.FileType.SymbolicLink:{const e=" ".repeat(1+n.directoryDepth);h.logMessage(`${e} File : ${a} in ${t.fsPath} is a symbolic link which may cause duplicate data to be cached`)}case p.FileType.File:{const o=s.default.join(t.fsPath,a);f.COBOLFileUtils.isValidProgramExtension(o,e)||f.COBOLFileUtils.isValidCopybookExtension(o,e)?(i.push(o),n.fileCount++):n.filesIgnored++}break;case p.FileType.Directory|p.FileType.SymbolicLink:{const e=" ".repeat(1+n.directoryDepth);h.logMessage(`${e} Directory : ${a} in ${t.fsPath} is a symbolic link which may cause duplicate data to be cached`)}case p.FileType.Directory:if(!d.default.ignoreDirectory(a)){const e=s.default.join(t.fsPath,a);if(!d.default.ignoreDirectory(a))try{r.push(p.Uri.file(e))}catch(n){h.logMessage(` Uri.file failed with ${e} from ${t.fsPath} + ${a}`),n instanceof Error?h.logException("Unexpected abort during Uri Parse",n):h.logMessage(n)}}}if(0!==r.length)if(1+n.directoryDepth<=e.cache_metadata_max_directory_scan_depth){n.directoryDepth++;for(const t of r)try{yield O.depreciatedGenerateCOBScannerData(e,t,n,i)}catch(e){continue}n.directoryDepth>n.maxDirectoryDepth&&(n.maxDirectoryDepth=n.directoryDepth),n.directoryDepth--}else h.logMessage(` Directories below : ${t.fsPath} has not been scanned (depth limit is ${e.cache_metadata_max_directory_scan_depth})`);return!0}))}static deprecated_processAllFilesInWorkspaceOutOfProcess(e){return o(this,void 0,void 0,(function*(){const t="("+(e?"on demand":"startup")+")",n=u.VSCOBOLConfiguration.get();if(!1===u.VSCOBOLConfiguration.isDepreciatedDiskCachingEnabled())return void h.logMessage(`Metadata cache is off, no action taken ${t}`);const o=d.default.getDeprecatedCacheDirectory();if(void 0!==o&&O.isDeprecatedScannerActive(o)){if(m.COBOLSourceScannerUtils.cleanUpOldMetadataFiles(n,o),e)return void h.logMessage(`Source scanner already active, no action taken ${t}`);h.logMessage(`Source scanner lock file is present on startup ${t}`),O.depreciatedRemoveScannerFile(o),h.logMessage(" - lock file released")}const i=g.getWorkspaceFolders(),r=new v,s=[];if(void 0===i)return void h.logMessage(`No workspace folders available ${t}`);if(e?h.logChannelSetPreserveFocus(!e):h.logChannelHide(),h.logMessage(""),h.logMessage(`Starting to process metadata from workspace folders ${t}`),void 0!==i)for(const e of i)try{yield O.depreciatedGenerateCOBScannerData(n,e.uri,r,s)}catch(e){continue}const a=new b.ScanData;if(a.scannerBinDir=l.VSCobScanner.scannerBinDir,a.directoriesScanned=r.directoriesScanned,a.maxDirectoryDepth=r.maxDirectoryDepth,a.fileCount=r.fileCount,a.parse_copybooks_for_references=n.parse_copybooks_for_references,a.Files=s,a.cache_metadata_show_progress_messages=n.cache_metadata_show_progress_messages,a.md_symbols=n.metadata_symbols,a.md_entrypoints=n.metadata_entrypoints,a.md_metadata_files=n.metadata_files,a.md_metadata_knowncopybooks=n.metadata_knowncopybooks,void 0!==i)for(const e of i)void 0!==e&&"file"===e.uri.scheme&&a.workspaceFolders.push(e.uri.fsPath);yield O.depreciatedForkScanner(n,a,t,!0,!1,-1)}))}static depreciatedForkScanner(e,t,n,r,a,u){var d,p,f,m;return o(this,void 0,void 0,(function*(){const o=s.default.join(l.VSCobScanner.scannerBinDir,"cobscanner.js");b.ScanDataHelper.save(c.default,t);const r=s.default.join(c.default,b.ScanDataHelper.scanFilename),a={stdio:[0,1,2,"ipc"],cwd:l.VSCobScanner.scannerBinDir},u=C.fork(o,[r],a);if(null==u)return;O.deprecatedActivePid=u.pid;const g=setTimeout((function(){try{u.kill()}catch(e){h.logException(`Timeout, ${n}`,e)}}),e.cache_metadata_inactivity_timeout);u.on("error",(e=>{void 0!==c.default&&O.depreciatedRemoveScannerFile(c.default),h.logException(`Fork caused ${n}`,e)})),u.on("exit",(e=>{O.deprecatedActivePid=0,clearTimeout(g),0!==e?h.logMessage(`External scan completed (${u.pid}) [Exit Code=${e}}]`):h.progressStatusBarItem.hide()}));let v=0;if(u.on("message",(e=>{g.refresh();const t=e;if(t.startsWith("@@")){if(_.InMemoryGlobalSymbolCache.isDirty=!0,t.startsWith(b.COBSCANNER_STATUS)){const e=t.split(" ");h.progressStatusBarItem.show(),v+=Number.parseInt(e[1],10),h.progressStatusBarItem.text=`Processing metadata: ${v}%`}else if(t.startsWith(b.COBSCANNER_SENDEP)){const e=t.split(","),n=e[1],o=Number.parseInt(e[2],10),i=e[3];y.COBOLWorkspaceSymbolCacheHelper.addEntryPoint(i,n,o)}else if(t.startsWith(b.COBSCANNER_SENDPRGID)){const e=t.split(","),n=e[1],o=Number.parseInt(e[2],10),i=e[3];y.COBOLWorkspaceSymbolCacheHelper.removeAllProgramEntryPoints(i),y.COBOLWorkspaceSymbolCacheHelper.removeAllTypes(i),y.COBOLWorkspaceSymbolCacheHelper.addCalableSymbol(i,n,o)}else if(t.startsWith(b.COBSCANNER_KNOWNCOPYBOOK)){const e=t.split(","),n=e[1],o=e[2];y.COBOLWorkspaceSymbolCacheHelper.addReferencedCopybook(n,o)}}else h.logMessage(e)})),null!==u.stdout)try{for(var w,S=i(u.stdout);!(w=yield S.next()).done;){const e=w.value.toString();for(const t of e.split("\n"))0!==t.trim().length&&h.logMessage(` ${t}`)}}catch(e){d={error:e}}finally{try{w&&!w.done&&(p=S.return)&&(yield p.call(S))}finally{if(d)throw d.error}}if(null!==u.stderr)try{for(var k,L=i(u.stderr);!(k=yield L.next()).done;){const e=k.value.toString();for(const t of e.split("\n"))0!==t.trim().length&&h.logMessage(` [${t}]`)}}catch(e){f={error:e}}finally{try{k&&!k.done&&(m=L.return)&&(yield m.call(L))}finally{if(f)throw f.error}}}))}static depreciatedProcessSavedFile(e,t){return o(this,void 0,void 0,(function*(){if(!1===u.VSCOBOLConfiguration.isDepreciatedDiskCachingEnabled())return;if(t.parse_copybooks_for_references)return;const n=d.default.getDeprecatedCacheDirectory();if(void 0!==n&&m.COBOLSourceScannerUtils.cleanUpOldMetadataFiles(t,n),f.COBOLFileUtils.isValidCopybookExtension(e,t)||f.COBOLFileUtils.isValidProgramExtension(e,t)){const n=new b.ScanData;n.scannerBinDir=l.VSCobScanner.scannerBinDir,n.showStats=!1,n.Files.push(e),n.fileCount=n.Files.length,n.parse_copybooks_for_references=t.parse_copybooks_for_references,n.cache_metadata_show_progress_messages=t.cache_metadata_show_progress_messages,n.md_symbols=t.metadata_symbols,n.md_entrypoints=t.metadata_entrypoints,n.md_types=t.metadata_types,n.md_metadata_files=t.metadata_files,n.md_metadata_knowncopybooks=t.metadata_knowncopybooks,yield O.depreciatedForkScanner(t,n,"OnSave",!0,!1,-1)}}))}}t.VSCobScanner_depreciated=O,O.deprecatedActivePid=0},5323:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VSCodeSourceHandler=void 0;const o=n(7530),i=n(3412);class r{constructor(e,t,n){this.document=e,this.dumpNumbersInAreaA=t,this.dumpAreaBOnwards=!1,this.commentCount=0,this.commentCallback=n,this.lineCount=this.document.lineCount,this.documentVersionId=BigInt(this.document.version);const o=i.VSCOBOLFileUtils.getShortWorkspaceFilename(e.fileName);this.shortWorkspaceFilename=void 0===o?"":o,this.isSourceInWorkSpace=0!==this.shortWorkspaceFilename.length,this.updatedSource=new Map}getDocumentVersionId(){return this.documentVersionId}getUriAsString(){return this.document.uri.toString()}getLineCount(){return this.lineCount}getCommentCount(){return this.commentCount}sendCommentCallback(e,t){void 0!==this.commentCallback&&this.commentCallback.processComment(e,this.getFilename(),t)}getLine(e,t){if(e>=this.lineCount)return;let n=this.document.lineAt(e).text;if(t)return n;const o=n.indexOf("*>");if(-1!==o&&(this.sendCommentCallback(n,e),n=n.substring(0,o),this.commentCount++),n.length>1&&"*"===n[0])return this.commentCount++,this.sendCommentCallback(n,e),"";if(n.length>=7&&"*"===n[6])return this.commentCount++,this.sendCommentCallback(n,e),"";if(this.dumpNumbersInAreaA)if(n.match(r.paraPrefixRegex1))n="      "+n.substr(6);else if(n.length>7&&" "===n[6]){const e=n.substr(0,6).trim();!1===this.isValidKeyword(e)&&(n="       "+n.substr(6))}return this.dumpAreaBOnwards&&n.length>=73&&(n=n.substr(0,72)),n}setDumpAreaA(e){this.dumpNumbersInAreaA=e}setDumpAreaBOnwards(e){this.dumpAreaBOnwards=e}isValidKeyword(e){return o.cobolKeywordDictionary.has(e)}getUri(){return this.document.uri}getFilename(){return this.document.fileName}setCommentCallback(e){this.commentCallback=e}resetCommentCount(){this.commentCount=0}getIsSourceInWorkSpace(){return this.isSourceInWorkSpace}getShortWorkspaceFilename(){return this.shortWorkspaceFilename}setUpdatedLine(e,t){this.updatedSource.set(e,t)}getUpdatedLine(e){return this.updatedSource.has(e)?this.updatedSource.get(e):this.getLine(e,!1)}}t.VSCodeSourceHandler=r,r.paraPrefixRegex1=/^[0-9 ][0-9 ][0-9 ][0-9 ][0-9 ][0-9 ]/g},2465:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VSExternalFeatures=void 0;const o=n(112),i=n(9131),r=n(9811),s=n(3412);t.VSExternalFeatures=class{logMessage(e){o.logMessage(e)}logException(e,t){o.logException(e,t)}logTimedMessage(e,t,...n){return o.logTimedMessage(e,t,n)}performance_now(){return o.performance_now()}expandLogicalCopyBookToFilenameOrEmpty(e,t,n){return r.COBOLCopyBookProvider.expandLogicalCopyBookToFilenameOrEmpty(e,t,n)}getCOBOLSourceFormat(e,t){return i.getCOBOLSourceFormat(e,t)}getFullWorkspaceFilename(e,t){return s.VSCOBOLFileUtils.getFullWorkspaceFilename(e,t)}setWorkspaceFolders(e){}getWorkspaceFolders(){return[]}}},3412:function(e,t,n){"use strict";var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VSCOBOLFileUtils=void 0;const i=o(n(5622)),r=o(n(5747)),s=n(627),a=n(6271),c=n(7549),l=n(112);t.VSCOBOLFileUtils=class{static isPathInWorkspace(e){const t=s.getWorkspaceFolders();if(void 0===c.workspace||void 0===t)return!1;const n=i.default.normalize(e);for(const e of t)if(e.uri.fsPath===n)return!0;return!1}static getFullWorkspaceFilename(e,t){const n=s.getWorkspaceFolders();if(void 0!==c.workspace&&void 0!==n)for(const o of n)if("file"===o.uri.scheme){const n=o.uri.path,s=i.default.join(n,e);if(a.COBOLFileUtils.isFile(s)&&t===r.default.statSync(s,{bigint:!0}).mtimeMs)return s}}static getShortWorkspaceFilename(e){const t=s.getWorkspaceFolders();if(void 0===c.workspace||void 0===t)return;const n=i.default.normalize(e);let o="";for(const e of t)if("file"===e.uri.scheme){const t=e.uri.path;if(n.startsWith(t)){const e=n.substr(1+t.length);(0===o.length||e.length<e.length)&&(o=e)}}return 0===o.length?void 0:o}static findCopyBook(e,t){if(!e)return"";const n=e.indexOf(".");for(const o of l.getCombinedCopyBookSearchPath()){const r=i.default.join(o,e);if(a.COBOLFileUtils.isFile(r))return r;if(-1===n)for(const n of t.copybookexts){const t=i.default.join(o,e+"."+n);if(a.COBOLFileUtils.isFile(t))return t}}return""}static findCopyBookInDirectory(e,t,n){if(!e)return"";const o=e.indexOf(".");for(const r of l.getCombinedCopyBookSearchPath()){const s=i.default.join(r,t),c=i.default.join(s,e);if(a.COBOLFileUtils.isFile(c))return c;if(-1===o)for(const t of n.copybookexts){const n=i.default.join(s,e+"."+t);if(a.COBOLFileUtils.isFile(n))return n}}return""}}},402:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VSPPCodeLens=void 0;const a=r(n(7549)),c=n(7892),l=s(n(6560));t.VSPPCodeLens=class{constructor(){this._onDidChangeCodeLenses=new a.EventEmitter,this.onDidChangeCodeLenses=this._onDidChangeCodeLenses.event,this.settings=c.VSCOBOLConfiguration.get(),a.workspace.onDidChangeConfiguration((e=>{this._onDidChangeCodeLenses.fire()}))}padInteger(e,t){let n=e.toString();for(;n.length<t;)n="0"+n;return n}provideCodeLenses(e,t){var n,o,i;const r=[],s=l.default.getCachedObject(e,this.settings);if(void 0===s)return r;for(const e of s.ppResults){const n=new a.Range(new a.Position(e.atLine,0),new a.Position(e.atLine,e.originalLine.length)),o=new a.CodeLens(n);let i="",s="",c=2+e.originalLine.length;3+e.ppHandle.description.length>c&&(c=3+e.ppHandle.description.length),3+e.ppHandle.bugReportEmail.length>c&&(c=3+e.ppHandle.bugReportEmail.length),3+e.ppHandle.bugReportUrl.length>c&&(c=3+e.ppHandle.bugReportUrl.length);let l=0;for(const t of e.replacedLines)i+=`${t}\n`,s+=`${this.padInteger(l,5)} : "${t}"\n`,10+t.length>c&&(c=t.length+10),l+=1;let u="";for(const[t,n]of e.copybooks)u+=`${t} = ${n}\n`,u.length>c&&(c=u.length);let d=`Preprocessor ${e.ppHandle.id} changed ${e.replacedLines.length} lines\n`;d+="Original Line:",d+=`"${e.originalLine}"\n`,d+="-".repeat(c)+"\n",d+=u,d+="-".repeat(c)+"\n",d+="LNum:\n",d+=`${s}`,d+="-".repeat(c)+"\n",d+=` ${e.ppHandle.description}\n`,d+=` ${e.ppHandle.bugReportEmail}\n`,d+=` ${e.ppHandle.bugReportUrl}\n`,d+="-".repeat(c)+"\n",o.command={title:`Preprocessor ${e.ppHandle.id} changed ${e.replacedLines.length} lines`,tooltip:i,command:"coboleditor.ppcodelenaction",arguments:[d]},this.resolveCodeLens(o,t),r.push(o)}for(const[,c]of s.copyBooksUsed)if(c.parsed&&0!==c.statementInformation.copyReplaceMap.size){const s=e.lineAt(c.statementInformation.startLineNumber),l=new a.Range(new a.Position(c.statementInformation.startLineNumber,0),new a.Position(c.statementInformation.startLineNumber,s.text.length)),u=new a.CodeLens(l);let d="",h="",p=10;if(void 0!==c.statementInformation.sourceHandler)for(let e=0;e<(null===(n=c.statementInformation.sourceHandler)||void 0===n?void 0:n.getLineCount());e++)d+=null===(o=c.statementInformation.sourceHandler)||void 0===o?void 0:o.getUpdatedLine(e),d+="\n",p>0&&(h+=null===(i=c.statementInformation.sourceHandler)||void 0===i?void 0:i.getUpdatedLine(e),h+="\n",--p);if(p<=0&&(h+="\n......"),0!==d.length){const e=`*> Caution: This is an approximation\n*> Original file: ${c.statementInformation.fileName}\n${d}`;u.command={title:"View copybook repacement",tooltip:h,command:"coboleditor.ppcodelenaction",arguments:[e]},this.resolveCodeLens(u,t),r.push(u)}}return r}resolveCodeLens(e,t){return e}static actionCodeLens(e){a.workspace.openTextDocument({content:`${e}`,language:"text"}).then((t=>{a.window.showTextDocument(t).then((t=>{e.startsWith("*>")&&a.languages.setTextDocumentLanguage(t.document,"COBOL")}))}))}}},4733:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VSPreProc=void 0;const o=n(7549),i=n(4632),r=n(3911),s=n(8202),a=n(112);class c{static areAllPreProcessorsReady(e){return c.registerPreProcessors(e)}static registerPreProcessors(e){let t=!1,n=!1,o=!1;for(const l of e.preprocessor_extensions)if(!s.COBOLPreprocessorHelper.preprocessorsExts.has(l))try{const u=c.getExtension(l);if(void 0===u){a.logMessage(` WARNING: PreProcessors ${l} not found, continuing without it`),o=!0;break}if(!1===u.isActive){n=!0;break}const d=c.getCOBOLPreprocessor(u,l);if(void 0!==d){const c=new r.CobApiHandle(d.getPackageJson(),a.ExternalFeatures);try{d.getImplementedVersion()!==i.COBAPIConstants.COB_API_INTERFACE_VERSION?(n=!0,e.preprocessor_extensions=[],a.logMessage(` WARNING: PreProcessors disable due to ${l} implementing a old version of the interface`)):(s.COBOLPreprocessorHelper.preprocessors.set(c,d),s.COBOLPreprocessorHelper.preprocessorsExts.set(l,c),t=!0)}catch(e){o=!0,a.logMessage(` WARNING: PreProcessors disable due to ${l} causing an error during initialization`)}}else a.logMessage(` WARNING: PreProcessors ${l} not found, continuing without it`),o=!0}catch(e){n=!0,a.logException(`Unable to get preprocessor : ${l}`,e)}return t&&a.dumpPreProcInfo(e),o&&(e.preprocessor_extensions=[]),!n}static msleep(e){Atomics.wait(new Int32Array(new SharedArrayBuffer(4)),0,0,e)}static getExtension(e){for(const t of o.extensions.all)if(t.id===e)return t}static getCOBOLPreprocessor(e,t){try{if(void 0===(null==e?void 0:e.exports))return;return a.logMessage(`Extension ${e.id} is found, Active=${e.isActive}`),e.exports}catch(e){return void a.logMessage(`getCOBOLPreprocessor(${t})`,e)}}}t.VSPreProc=c},1464:function(e,t,n){"use strict";var o=this&&this.__createBinding||(Object.create?function(e,t,n,o){void 0===o&&(o=n),Object.defineProperty(e,o,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,o){void 0===o&&(o=n),e[o]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VSSemanticProvider=void 0;const a=r(n(7549)),c=n(8202),l=n(7892),u=n(112),d=s(n(6560)),h=new a.SemanticTokensLegend(["label","variable","function"],["declaration","readonly"]);class p{static getLegend(){return h}static provider(){return{provideDocumentSemanticTokens:e=>p.providerImpl(e)}}static providerImpl(e){const t=l.VSCOBOLConfiguration.get(),n=new a.SemanticTokensBuilder(h);if(!1===t.enable_semantic_token_provider)return n.build();const o=d.default.getCachedObject(e,t);if(void 0===o)return n.build();for(const[,e]of o.sections)try{!1===e.ignoreInOutlineView&&e.inProcedureDivision&&n.push(new a.Range(new a.Position(e.startLine,e.startColumn),new a.Position(e.startLine,e.startColumn+e.tokenName.length)),"function")}catch(e){u.logException("SemanticProvider: sections",e)}for(const[,e]of o.paragraphs)try{!1===e.ignoreInOutlineView&&e.inProcedureDivision&&n.push(new a.Range(new a.Position(e.startLine,e.startColumn),new a.Position(e.startLine,e.startColumn+e.tokenName.length)),"function")}catch(e){u.logException("SemanticProvider: paragraphs",e)}for(const[,e]of o.sourceReferences.targetReferences)try{for(const t of e)n.push(new a.Range(new a.Position(t.line,t.column),new a.Position(t.line,t.column+t.length)),"function")}catch(e){u.logException("SemanticProvider: targetReferences",e)}for(const[,e]of o.constantsOrVariables)for(const t of e)if(!1===t.ignoreInOutlineView)try{t.tokenType===c.COBOLTokenStyle.Constant?n.push(new a.Range(new a.Position(t.startLine,t.startColumn),new a.Position(t.startLine,t.startColumn+t.tokenName.length)),"variable",["declaration","readonly"]):n.push(new a.Range(new a.Position(t.startLine,t.startColumn),new a.Position(t.startLine,t.startColumn+t.tokenName.length)),"variable",["declaration"])}catch(e){u.logException("SemanticProvider: constantsOrVariables",e)}for(const[,e]of o.sourceReferences.constantsOrVariablesReferences)for(const t of e)try{t.tokenStyle===c.COBOLTokenStyle.Constant?n.push(new a.Range(new a.Position(t.line,t.column),new a.Position(t.line,t.column+t.length)),"variable",["readonly"]):n.push(new a.Range(new a.Position(t.line,t.column),new a.Position(t.line,t.column+t.length)),"variable")}catch(e){u.logException("SemanticProvider: sourceRefs",e)}return n.build()}}t.VSSemanticProvider=p},3129:e=>{"use strict";e.exports=require("child_process")},6417:e=>{"use strict";e.exports=require("crypto")},5747:e=>{"use strict";e.exports=require("fs")},2087:e=>{"use strict";e.exports=require("os")},5622:e=>{"use strict";e.exports=require("path")},8835:e=>{"use strict";e.exports=require("url")},1669:e=>{"use strict";e.exports=require("util")},7549:e=>{"use strict";e.exports=require("vscode")}},t={},n=function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}(112);module.exports=n})();
//# sourceMappingURL=extension.js.map